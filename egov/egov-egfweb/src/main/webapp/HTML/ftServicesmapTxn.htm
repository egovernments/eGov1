#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<SCRIPT LANGUAGE="javascript">
	var addAllUsed=false;
	var fromHead=false;//from type combo
	var alreadyDone=new Object();
	var oldDataLoad=false;
	function getData(){
		PageManager.DataService.callDataService('filterServiceList1');
	}
	function loadMajorHeads(obj){
		if(obj.selectedIndex>8)return;
		clearCodeCombo('ftService_majorHead',false);
		clearCodeCombo('ftService_minorHead',false);
		var typeOfCode=obj.options[obj.selectedIndex].value;
		PageManager.DataService.removeQueryField('type');
		PageManager.DataService.setQueryField('type',typeOfCode);
		PageManager.DataService.callDataService('loadMajorHeads');

	}
	function loadMinorHeads(obj){
		if(obj.selectedIndex<1)return;
		clearCodeCombo('ftService_minorHead',false);
		var majorCode=obj.options[obj.selectedIndex].value;
		PageManager.DataService.removeQueryField('majorCode');
		PageManager.DataService.setQueryField('majorCode',majorCode);
		PageManager.DataService.callDataService('loadMinorHeads');
	}
	function fetchData(){
		var fromObj=document.getElementById('ftService_fromCode');
		fromObj.setAttribute("exilMustEnter","true");
		var actParam=getFilterToLoad();
		if(actParam=="-1")return;
		if(fromHead){
			PageManager.DataService.removeQueryField('minorCode');
			PageManager.DataService.removeQueryField('type');
			PageManager.DataService.setQueryField('type',actParam);
		}else{
			PageManager.DataService.removeQueryField('minorCode');
			PageManager.DataService.removeQueryField('type');
			PageManager.DataService.setQueryField('minorCode',actParam);
		}
		PageManager.DataService.callDataService('loadGLCodesL');
	}

	function getFilterToLoad(){
		fromHead=false;
		var actualParam="-1";
		var minorObj=document.getElementById("ftService_minorHead");
		if(minorObj.selectedIndex<1){
			var majorObj=document.getElementById("ftService_majorHead");
			if(majorObj.selectedIndex<1){
				var typeOfHead=document.getElementById("ftService_type");
				if(typeOfHead.options[typeOfHead.selectedIndex].value>8){
					alert("select type");
					return actualParam;
				}
				fromHead=true;
				actualParam=typeOfHead.options[typeOfHead.selectedIndex].value;
			}else{
				actualParam=majorObj.options[majorObj.selectedIndex].value;
			}
		}else{
			actualParam=minorObj.options[minorObj.selectedIndex].value;
		}
		return actualParam;
	}
	function addTop(){

		addAllUsed=true;
		var actParam=getFilterToLoad();
		if(actParam=="-1")return;
		PageManager.DataService.removeQueryField('minorCode');
		PageManager.DataService.setQueryField('minorCode',actParam);
		PageManager.DataService.callDataService('loadGLCodesR');
		disableButtons(0);
	}
	function disableButtons(oper){
		var butnSet = document.getElementsByName("buttonSet");
		for(var i=0;i<butnSet.length;i++){
			if(oper==0){
				butnSet[i].disabled=true;
			}else{
				butnSet[i].disabled=false;
			}

		}
	}
	function transferRight(){
		var fromObj=document.getElementById('ftService_fromCode');
		var toObj=document.getElementById('ftService_toCode');
		for(var i=0;i<fromObj.length;i++){
			try{
				if(fromObj.options[i].selected){
					if(alreadyDone[fromObj.options[i].value]!=null)continue;
					alreadyDone[fromObj.options[i].value]=fromObj.options[i].value;
					var optObj=fromObj.options[i].cloneNode(true);
					toObj.appendChild(optObj);
				}
			}catch(e){}
		}
	}
	function removeRight(){
		var toObj=document.getElementById('ftService_toCode');
		for(var i=toObj.length-1;i>=0;i--){
			if(toObj.options[i].selected){
				alreadyDone[toObj.options[i].value]=null;
				toObj.remove(i);
			}
		}
	}
	function selectAll(objName){
		var fromObj=document.getElementById(objName);
		for(var i=0;i<fromObj.length;i++){
			fromObj.options[i].setAttribute('selected',true);
		}
	}
	function unSelectAll(){
		addAllUsed=false;
		disableButtons(1);
		clearCodeCombo('ftService_toCode',true);
	}
	function clearCodeCombo(objName,clear){
		var toObj=document.getElementById(objName);
		for(var i=toObj.length-1;i>=0;i--){
			if(clear){
				alreadyDone[toObj.options[i].value]=null;
			}
			toObj.remove(i);
		}
	}
	function saveData(){
		selectAll('ftService_toCode');
		PageManager.UpdateService.submitForm('saveFilterCriteria');
	}
	function fillOldData(obj){
		//fill the already entered data
		if(obj.selectedIndex==-1)return;
		unSelectAll();
		var actParam=obj.options[obj.selectedIndex].value;
		PageManager.DataService.removeQueryField('typeOfCode');
		PageManager.DataService.setQueryField('typeOfCode',actParam);
		oldDataLoad=true;
		PageManager.DataService.callDataService('loadServiceData');
	}
	function afterUpdateService(dc){
		if(dc.values['serviceID']=='saveFilterCriteria'){
			PageManager.UpdateService.submitForm('reloadMappedCodes');
		}else{
			window.location="ftServicesmapTxn.htm" ;
		}
	}
	function afterRefreshPage(dc){
		if(oldDataLoad){
			makeSelected();
			oldDataLoad=false;
		}
		var fromObj=document.getElementById('ftService_fromCode');
		fromObj.removeAttribute("exilMustEnter");
	}
	function makeSelected(){
		var toObj=document.getElementById('ftService_toCode');
		for(var i=0;i<toObj.length;i++){
				alreadyDone[toObj.options[i].value]=toObj.options[i].value;
		}
	}
</SCRIPT>
</head>
<body bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0" marginheight="0" marginwidth="0" onLoad="getData();">
<form name="screenMap">
	<table width="100%" border=0 cellpadding="3" cellspacing="0">
		
		<tr class="row1">

					<td  colspan=2 align=right valign="center" class="normaltext" ><div> Service<span class="leadon">*</span></div>
					</td>
					<td  colspan=2 valign="center"  align=left class="normaltext">
							<div align="left">
                                  <SELECT id="ftService_id"  name="ftService_id" class="fieldinput"
									   onChange="fillOldData(this)" exilListSource="ftService_id"
									 exilMustEnter="true">
                                  </SELECT>
                            </div>
					</td><!--	<td  align=right valign="center" class="normaltext" ><div> Function<span class="leadon">*</span></div>
					</td>
					<td  valign="center"  align=left class="normaltext">
							<div align="left">
                                  <SELECT id="ftService_function"  name="ftService_function" class="fieldinput"
									      exilMustEnter="true" exilListSource="ftService_function">
                                  </SELECT>
                            </div>
					</td>-->
		</tr>
		<tr class="row2">

					<td  colspan=2 valign="center" class="normaltext"  align=right><div> Type<span class="leadon">*</span></div>
					</td>
					<td  colspan=2 align=left valign="center" class="normaltext" >
							<div>
                                  <SELECT id="ftService_type"
      name="ftService_type" class="fieldinput" onchange="loadMajorHeads(this)" exilMustEnter="true">
									<option value="9" selected ></option>
									<option value="I">Income</option>
									<option value="E">Expense</option>
									<OPTION value="L">Liability</OPTION>
									<OPTION value="A">Asset </OPTION><
								  </SELECT>
                            </div>
					</td>
		</tr>
		<tr class="row1">
			<td width="25%"><div align="right" valign="center" class="normaltext">Major Head</div></td>
			<td width="25%">
					<SELECT id="ftService_majorHead"  name="ftService_majorHead" class="combowidth2"
					      onchange="loadMinorHeads(this)" exilListSource="ftService_majorHead">
					</SELECT>
			</td>
			<td width="25%"><div align="right" valign="center" class="normaltext">Minor Head</div></td>
			<td width="25%">
					<SELECT id="ftService_minorHead"  name="ftService_minorHead" class="combowidth3"

					      exilListSource="ftService_minorHead"  >
					</SELECT>
			</td>

		</tr>


		   <tr class="row2">
				<td height="25" colspan="4" valign="bottom" class="smalltext" ><p class="smalltext"></p>
				</td>
			</tr>

</table>
<table width="100%">
	<tr>
		<td width="25%" align=right>
			<SELECT id="ftService_fromCode"  name="ftService_fromCode" class="fieldinput"
										 multiple style="WIDTH: 139px; HEIGHT: 124px"

      exilListSource="ftService_fromCode">
			 </SELECT>
		</td>
		<td width="50%"><!--<table width="100%">
				<tr>
					<td><input type=button value="Fetch" id="fetchButton" name="buttonSet" onClick="fetchData()"></td>
				</tr>
				<tr>
					<td><input type=button value=">" id="selButton" name="buttonSet" onClick="transferRight()"></td>
				</tr>
				<tr>
					<td><input type=button value="<" id="unSelButton" name="buttonSet" onClick="removeRight()"></td>
				</tr>
				<tr>
					<td><input type=button value="Select All" id="selAllButton" name="buttonSet" onclick="selectAll('ftService_fromCode')" style="WIDTH: 67px; HEIGHT: 24px" size=15>
					<input type=button value="UnSelect All" onclick="unSelectAll()" id="unSelAllButton" name="unSelAllButton" style="WIDTH: 81px; HEIGHT: 24px" size=14></td>
				</tr>
				<tr>
					<td>
						<input type=button value="Save" id="save" name="save" onClick="saveData()">
						<input type=button value="Add All"     id="addAll" name="addAll" onclick="addTop()">
					</td>
				</tr>

			</table>-->
			<table width="100%">
				<tr>
					<td><input type=button value="Fetch" id="fetchButton" name="buttonSet" onClick="fetchData()" style="WIDTH: 81px; HEIGHT: 24px"></td>

					<td><input type=button value=">" id="selButton" name="buttonSet" onClick="transferRight()" style="WIDTH: 81px; HEIGHT: 24px">


					<input type=button value="<" id="unSelButton" name="buttonSet" onClick="removeRight()" style="WIDTH: 81px; HEIGHT: 24px"></td>


					<td><input type=button value="Select All" id="selAllButton" name="buttonSet" onclick="selectAll('ftService_fromCode')" style="WIDTH: 81px; HEIGHT: 24px" size=14>
						<input type=button value="UnSelect All" onclick="unSelectAll()" id="unSelAllButton" name="unSelAllButton" style="WIDTH: 81px; HEIGHT: 24px" size=14>
						<input type=button value="Add All"     id="addAll" name="addAll" onclick="addTop()" style="WIDTH: 81px; HEIGHT: 24px">
						<input type=button value="Save" id="save" name="save" onClick="saveData()" style="WIDTH: 81px; HEIGHT: 24px">
					</td></tr>
			</table>
		</td>
		<td width="25%" align=left><SELECT id="ftService_toCode"  name="ftService_toCode" class="fieldinput"
										 multiple style="WIDTH: 139px; HEIGHT: 122px"
      exilListSource="ftService_toCode"
      exilMustEnter="true">
			 </SELECT></td>
	</tr>
	                   <tr class="row1">
								<td colspan="4" align="middle"><!-- Buttons Start Here -->
									<table border="0" cellpadding="0" cellspacing="0">
										<tr>
											<td align="right">
                                            <IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
											<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=window.close() href="#">Close</A></td>
											<td>
                                            <IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
										</tr>
									</table>
							   </td>
						  </tr>


</table>
</form>
</body>
</html>
