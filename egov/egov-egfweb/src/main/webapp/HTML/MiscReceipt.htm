#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
 		<SCRIPT LANGUAGE="javascript">
 		var isDrillDown=false;
 		var str="";
 		var type="";
 		var chequeGridlen="";
 		var tabObj="";
 		var isIE;
	   	var req2;
		var req;
		var codeArray=new Array();
		var j=-1;
		var k=-1;
		var sIndex,sValue,sText;
		var acccodeArray,functionArray;
		var codeObj,functionObj ;
		var yuiflag = new Array();

		function beforeRefreshPage(dc){
		if(dc.values['serviceID']=='getMiscDetails'){


             			if(dc.grids['chequeGrid'].length>0)
							{
									 chequeGridlen=dc.grids['chequeGrid'].length;
									tabObj=dc.grids['chequeGrid'];
									for(var i=1;i<chequeGridlen;i++){
								//	alert("tabObj[i][0].value---"+tabObj[i][0]);
								//	alert("tabObj[i][1].value---"+tabObj[i][1]);
								//	alert("tabObj[i][2].value---"+tabObj[i][2]);
								//	alert("tabObj[i][3].value---"+tabObj[i][3]);


									}

							}


             			}
		if(dc.values['glCodeName'])
				{
				 glNameCode=dc.values['glCodeName'];
				 showEntry();
			}
			if(!isNaN(parseInt(dc.values['voucherHeader_cgn'])))
			dc.values['voucherHeader_cgn'] = 'MSR' + dc.values['voucherHeader_cgn'];
			if(isDrillDown && dc.values['serviceID']=='getMiscDetails'){
    	 		dc=createRowIndex(dc,'voucherDetailGrid','entities_grid');
    	 	}
    	 	if(dc.values['serviceID']=='getMiscDetails')
			{
				if(dc.values['modeOfCollection'] == 'Cheque')
				{
					var cglRow=document.getElementById('rowChequeGridLable');
					cglRow.style.display='block';
					var cgRow=document.getElementById('rowChequeGrid');
					cgRow.style.display='block';
					var tgRow=document.getElementById('rowTotalGrid');
					tgRow.style.display='block';
					var gridObj=dc.grids['chequeGrid'];
					if(gridObj)
					{
						for(var i=1;i<gridObj.length;i++)
						{
							gridObj[i][3]=formatDate2(gridObj[i][3]);
						}

					}
				}
				else if(dc.values['modeOfCollection'] == 'Others')
				{
					var rfRow=document.getElementById('rowRefno');
					rfRow.style.display='block';
				}
				else if(dc.values['modeOfCollection'] == 'Bank')
				{
					var rbRow=document.getElementById('rowBank');
					rbRow.style.display='block';
					var rfRow=document.getElementById('rowRefno');
					rfRow.style.display='block';
				}
			}
		}
        function ButtonPress(name)
		{
			insertBlankRow('entities_grid',1);//insert blank row at position=1
			var modeOfCln=getSelectedRadioValue(document.getElementsByName('modeOfCollection'));
			if(modeOfCln.toLowerCase()!="bank"){
			document.getElementById('bank_id').removeAttribute('exilMustEnter');
			document.getElementById('bankAccount_accountNumber').removeAttribute('exilMustEnter');
			}
			if(name.toLowerCase()=='savenew')
			str="new";
			if(name.toLowerCase()=='saveclose')
			str="close";
       	 	var cgn=PageManager.DataService.getQueryField('cgNumber');
       	 	var sm=PageManager.DataService.getQueryField('showMode');
	 		if(cgn)	disableControls(0,false);
	     	else {
				if(!PageValidator.validateForm())return false;
				else{
					if(!checkNarration('voucherHeader_narration')) return false;
					if(modeOfCln.toLowerCase()=="cheque")
						if(!checkChequeDate("chequeDetail_chequeDate")) return false;
					if(!validate()) return false;


				}
			}
		 		var dbDate=document.getElementById('databaseDate').value;
				var vhDate=document.getElementById('voucherHeader_voucherDate').value;
				if(compareDate(formatDateToDDMMYYYY1(vhDate),formatDateToDDMMYYYY1(dbDate)) == -1 )
				{
				alert('Voucher Date should be less than or equal to '+dbDate);
				document.getElementById('voucherHeader_voucherDate').focus();
				return false;
				}
				var sm=PageManager.DataService.getQueryField('showMode');
				if(sm=='modify')
				{
				var effDate=document.getElementById('voucherHeader_effDate').value;
				if(compareDate(formatDateToDDMMYYYY1(effDate),formatDateToDDMMYYYY1(dbDate)) == -1 ){
				alert('Voucher Date should be less than or equal to '+dbDate);
				document.getElementById('voucherHeader_effDate').focus();
				return false;
				}
				}
				if(sm=='edit')
					if(!validate()) return false;

			doInsert();
		 }

		 function doInsert(){

		 	PageManager.UpdateService.submitForm('miscReceiptInsert');
		 }

		 function onloadTasks(){
			 PageValidator.addCalendars();
			  document.getElementById('isBankEntry').value=PageManager.DataService.getQueryField('isBankEntry');
			if(document.getElementById('isBankEntry').value == "true")
			{
				document.journalVoucher.modeOfCollection[0].disabled = true;
				document.journalVoucher.modeOfCollection[1].disabled = true;
				document.journalVoucher.modeOfCollection[2].disabled = true;
				document.journalVoucher.modeOfCollection[3].checked = true;
				check(document.journalVoucher.modeOfCollection[3]);
				document.getElementById('chequeDetail_chequeNumber').setAttribute('exilDataType','exilAlphaNumeric');
			}
			 document.getElementById('reverseSubmit').style.display ="none";
			 var cgn=PageManager.DataService.getQueryField('cgNumber');
			 var sm=PageManager.DataService.getQueryField('showMode');
			if(cgn && (sm=="modify"))
		 		{
		 		    isDrillDown=true;
		 		PageManager.DataService.callDataService('miscReceiptList');
				PageManager.DataService.setQueryField('cgNumber',cgn);
				PageManager.DataService.callDataService('getMiscDetails');
				document.getElementById('voucherHeader_voucherNumber').setAttribute('exilDataType','exilAlphaNumeric');
				document.getElementById('modGrid').style.display='block';
				document.getElementById('submitGrid').style.display ="none";
				document.getElementById('cgnLabel').style.display='block';
				document.getElementById('cgnText').style.display='block';
				document.getElementById('boundarytableGrid').style.display="none";
				 document.getElementById('backbutton').style.display="none";
				document.getElementById('boundaryLevelId').removeAttribute('exilMustEnter');
				disableControls(0,true);
		 	 }

		 	 if(cgn && (sm=="view"))
			 {
		   			 isDrillDown=true;
		  		 		PageManager.DataService.callDataService('miscReceiptList');
		  				PageManager.DataService.setQueryField('cgNumber',cgn);
		  				PageManager.DataService.callDataService('getMiscDetails');
		  				document.getElementById('modGrid').style.display='none';
		  				document.getElementById('submitGrid').style.display ="none";
		  				document.getElementById('cgnLabel').style.display='block';
						document.getElementById('cgnText').style.display='block';
						document.getElementById('backbutton').style.display='block';

		  				disableControls(0,true);
		  				document.getElementById('boundarytableGrid').style.display="none";
						document.getElementById('boundaryLevelId').removeAttribute('exilMustEnter');
		 	 }
		 	 else if(cgn && (sm=="edit")){
				isDrillDown=true;
				PageManager.DataService.callDataService('miscReceiptList');
		  		PageManager.DataService.setQueryField('cgNumber',cgn);
		  		PageManager.DataService.callDataService('getMiscDetails');
				document.getElementById('voucherHeader_voucherNumber').setAttribute('exilDataType','exilAlphaNumeric');
				document.getElementById('modGrid').style.display='none';
		  		document.getElementById('submitGrid').style.display ="none";
		  		document.getElementById('saveandnew').style.display ="none";
		  		document.getElementById('cgnLabel').style.display='block';
		  		document.getElementById('cgnText').style.display='block';
		  		document.getElementById('backbutton').style.display='none';
		  		var objBnd=document.getElementById('boundaryLevelId');
					objBnd.setAttribute("exilListSource","BoundaryLevelList");
					PageManager.DataService.callDataService('BoundaryLevelList');
		  		var mdcol=document.getElementById('TypeOfCollection').value;
		  			PageManager.DataService.addNewRow('chequeGrid');

				//alert("modofcollection  --"+document.getElementById('TypeOfCollection').value);
		  		if(mdcol!='Cash')
				{
					//alert("inside the modofcol cond"+mdcol);
					journalVoucher.chequeDetail_chequeNumber.disabled=false;
             		journalVoucher.chequeDetail_chequeDate.disabled=false;
				}
		  		//disableControls1(0,true);

		  		edit();
		 	 }

		 	 if(!cgn)
			{
		 	 	obj=document.getElementById('modGrid').style.display="none";
				window.data=false;
				//insertDates('voucherHeader_voucherDate');
				//PageManager.ListService.callListService();
				PageManager.DataService.callDataService('miscReceiptData');
				PageManager.DataService.addNewRow('voucherDetailGrid');
				PageManager.DataService.addNewRow('chequeGrid');
				//document.getElementById("voucherHeader_voucherNumber").focus();
				//if(sm!="modify"){
				obj=document.getElementById('modGrid').style.display="none";
				document.getElementById('backbutton').style.display="none";
				var objBnd=document.getElementById('boundaryLevelId');
					objBnd.setAttribute("exilListSource","BoundaryLevelList");
					PageManager.DataService.callDataService('BoundaryLevelList');

				//}
			}

	/*
	 * The following code for account code implements Ajax autocomplete through YUI.
	 *
	 */
	       var type='getAllCoaCodes';
            var url = "../commons/Process.jsp?type=" +type+ " ";
           	var req2 = initiateRequest();
            req2.onreadystatechange = function()
            {
	                  if (req2.readyState == 4)
	                  {
	                      if (req2.status == 200)
	                      {
	                      	var codes2=req2.responseText;
	                      	var a = codes2.split("^");
							var codes = a[0];
							acccodeArray=codes.split("+");
							codeObj = new YAHOO.widget.DS_JSArray(acccodeArray);
	                      }
	                  }
	        };
	        req2.open("GET", url, true);
	        req2.send(null);

		/*
		 * The following code implements Ajax autocomplete through YUI for function name.
		 *
		 */
			  var type='getAllFunctionName';
			  var url1 = "../commons/Process.jsp?type=" +type+ " ";
				var req3 = initiateRequest();

			  req3.onreadystatechange = function()
			  {		//codeObj=null;
					   if (req3.readyState == 4)
					   {
						  if (req3.status == 200)
						  {
							var codes2=req3.responseText;
							var a = codes2.split("^");
								var codes = a[0];
								functionArray=codes.split("+");// alert(functionArray);
								functionObj = new YAHOO.widget.DS_JSArray(functionArray);
						  }
					   }
			   };
			   req3.open("GET", url1, true);
			   req3.send(null);
		 }

		function autocompletecode(obj)
		{

			// set position of dropdown
			var src = obj;
			var target = document.getElementById('codescontainer');
			var posSrc=findPos(src);
			target.style.left=posSrc[0];
			target.style.top=posSrc[1]+25;
			target.style.width=500;

			var currRow=PageManager.DataService.getRow(obj);
			var coaCodeObj = PageManager.DataService.getControlInBranch(currRow,'voucherDetail_glCode');
			//40 --> Down arrow, 38 --> Up arrow
				if(yuiflag[currRow.rowIndex] == undefined)
   				{
						if(event.keyCode != 40)
						{
							if(event.keyCode != 38)
							{
									var oAutoComp = new YAHOO.widget.AutoComplete(coaCodeObj,'codescontainer', codeObj);
									oAutoComp.queryDelay = 0;
									oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
									oAutoComp.useShadow = true;
									oAutoComp.maxResultsDisplayed = 15;
   									oAutoComp.useIFrame = true;
							}
						}

						yuiflag[currRow.rowIndex] = 1;
					}


	}
function autocompletecodeFunction(obj)
		{
			 // set position of dropdown
			var src = obj;
			var target = document.getElementById('codescontainer');
			//target.style.position="absolute";
			var posSrc=findPos(src);
			target.style.left=posSrc[0];
			target.style.top=posSrc[1]+25;
			target.style.width=200;

			var currRow=PageManager.DataService.getRow(obj);
			var coaCodeObj = PageManager.DataService.getControlInBranch(currRow,'function_code');
			//40 --> Down arrow, 38 --> Up arrow
			if(yuiflag[currRow.rowIndex] == undefined)
   			{
				if(event.keyCode != 40)
				{
					if(event.keyCode != 38)
					{
						var oAutoComp = new YAHOO.widget.AutoComplete(coaCodeObj,'codescontainer', functionObj);
						oAutoComp.queryDelay = 0;
						oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
						oAutoComp.useShadow = true;
						oAutoComp.maxResultsDisplayed = 15;
   						oAutoComp.useIFrame = true;
					}
				}
			yuiflag[currRow.rowIndex] = 1;
			}

	}

		 function fillNeibrAfterSplit(obj,neibrObjName)
		 {
		 			var temp = obj.value; temp = temp.split("`-`");
						obj.value=temp[0];
			 			PageManager.DescService.onblur(neibrObjName);
						var currRow=PageManager.DataService.getRow(obj);
						yuiflag[currRow.rowIndex] = undefined;
						neibrObj=PageManager.DataService.getControlInBranch(currRow,neibrObjName);
					if(temp[1]==null) return; else 	neibrObj.value = temp[1];
		}

		 function colTotal(obj,target){
		 	      var a = document.getElementsByName(obj.name);
		  	      count = 0;
		  	      for(var i = 0; i<=a.length-1;i++) if(a[i].value)
		  		  count += parseFloat(a[i].value);
		  		  count=Math.round(count*100)/100 ;
		 	      document.getElementById(target).value = count;
      	 }
		function calculateTotal() {
				var table=document.getElementById("chequeGrid");
				var totalAmountCell;
				var tAmountObj;
				var tAmount=0,temp;
				tAmountObj=document.getElementsByName('chequeGrid_chequeAmount');
				for(var i=0;i<tAmountObj.length;i++) {
					temp=parseFloat(tAmountObj[i].value);
					if(!isNaN(temp)) tAmount+=temp;
				}
				tAmountObj=document.getElementById('chequeAmountTotal');
				if(!isNaN(tAmount)) {
				tAmount=Math.round(tAmount*100)/100 ;
				tAmountObj.value=tAmount;}
		}

		 function validate()
		 {
		  //alert("inside the validate function");
		    var i, j, debit=0, credit=0, drTotal=0,creditAmount=0, crTotal=0, passedAmount=0,chequeAmountTotal=0;
			var table=document.getElementById("voucherDetailGrid");
			if(!table) return false;
			passedAmount = eval(document.journalVoucher.chequeDetail_passedAmount.value);
			passedAmount = isNaN(passedAmount) ? 0 : passedAmount;
    		if( passedAmount < 0)
    		{

			alert(' amount can not be nagative');
			return false;
			}
			var modeOfCln=getSelectedRadioValue(document.getElementsByName('modeOfCollection'));
			if(modeOfCln.toLowerCase()=="cheque")
			{
			if(document.journalVoucher.chequeGrid_chequeNo.value==''){
				alert('Enter Cheque Details');
				return false;
				}
			if(document.journalVoucher.chequeGrid_chequeNo.value){
			chequeAmountTotal = eval(document.journalVoucher.chequeGrid_chequeAmount.value);
					if(chequeAmountTotal>0 &&  document.journalVoucher.chequeGrid_chequeNo.value.length == 0){
						document.journalVoucher.chequeGrid_chequeNo.focus();
						alert('Cheque Number is missing for row ');
						return false;
					}
					if(document.journalVoucher.chequeGrid_chequeNo.value.length != 0 && document.journalVoucher.chequeGrid_chequeAmount.value.length == 0)
					{
					  document.journalVoucher.chequeGrid_chequeAmount.focus();
					  alert('Amount is missing for Cheque Number ');
						return false;
					}
					if(document.journalVoucher.chequeGrid_chequeNo.value.length != 0 && document.journalVoucher.chequeGrid_chequeDate.value.length == 0)
					{
					  document.journalVoucher.chequeGrid_chequeDate.focus();
					  alert('Date is missing for Cheque Number ');
						return false;
					}
			    	if(passedAmount != chequeAmountTotal){
			   		alert('Total Cheque Amount and Amount must be same');
			   		return false;
			   		}
			}
			else
			{
			  for(k=0; k<document.journalVoucher.chequeGrid_chequeAmount.length; k++)
			   {
					chequeAmount = eval(document.journalVoucher.chequeGrid_chequeAmount[k].value);
					chequeAmount = isNaN(chequeAmount)?0:chequeAmount;
					chequeAmountTotal = chequeAmountTotal + chequeAmount;
					if(chequeAmount>0 &&  document.journalVoucher.chequeGrid_chequeNo[k].value.length == 0){
						document.journalVoucher.chequeGrid_chequeNo[k].focus();
						alert('Cheque Number is missing for row ' + (k+1));
						return false;
					}
					if(document.journalVoucher.chequeGrid_chequeNo[k].value.length != 0 && document.journalVoucher.chequeGrid_chequeAmount[k].value.length == 0)
					{
					  document.journalVoucher.chequeGrid_chequeAmount[k].focus();
					  alert('Amount is missing for Cheque Number ' + document.journalVoucher.chequeGrid_chequeNo[k].value);
						return false;
					}
					if(document.journalVoucher.chequeGrid_chequeNo[k].value.length != 0 && document.journalVoucher.chequeGrid_chequeDate[k].value.length == 0)
					{
					  document.journalVoucher.chequeGrid_chequeDate[k].focus();
					  alert('Date is missing for Cheque Number ' + document.journalVoucher.chequeGrid_chequeNo[k].value);
						return false;
					}


			   }

			    if(passedAmount != chequeAmountTotal){
			   	alert('Total Cheque Amount and Amount must be same');
			   	return false;
				 	}
				}
			}
			if(document.journalVoucher.voucherDetail_creditAmount.value)
			{
			debit = eval(document.journalVoucher.voucherDetail_debitAmount.value);
			debit = isNaN(debit)?0:debit;
			drTotal = drTotal + debit;

			creditAmount = eval(document.journalVoucher.voucherDetail_creditAmount.value);
			creditAmount = isNaN(creditAmount)?0:creditAmount;
			crTotal = crTotal + creditAmount;

			if(debit>0 &&  document.journalVoucher.voucherDetail_glCode.value.length == 0){
			document.journalVoucher.voucherDetail_glCode.focus();
			alert('account code is missing for debit supplied field ' );
			return false;
							}
		    if(creditAmount>0 &&  document.journalVoucher.voucherDetail_glCode.value.length == 0){
						document.journalVoucher.voucherDetail_glCode.focus();
						alert('account code is missing for credit supplied field ');
						return false;
							}

			if(debit > 0 && creditAmount > 0){
			document.journalVoucher.voucherDetail_debitAmount.focus();
			alert('one account can have only credit or debit...CHECK ACCOUNT : ' + document.journalVoucher.voucherDetail_glCode.value);
			return false;
			}

			if(isNaN(eval(document.journalVoucher.voucherDetail_debitAmount.value)))
			document.journalVoucher.voucherDetail_debitAmount.value = 0;
			}
			else
			{
			/* checking for duplicate account codes */
			if(!checkForFunction_AccountCode('voucherDetailGrid','cv_fromFunctionCodeId','voucherDetail_glCode')) return false;

			for(i=0; i<document.journalVoucher.voucherDetail_debitAmount.length; i++){
			debit = eval(document.journalVoucher.voucherDetail_debitAmount[i].value);
			debit = isNaN(debit)?0:debit;
			drTotal = drTotal + debit;

			creditAmount = eval(document.journalVoucher.voucherDetail_creditAmount[i].value);
			creditAmount = isNaN(creditAmount)?0:creditAmount;
			crTotal = crTotal + creditAmount;

			if(debit>0 &&  document.journalVoucher.voucherDetail_glCode[i].value.length == 0){
			document.journalVoucher.voucherDetail_glCode[i].focus();
			alert('account code is missing for debit supplied field ' + (i+1));
			return false;
							}
		    if(creditAmount>0 &&  document.journalVoucher.voucherDetail_glCode[i].value.length == 0){
						document.journalVoucher.voucherDetail_glCode[i].focus();
						alert('account code is missing for credit supplied field ' + (i+1));
						return false;
							}

			if(debit > 0 && creditAmount > 0){
			document.journalVoucher.voucherDetail_debitAmount[i].focus();
			alert('one account can have only credit or debit...CHECK ACCOUNT : ' + document.journalVoucher.voucherDetail_glCode[i].value);
			return false;
			}

			if(isNaN(eval(document.journalVoucher.voucherDetail_debitAmount[i].value)))
			document.journalVoucher.voucherDetail_debitAmount[i].value = 0;
		}
	}
        /* if(i == 0)
		 			{
		 				debit = eval(document.journalVoucher.voucherDetail_debitAmount.value);
		 				debit = isNaN(debit)?0:debit;
		 				drTotal = drTotal + debit;

		 				if(debit>0 &&  document.journalVoucher.voucherDetail_glCode.value.length == 0){
		 					document.journalVoucher.voucherDetail_glCode.focus();
		 					alert('account code is missing for credit/debit supplied field');
		 					return false;
		 				}
		 				if(debit==0 &&  document.journalVoucher.voucherDetail_glCode.value.length != 0){
		 					document.journalVoucher.voucherDetail_debitAmount.focus();
		 					alert('enter debit amount for the account code ' + document.journalVoucher.voucherDetail_glCode.value);
		 					return false;
		 				}
		 				if(isNaN(eval(document.journalVoucher.voucherDetail_debitAmount.value)))
		 					document.journalVoucher.voucherDetail_debitAmount.value = 0;
		 			}*/
           	  credit = passedAmount+drTotal;
           	  credit=Math.round(credit*100)/100 ;
           	  crTotal=Math.round(crTotal*100)/100 ;
             	//alert("credit --"+credit +"crTotal---"+crTotal);
			 			if(credit != crTotal){
			 				alert('total credit amount and total debit amount must be same');
			 				return false;
			 			}

			 			if(credit<=0){
			 				alert('no transaction with no credit/debit');
			 				return false;
			 			}
			 		/*	if( document.journalVoucher.voucherHeader_narration.value.length == 0 )
										if(!confirm('narration is empty, click Ok to submit anyway.')){
											document.journalVoucher.voucherHeader_narration.focus();
											return false;
										}
					*/

			return true;
		}

		 function check(obj){
             if(obj.value=="Cheque"){
             		//	alert("inside the cheque cond");
             			if(chequeGridlen>0){

							for(var i=1;i<chequeGridlen;i++){
							//		alert("tabObj[i][0].value---"+tabObj[i][0]);
							//		alert("tabObj[i][1].value---"+tabObj[i][1]);
							//		alert("tabObj[i][2].value---"+tabObj[i][2]);
									tabObj[i][0].value="";
									tabObj[i][1].value="";
									tabObj[i][2].value="";
									tabObj[i][3].value="";




									}
								}

             		journalVoucher.chequeDetail_chequeNumber.value="";
             		journalVoucher.chequeDetail_chequeDate.value="";
             		journalVoucher.chequeDetail_chequeNumber.disabled=true;
             		journalVoucher.chequeDetail_chequeDate.disabled=true;
             		journalVoucher.chequeDetail_chequeNumber.removeAttribute('exilMustEnter');
             		journalVoucher.chequeDetail_chequeDate.removeAttribute('exilMustEnter');
             		var cglRow=document.getElementById('rowChequeGridLable');
					cglRow.style.display='block';
             		var cgRow=document.getElementById('rowChequeGrid');
					cgRow.style.display='block';
					var tgRow=document.getElementById('rowTotalGrid');
					tgRow.style.display='block';
					var rfRow=document.getElementById('rowRefno');
					rfRow.style.display='none';
					var rbRow=document.getElementById('rowBank');
					rbRow.style.display='none';

            	}

             else  if(obj.value=="Cash"){
             		journalVoucher.chequeDetail_chequeNumber.value="";
             		journalVoucher.chequeDetail_chequeDate.value="";
             		journalVoucher.chequeDetail_chequeNumber.disabled=true;
             		journalVoucher.chequeDetail_chequeDate.disabled=true;
					journalVoucher.chequeDetail_chequeNumber.removeAttribute('exilMustEnter');
             		journalVoucher.chequeDetail_chequeDate.removeAttribute('exilMustEnter');
             		var cglRow=document.getElementById('rowChequeGridLable');
					cglRow.style.display='none';
					var cgRow=document.getElementById('rowChequeGrid');
					cgRow.style.display='none';
					var tgRow=document.getElementById('rowTotalGrid');
					tgRow.style.display='none';
					var rfRow=document.getElementById('rowRefno');
					rfRow.style.display='none';
					var rbRow=document.getElementById('rowBank');
					rbRow.style.display='none';

				}
			 else  if(obj.value=="Others"){
					journalVoucher.chequeDetail_chequeNumber.value="";
					journalVoucher.chequeDetail_chequeDate.value="";
					journalVoucher.chequeDetail_chequeNumber.disabled=false;
             		journalVoucher.chequeDetail_chequeDate.disabled=false;
             		journalVoucher.chequeDetail_chequeNumber.setAttribute('exilMustEnter','true');
             		journalVoucher.chequeDetail_chequeDate.setAttribute('exilMustEnter','true');
             		var rfRow=document.getElementById('rowRefno');
					rfRow.style.display='block';
					var cglRow=document.getElementById('rowChequeGridLable');
					cglRow.style.display='none';
					var cgRow=document.getElementById('rowChequeGrid');
					cgRow.style.display='none';
					var tgRow=document.getElementById('rowTotalGrid');
					tgRow.style.display='none';
					var rbRow=document.getElementById('rowBank');
					rbRow.style.display='none';

			 }
			 else  if(obj.value=="Bank"){
			 		journalVoucher.chequeDetail_chequeNumber.value="";
					journalVoucher.chequeDetail_chequeDate.value="";
					journalVoucher.chequeDetail_chequeNumber.disabled=false;
					journalVoucher.chequeDetail_chequeDate.disabled=false;
					journalVoucher.chequeDetail_chequeNumber.removeAttribute('exilMustEnter');
             		journalVoucher.chequeDetail_chequeDate.removeAttribute('exilMustEnter');
					var rbRow=document.getElementById('rowBank');
					rbRow.style.display='block';
					var rfRow=document.getElementById('rowRefno');
					rfRow.style.display='block';
					var cglRow=document.getElementById('rowChequeGridLable');
					cglRow.style.display='none';
					var cgRow=document.getElementById('rowChequeGrid');
					cgRow.style.display='none';
					var tgRow=document.getElementById('rowTotalGrid');
					tgRow.style.display='none';
					//loads bank list if modeofcollection is 'bank'  and some fund is selected
					var fund=document.getElementById('fund_name');
			        if(fund.selectedIndex!=-1)
			        	getBankName();

			 }

          }


           function funClear(obj)
		  		 {
		  		   var v =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'function_code')
		  		   var w =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'cv_fromFunctionCodeId')
		  			if(v.value==""){
		  			v.value="";
		  			w.value="";
		  			}
		         }

		 function openSearch(obj){
		 if(PageManager.DataService.getQueryField('showMode')!=null && (PageManager.DataService.getQueryField('showMode')=='view' || PageManager.DataService.getQueryField('showMode')=='modify')) return false;
        	var a = new Array(4);
         	//var sRtn = showModalDialog("Search.html?screenName=miscReceipts","","dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
         	var sRtn =showModalDialog("Search.html?filterServiceID=3","","dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
         	if ( sRtn != '' ){
				a = sRtn.split("`~`");
				var x =PageManager.DataService.getControlInBranch(obj.parentNode,'voucherDetail_glCode');
				var y =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode ,'voucherDetail_accountName');
			//	var v =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'function_code')
			//	var w =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'cv_fromFunctionCodeId')
				x.value = a[0];
				y.value = a[1];
			/*	if(v.value=="")
				{
				v.value = a[3];
				w.value = a[4];
				} */
				//alert("a 0 value= "+a[0]+" a 1 value = " +a[1]+" a 2 value ="+a[2]+" a 3 value = " +a[3]+" a 4 value= "+a[4]);
		   	}
         }

		function openSearch1(obj, tableName){
		if(PageManager.DataService.getQueryField('showMode')!=null && (PageManager.DataService.getQueryField('showMode')=='view' || PageManager.DataService.getQueryField('showMode')=='modify')) return false;
		var a = new Array(2);
		var sRtn;
		var str="";
		if(tableName.toLowerCase()=='function'){
		 str = "Search.html?tableNameForCode=function";

		sRtn= showModalDialog(str,"",
				"dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
		if(sRtn != '')
		{
			a = sRtn.split("`~`");

			if(tableName.toLowerCase() == 'function')
			{
				//alert("a 0 value= "+a[0]+" a 1 value = " +a[1]+" a 2 value ="+a[2]);
				var y = PageManager.DataService.getControlInBranch(obj.parentNode,'function_code');
				y.value = a[1];
				var x = PageManager.DataService.getControlInBranch(obj.parentNode,'cv_fromFunctionCodeId');

				x.value = a[2];


			}
		}
	}
	}
       /*  function getInHandId(){
         		var control= document.getElementById('billCollector_name');
				PageManager.DataService.setQueryField('billCollector_name',control.value);
         		PageManager.DataService.callDataService('miscHandId');

         }*/
       /*  function calculateTotal(obj){
		 		var table=document.getElementById("voucherDetailGrid");
				var totalAmountCell;
				var tAmountObj,tInterestObj,tPenaltyObj,tRebateObj;
				var tAmount=0,tInterest=0,tPenalty=0,tRebate=0,temp;
				tAmountObj=document.getElementsByName('amount');

				for(var i=0; i < tAmountObj.length; i++ ){
					temp = parseFloat(tAmountObj[i].value);
					if( ! isNaN ( temp ) ) tAmount += temp;
				}

				tAmountObj = document.getElementById('totalAmount');
				if (!isNaN(tAmount)) tAmountObj.value=tAmount;
		 	}
		*/

 /*function getAccName(event) {
		  		clearTable(document.getElementById("completeTable"));
				PageManager.DescService.onblur(event);
			}

	 function getFunId(event) {
		  		clearTable(document.getElementById("completeTable"));
				PageManager.DescService.onblur(event);
			}
*/
		function selectCombo(){
			try{
			var counter_code = PageManager.DataService.getQueryField('billCollector_id');

				if (counter_code) {
					var obj=document.getElementById('billCollector_name');
					alert('OK')
					for(var i=0;i<obj.length;i++){
						if(obj.options[i].value==counter_code) {
							obj.options[i].selected=true;
							getInHandId();
							break;
						}
					}

				}

		/*	var department_code = PageManager.DataService.getQueryField('department_id');
				if (department_code) {
					var obj=document.getElementById('department_name');
					for(var i=0;i<obj.length;i++)
						if(obj.options[i].value==department_code) {
							obj.options[i].selected=true;
							break;
						}
				} */

				var fund_code = PageManager.DataService.getQueryField('fund_id');
				if (fund_code) {
					var obj=document.getElementById('fund_name');
					for(var i=0;i<obj.length;i++)
						if(obj.options[i].value==fund_code) {
							obj.options[i].selected=true;
							break;
						}
				}

				var fundSource_code = PageManager.DataService.getQueryField('fundSource_id');
								if (fundSource_code) {
									var obj=document.getElementById('fundSource_name');
									for(var i=0;i<obj.length;i++)
										if(obj.options[i].value==fundSource_code) {
											obj.options[i].selected=true;
											break;
										}
				}

				}catch(ex){}

		}

		function afterRefreshPage(dc){

				var cgn=PageManager.DataService.getQueryField('cgNumber');
	   		 	var sm=PageManager.DataService.getQueryField('showMode');
	   		 /*
	   		 	if(dc.values['serviceID']='newAccountNumber')
	   		 	{
	   		 	    var accObj=document.getElementById('bankAccount_accountNumber');
				  alert(accObj.selectedIndex);
				  try{
					accntMod(accObj);
					}
					catch(err){}

	   		 	}*/
	   		 	if("newAccountNumber"==dc.values['serviceID'] && cgn )
				{

		   		 	var accObj=document.getElementById('bankAccount_accountNumber');
					  //alert(accObj);
					  try{
						accntMod(accObj);
						}
						catch(err){}
				}
				if("getMiscDetails"==dc.values['serviceID'] && cgn && (sm=='edit'))
				{


				   var vnum=dc.values['voucherHeader_voucherNumber'];
				   var subVnum=vnum.substring(0,2);
				   document.getElementById("voucherHeader_voucherNumber").value=vnum.substring(2,vnum.length);
		 		   document.getElementById("vnum").value=subVnum;
		 		   if(document.getElementById("oldVoucherDate").value == "")
				   {
		 		   		document.getElementById("oldVoucherDate").value=formatDate2(dc.values['voucherHeader_voucherDate']);
		 		   }
		 		   //alert(document.getElementById("oldVoucherDate").value);

		 		 }
				var tab=dc.grids['voucherDetailGrid'];
				if(tab)
				{
				var count1 = 0,count2=0;
				for(var i=1;i<tab.length;i++){

				count1 += parseFloat(tab[i][5]);
				count2 += parseFloat(tab[i][4]);
				}

				document.getElementById('creditTotal').value=count1;
				document.getElementById('debitTotal').value=count2;


				if(dc.values['serviceID']=='getMiscDetails'){

					if(dc.grids['chequeGrid'].length==0)
					{

						PageManager.DataService.addNewRow('chequeGrid');

						PageManager.DataService.addNewRow('chequeGrid');

					}
					else(dc.grids['chequeGrid'].length==1)
					{

						PageManager.DataService.addNewRow('chequeGrid');

					}

				}




				}

				var voucherHeader_voucherDate=dc.values['voucherHeader_voucherDate'];
				if(voucherHeader_voucherDate){
					voucherDate=formatDate2(voucherHeader_voucherDate);
					document.getElementById('voucherHeader_voucherDate').value=voucherDate;
				}
				var chequeDetail_chequeDate=dc.values['chequeDetail_chequeDate'];
				if(chequeDetail_chequeDate){
				chequeDetail_chequeDate=formatDate2(chequeDetail_chequeDate);
				document.getElementById('chequeDetail_chequeDate').value=chequeDetail_chequeDate;
				}

				var mode=dc.values['modeOfCollection'];
				if(mode != null){
				if(mode=='Cash'){
					//document.getElementById('billCollector_cashInHand').value=dc.values['glCode'];
				}else{
					//document.getElementById('billCollector_chequeInHand').value=dc.values['glCode'];
				     }
				}

				if(!window.data){
					selectCombo();
					window.data=true;
				}
				var countboundary=dc.values['noOfBoundaryLevels'];
			if(countboundary==1){
				var boundaryLevelId=dc.values['boundaryLevelId'];
				var boundaryTypeId=dc.values['boundaryTypeId'];
				PageManager.DataService.setQueryField('boundaryLevelId',boundaryLevelId);
				PageManager.DataService.setQueryField('boundaryTypeId',boundaryTypeId);
				PageManager.DataService.callDataService('DefaultChequeValue');
				PageManager.DataService.callDataService('DefaultCashValue');

			}
				var bonLen= document.getElementById('boundaryLevelId');
				if(bonLen.selectedIndex != -1 && bonLen.value.length>0) {
				if(document.getElementById('chequeInHand').value.length==0)
					document.getElementById('chequeInHand').value=dc.values['chequeinhand'];
				if(document.getElementById('chequeInHand').value.length==0)
					document.getElementById('cashInHand').value=dc.values['cashinhand'];

				}
				if(dc.values['serviceID']=='getMiscDetails')
				{
					document.getElementById('TypeOfCollection').value =dc.values['modeOfCollection'];
					//alert("modofcol-----"+document.getElementById('TypeOfCollection').value);

					var bId=dc.values['bank_id'];
					if(bId){
						getAccountNumbers();
					}
					if(dc.values['modeOfCollection'] == 'Cheque')
					{
						calculateTotal();
					}
				}
				if(dc.values['databaseDate']!='' && dc.values['serviceID']=='miscReceiptData')
				{
				var dt=dc.values['databaseDate']
				document.getElementById('voucherHeader_voucherDate').value=dt;
				type=dc.values['type'];
				document.getElementById('Voucherheader_name').value=type;
				}

					var sm=PageManager.DataService.getQueryField('showMode');
					if(dc.values['modeOfCollection'] == 'Bank' && (sm == 'view'|| sm == 'modify')){
						bankName();

				}
				if((dc.values['modeOfCollection'] == 'Bank'||dc.values['modeOfCollection'] == 'Cash'||dc.values['modeOfCollection'] == 'Cheque'||dc.values['modeOfCollection'] == 'Others') && sm == 'edit')
				{
		    		var fund=document.getElementById('fund_name');
		        	if(fund.selectedIndex!=-1)
				 	{
				    var fundValue=fund.options[fund.selectedIndex].value;
	 				PageManager.DataService.setQueryField('Fund_id',fundValue);
	 				var obj2=document.getElementById('bank_id');
	 				obj2.setAttribute('exilListSource',"BanksList1");
	 				PageManager.DataService.setQueryField('Fund_id',fundValue);
	 				PageManager.DataService.callDataService('bankAndBranchNew');
					}
				}
			}
		 function afterUpdateService(dc){
			  		disableControls(0,true);
		 		 	if(str=="new") {	window.location="MiscReceipt.htm?";
		 		 	return true; }
					if(str=="close") window.close()


			}
		function onClickCancel()
			{
				window.location="MiscReceipt.htm";
		}
		function disableControls(frmIndex, isDisable){
			for(var i=0;i<document.forms[frmIndex].length;i++)
			{
				document.forms[frmIndex].elements[i].disabled =isDisable;
				if(PageManager.DataService.getQueryField('showMode')=='view' &&
					document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='backbutton')
					document.forms[frmIndex].elements[i].disabled =false;
				if(PageManager.DataService.getQueryField('showMode')=='modify'
						&& (document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='modGrid' ||
						 document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='reverseSubmit' ))
					document.forms[frmIndex].elements[i].disabled =false;
			}
		}

		function hideButtons(){

							document.getElementById('modGrid').style.display="block";
							document.getElementById('submitGrid').style.display ="none";

				}
				function hideBut(){

					document.getElementById('modGrid').style.display="none";
					document.getElementById('submitGrid').style.display ="block";

		}
		function getCashChequeInHand(obj){

			var val=obj.options[obj.selectedIndex].value;
			var bonLen= document.getElementById('boundaryLevelId');
			if(bonLen.selectedIndex != -1 && bonLen.value.length>0) {

			PageManager.DataService.setQueryField("boundaryLevelId",val);
			PageManager.DataService.callDataService('CashChequeValues');
			}
		}
		function reverse()
		{
					var cgn=PageManager.DataService.getQueryField('cgNumber');
		 	 if(cgn){
						document.getElementById('reverseRecord').style.display='block';
						var vcObj=document.getElementById('voucherHeader_newVcNo');
						vcObj.setAttribute('exilMustEnter','true');
						vcObj.disabled=false;
						var vdObj=document.getElementById('voucherHeader_effDate')
						vdObj.setAttribute('exilMustEnter','true');
						vdObj.disabled=false;
						var bcObj=document.getElementById('diffDebit')
						bcObj.disabled=false;
						document.getElementById('modeOfExec').value="modify";
						document.getElementById('reverseSubmit').style.display ="block";
					}
		}
		function showglEntry()
		{
			hideColumns(0);
			var modeOfCln=getSelectedRadioValue(document.getElementsByName('modeOfCollection'));
			if(modeOfCln.toLowerCase()!="bank"){
			document.getElementById('bank_id').removeAttribute('exilMustEnter');
			document.getElementById('bankAccount_accountNumber').removeAttribute('exilMustEnter');
			}
			if(!PageValidator.validateForm())
				return false;
			var amt=document.getElementById("chequeDetail_passedAmount").value;
			if(!amt){
			alert("Enter the Amount");
			return false;
			}
			var gltable= document.getElementById("voucherDetailGrid");
			code=PageManager.DataService.getControlInBranch(gltable.rows[1],'voucherDetail_glCode').value;
			if(code)
			{
			PageManager.DataService.setQueryField("showGlEntries","show");
			var payType=getSelectedRadioValue(document.getElementsByName('modeOfCollection'));
			PageManager.DataService.setQueryField("typeOfPayment",payType);
			var cashId=document.getElementById("cashInHand").value;
			PageManager.DataService.setQueryField("cIHand",cashId);
			var chequeId=document.getElementById("chequeInHand").value;
			PageManager.DataService.setQueryField("cqInHand",chequeId);
			if(payType=="Bank")
				{
					var bankAccObj=document.getElementById("bankAccount_accountNumber");
					if (bankAccObj.options.length <=0)
					{
						alert("select Bank and Account code");
						return;
					}
					var bankAcc=bankAccObj.options[bankAccObj.selectedIndex].value;
					PageManager.DataService.setQueryField("bankAccId",bankAcc);
				}
					PageManager.DataService.callDataService('miscReceiptInsert');

			}
			else
			{
				alert("Enter Account code Details");
				return false;
			}
		}
		function showEntry()
		{
			var trObj;
			var tObj=document.getElementById("showEntries");
			var cr=0,dr=0;
			tObj.style.display="block";
			var tableObj=document.getElementById("entries");

			var gltable= document.getElementById("voucherDetailGrid");
			for(var i=tableObj.rows.length-1;i>=2;i--)
			{
				tableObj.deleteRow(i);
			}
			for(var i=1;i<gltable.rows.length;i++)
			{

				code=PageManager.DataService.getControlInBranch(gltable.rows[i],'voucherDetail_glCode').value;
				if(code)
				{
				name=PageManager.DataService.getControlInBranch(gltable.rows[i],'voucherDetail_accountName').value;
				debit=PageManager.DataService.getControlInBranch(gltable.rows[i],'voucherDetail_debitAmount').value;
				dr=dr+debit;
				credit=PageManager.DataService.getControlInBranch(gltable.rows[i],'voucherDetail_creditAmount').value;
				cr=cr+credit
				narration=PageManager.DataService.getControlInBranch(gltable.rows[i],'voucherDetail_narration').value;
				var Obj=PageManager.DataService.getControlInBranch(tableObj.rows[1],"display_Code");
				trObj=PageManager.DataService.getRow(Obj);
				 if(i==1){
								newRow=trObj;
								objt1=PageManager.DataService.getControlInBranch(newRow,'display_Code');
				 				objt2=PageManager.DataService.getControlInBranch(newRow,'display_Head');
				 				objt3=PageManager.DataService.getControlInBranch(newRow,'display_Debit');
				 				objt4=PageManager.DataService.getControlInBranch(newRow,'display_Credit');
				 				objt5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
				 				if(code=="") code=" -"; if(name=="") name=" -"; if(debit=="") debit=" 0"; if(credit=="") credit=" 0"; if(narration=="") narration=" -";
				 				objt1.innerHTML=code;
				 				objt2.innerHTML=name;
				 				objt3.innerHTML=debit;
				 				objt4.innerHTML=credit;
								objt5.innerHTML=narration
				 }else{

						 var newRow=trObj.cloneNode(true);
						newRow=tableObj.tBodies[0].appendChild(newRow);
						objt1=PageManager.DataService.getControlInBranch(newRow,'display_Code');
						objt2=PageManager.DataService.getControlInBranch(newRow,'display_Head');
						objt3=PageManager.DataService.getControlInBranch(newRow,'display_Debit');
						objt4=PageManager.DataService.getControlInBranch(newRow,'display_Credit');
						objt5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
						if(code=="") code=" -"; if(name=="") name=" -"; if(debit=="") debit=" 0"; if(credit=="") credit=" 0"; if(narration=="") narration=" -";
						objt1.innerHTML=code;
						objt2.innerHTML=name;
						objt3.innerHTML=debit;
						objt4.innerHTML=credit;
						objt5.innerHTML=narration;
				}
			  }
			}
				passedAmount = eval(document.journalVoucher.chequeDetail_passedAmount.value);
				passedAmount = isNaN(passedAmount) ? 0 : passedAmount;
				if( passedAmount < 0){
							alert(' amount can not be nagative');
							return false;
							}

				var iRow=glNameCode.split(";");
				var rowContents=null;tempObj=null;
				for(var i=1;i<(iRow.length)-1;i++)
				{
				rowContents=iRow[i].split("^");
				var newRow=trObj.cloneNode(true);
				newRow=tableObj.tBodies[0].appendChild(newRow);
				tempObj1=PageManager.DataService.getControlInBranch(newRow,'display_CodeType');
				tempObj1.innerHTML=rowContents[0];
				tempObj2=PageManager.DataService.getControlInBranch(newRow,'display_Code');
				tempObj2.innerHTML=rowContents[1];
				tempObj2=PageManager.DataService.getControlInBranch(newRow,'display_Head');
				tempObj2.innerHTML=rowContents[2];
				tempObj3=PageManager.DataService.getControlInBranch(newRow,'display_Credit');
				tempObj3.innerHTML="0";
				tempObj4=PageManager.DataService.getControlInBranch(newRow,'display_Debit');
				tempObj4.innerHTML=passedAmount;
				tempObj5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
				tempObj5.innerHTML=" -";


			}


			 var dSum=0;
			 var cSum=0;
			for(var i=1;i<tableObj.rows.length;i++)
			{

			  var dObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_Debit");
			  var cObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_Credit");
			 if(!isNaN(parseFloat(dObj.innerHTML)))
			 {
			   var sum=(parseFloat(dObj.innerHTML));
			   dSum=dSum+sum;
			 }
			 if(!isNaN(parseFloat(cObj.innerHTML)))
			 {
			   var sum=(parseFloat(cObj.innerHTML));
			   cSum=cSum+sum;
			 }
			}
			var newRow=trObj.cloneNode(true);
			newRow=tableObj.tBodies[0].appendChild(newRow);
			objt1=PageManager.DataService.getControlInBranch(newRow,'display_Code');
			objt2=PageManager.DataService.getControlInBranch(newRow,'display_Head');
			objt3=PageManager.DataService.getControlInBranch(newRow,'display_Debit');
			objt4=PageManager.DataService.getControlInBranch(newRow,'display_Credit');
			objt5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
			objt1.innerHTML=" ";
			objt2.innerHTML=" ";
			objt3.innerHTML=Math.round(dSum*100)/100;
			objt4.innerHTML=Math.round(cSum*100)/100;
			objt5.innerHTML=" ";

	}
	//This will enable all the narration fields in the detail
		function enableControls(frmIndex, isDisable){
			for(var i=9;i<=document.forms[frmIndex].length-17;i=i+1){
				alert(document.forms[frmIndex].elements[i].name);
				document.forms[frmIndex].elements[i].disabled =isDisable;
			}
		}
	function edit(){
				var cgn=PageManager.DataService.getQueryField('cgNumber');
		 		if(cgn){
		 			//document.forms[0].voucherHeader_cgn.disabled=true;
		 			document.getElementById("vnum").style.display="block";
		 			//document.forms[0].voucherHeader_voucherNumber.disabled=true;
		 			document.getElementById('submitGrid').style.display ="block";
					document.getElementById('modeOfExec').value="edit";
					//enableControls(0,false);
		 	 	}
		}
function hideColumns(index)
	{
		var table=document.getElementById('entries');
	   	for(var i=0;i<table.rows.length;i++){
			table.rows[i].cells[index].style.display="none";
	   	}
	}

function fillDate(obj){
		PageValidator.showCalendar('selectedDate');
		row = PageManager.DataService.getRow(obj);
		table = document.getElementById('chequeGrid');
		ctrl = PageManager.DataService.getControlInBranch(table.rows[row.rowIndex], 'chequeGrid_chequeDate');
		ctrl.value = document.getElementById('selectedDate').value;
		document.getElementById('selectedDate').value = "";
	}
	function clearCombo(cId)
	 {
		var bCtr=document.getElementById(cId);
		for(var i=bCtr.options.length-1;i>=0;i--)
		{
			bCtr.remove(i);
		}
 	}
	function getAccountNumbers()
	{
		sIndex=null;
		var bCtrl=document.getElementById('bank_id');
		if(bCtrl.selectedIndex==-1)return;
		var text=bCtrl.options[bCtrl.selectedIndex].value;
		if(!text || text.length==0)return;
		var index=text.indexOf("-");
		brId=text.substring(index+1,text.length);
		var accObj=document.getElementById('bankAccount_accountNumber');
		accObj.setAttribute("exilListSource","accountList");
		var fund=document.getElementById('fund_name');
		var fundValue=fund.options[fund.selectedIndex].value;
	 	PageManager.DataService.setQueryField('fundValueT',fundValue);
		PageManager.DataService.setQueryField('branchIdT',brId);
		PageManager.DataService.callDataService('newAccountNumber');
			}


		function getBankName()
		    {
		    	var modeOfCln=getSelectedRadioValue(document.getElementsByName('modeOfCollection'));
				if(modeOfCln.toLowerCase()=="bank"){
		    	var len = document.journalVoucher.bank_id.options.length;
		    	for(var i=0;i<len;i++)
		    	document.journalVoucher.bank_id.options[0] = null;

		    	var fund=document.getElementById('fund_name');
		        if(fund.selectedIndex!=-1)
				 {
				    var fundValue=fund.options[fund.selectedIndex].value;
	 				PageManager.DataService.setQueryField('Fund_id',fundValue);
	 				var obj2=document.getElementById('bank_id');
	 				obj2.setAttribute('exilListSource',"BanksList1");
	 				PageManager.DataService.setQueryField('Fund_id',fundValue);
	 				PageManager.DataService.callDataService('bankAndBranchNew');
				}
			}
		}
	function bankName()
			{
				var ctrl = document.getElementById('bank_id');
				var branchid = ctrl.options[ctrl.selectedIndex].value;
				var a = new Array(2);
				a = branchid.split('-');
				PageManager.DataService.setQueryField('bankId',a[0]);
				PageManager.DataService.setQueryField('Id',a[1]);
				PageManager.DataService.callDataService('getBankName');
			}

/*
	We implement AJAX here. The remaining functions are present in script/jsCommonMethods.js.
	Whenever user enters some value this function will be triggered.
*/

 // VALIDATION FOR FUNCTION NAME CODE
     function autoCompletion1(obj) {
   		var menu=document.getElementById("menu-popup");
		menu.style.setAttribute("left", "0px");
      	var row,nameCell;
      	  	var currRow=PageManager.DataService.getRow(obj);
			var size=codeArray.length-1;
		 //  	alert(size);

		   if(codeArray != null )
		   	{
		   		//keyCodes Values
		   		//13 - enter, 8 - backspace, 46 - delete, 40 - down arrow, 38 - up arrow
		   		if(event.keyCode == 13)
		   		{
		   		 getFunId(event);
		   		 return false;
		      		}
		      		if((event.keyCode == 8) || (event.keyCode == 46))
		      		k=-1;

		   			while(event.keyCode == 40 && codeArray[0] != null )
		   			{
		      			if(size<(k+1))
		      			{
		      				k=-1;
		      			}
		      			k++;

					PageManager.DataService.getControlInBranch(currRow,'function_code').value=codeArray[k];
		      			return false;
		      			}

						while(event.keyCode == 38 && codeArray[0] != null )
						{
		      			if(k==-1)
		      			{
		      				return false;
		      			}
		      			if(k==0)
		      			{
		      				k=size+1;
		      			}
	     		     k--;
	     		     PageManager.DataService.getControlInBranch(currRow,'function_code').value=codeArray[k];
	        	 	return false;
	     				}

      }//main if

        function_code=PageManager.DataService.getControlInBranch(currRow,'function_code').value;
   		var type='functionName';
          if (function_code == "") {
              clearTable(document.getElementById("completeTable"));
          } else {
               var url = "../commons/Process.jsp?type=" +type+ "&name=" + function_code+ " ";
	           	var req2 = initiateRequest();
              req2.onreadystatechange = function() {
                  if (req2.readyState == 4) {
                      if (req2.status == 200) {
                      	var codes2=req2.responseText;
                      	paintCodes(codes2,document.getElementById("auto-row"),document.getElementById("menu-popup"),document.getElementById("completeTable"));
                      	  	}
                      	  	else {

                          clearTable(document.getElementById("completeTable"));
                      }
                  }
              };
                   req2.open("GET", url, true);
                   req2.send(null);
          }
   }





   function checkForModify(obj)
	{
	    dt=obj.value;
	    dt=formatDateToDDMMYYYY2(dt);
		if(!dateValid(dt))
		{
		   alert('Invalid Date..');
		   obj.value='';
		   return;
		}
		var today=document.getElementById('databaseDate').value;
			if(today==null || today=='')
			{
			  today=document.getElementById('voucherHeader_voucherDate').value;
			}
			var splits=today.split("/");
			var currYr=splits[2]-5;
			var arr = dt.split("/");
			yr = arr[2];
			if(currYr>yr )
			{
			 alert('Enter Valid Year');
			 obj.value='';
			 return false;
			}
			if((currYr+5)<yr )
			{
			 alert('Enter Valid Year ');
			 obj.value='';
			 return false;
			}
	}
	function accntMod(obj)
	{	//alert("inside accntmod ....");
		if(obj.selectedIndex==-1)
		 return;


		// alert("account no:"+document.getElementById('bankAccount_accountNumber').value);


		if(sIndex!=null)
		{
				document.forms[0].bankAccount_accountNumber.options[sIndex]= new Option(sText,sValue);
		}

		var text=obj.options[obj.selectedIndex].innerHTML;
	    var temp=text.split(" -- ");
		sIndex=obj.selectedIndex;
		sValue=obj.options[obj.selectedIndex].value;
		sText=text;
		if(!temp[1])
		    temp[1]=" ";
		 document.getElementById("acc_Desc").value=temp[1];
	   if(temp[1]!=null && temp[1]!="")
	   {//alert(temp[0]);
	     obj.options[obj.selectedIndex].text=temp[0];
	     //document.getElementById("acc_Desc").value=temp[1];
	   }
	}
function showAssetDetails()
{

	showModalDialog("../HTML/AssetSaleEnquiry.htm","",
				"dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");

}
    </script>
</head>
<body  id= bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0"
		 marginheight="0" marginwidth="0" onLoad="onloadTasks();" onKeyDown ="CloseWindow(event); " ><!------------------ Header Begins Begins--------------------->
		<form name="journalVoucher">
				<input  type="hidden" id="glCode" name="glCode">
				<input type="hidden" name="databaseDate" id="databaseDate">
				<input type=hidden id="modeOfExec" name="modeOfExec" value="new">
				<input type=hidden id="Voucherheader_name" name="Voucherheader_name" >
				<input type="hidden" name="voucherHeader_id" id="voucherHeader_id">
				<input type="hidden" name="TypeOfCollection" id="TypeOfCollection">
<input type="hidden" name="isBankEntry" id="isBankEntry" value="false">
<input type="hidden" name="oldVoucherDate" id="oldVoucherDate">
				<input type="hidden" name="rType" id="rType" value="P">
				<input type="hidden" name="tType" id="tType" value="R">
				<input type="hidden" name="cgnNum" id="cgnNum">
				<input type="hidden" name="funidvalue" id="funidvalue">
				<input type="hidden" name="selectedDate" id="selectedDate">

			<table width="100%" border="0" cellpadding="0" cellspacing="0" align="center">
				<tr >
					<td valign="top" class="normaltext">
						<table width="100%" border="0" cellpadding="3" cellspacing="0">
								<!-- tr>
									<td class="tableheader" valign="center" colspan="3"><span class="screenName">Miscellaneous Receipt</span></td><td class="tableheader" valign="center" align="right"><a href='#' onclick=newWindow('../HTML/AddAccountCode.htm') ><span class="link">Add Account Code</span></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="headerwhite1" align="centre"><a onclick="newWindow('../HelpAssistance/Miscellaneous Receipts.htm')";><IMG height=20 src="../images/help.gif" width=40></a></span></td>
								</tr -->

								<tr  >
									<td align="right" valign="center" id="cgnLabel" name="cgnLabel" class="labelcell" width="18%" style="DISPLAY: none">
										<div align="right"> CG&nbsp;Number</div>
									</td>
									<td width="343" id="cgnText" name="cgnText" style="DISPLAY: none" >
										<span class="fieldcell"><input class="fieldcellwithinputwide" name="voucherHeader_cgn" id="voucherHeader_cgn"  MaxLength="10" readOnly size="20"></span>
									</td>
									<td align="right" valign="center" width="13%">
										<div align="right" class="labelcell" >Voucher&nbsp;Number<span class="leadon">*</span></div>
									</td>
									<td width="38%"><table cellpadding="0" cellspacing="0"><tr>
										<td  class=smallfieldcell><input  class="fieldcellwithinputwide" type=text readonly style="WIDTH:25px; HEIGHT: 22px" maxlength="2" name="vnum" id="vnum" style="Display:none"></td>
									   <td class=smallfieldcell><input class="fieldcellwithinputwide" name="voucherHeader_voucherNumber" id="voucherHeader_voucherNumber" maxlength="10" exilDataType="exilAlphaNumeric" exilMustEnter="true" size="20" ></td></tr></table>
									</td>
								</tr>
								<tr>
									<td align="right" valign="center" height="23" ><div align="right" class="labelcell">Counter&nbsp;
										</div>
									</td>
									<td height="23" >
                    					<span class="smallfieldcell"><SELECT id="billCollector_name" name="billCollector_name" class="fieldcell" exilListSource="billCollectorList">
                    					</SELECT></span>
									</td>
									<td align="right" valign="center" height="23" >
										<div align="right" class="labelcell">Voucher&nbsp;Date<span class="leadon">*</span></div>
									</td>
									<td height="23" >
										<span class="smallfieldcell"><INPUT class="fieldcellwithinputwide" name="voucherHeader_voucherDate" onkeyup="DateFormat(this,this.value,event,false,'3')"  exilDataType="exilAnyDate" exilMustEnter="true"  id    ="voucherHeader_voucherDate" style="WIDTH: 105px; HEIGHT: 19px"
            exilCalendar="true" size="20"></span>
									</td>
								</tr>

								<tr>
									<td align="right" valign="center"  >
										<div align="right" class="labelcell"><span class="leadon"><FONT color=#00438c>Mode&nbsp;of&nbsp;Collection<span class="leadon">*</span></FONT></span></div>
									</td>
									<td class="normaltext">
									<table width="188">
									<tr><td class=labelcell>
									<input type="radio" value="Cash"  id="modeOfCollection" name="modeOfCollection" onClick="check(this);" checked>Cash&nbsp;&nbsp;&nbsp;
									<input type="radio" value="Cheque" id="modeOfCollection" name="modeOfCollection" onClick="check(this);">Cheque
									</td></tr>
									<tr><td class="labelcell">
									<!--INPUT type=radio value=Others id=modeOfCollection onclick=check(this);  name=modeOfCollection>Others-->
									<input type="radio" value="Bank"  id="modeOfCollection" name="modeOfCollection" onClick="check(this);" >Bank
									</td></tr></table>
          						  </td>
									<td align="right" valign="center" >
            							<DIV align=right class="labelcell" >Fund&nbsp;<SPAN class=leadon>*</SPAN></DIV>
									</td>
									<td >
                    					<span class="smallfieldcell"><SELECT  id="fund_name" name="fund_name" onChange= "getBankName();" exilMustEnter="true" class=fieldcell exilListSource="fundList">
           								</SELECT></span>
           								<INPUT type=hidden id="Fund_id" readOnly name="Fund_id">
           								&nbsp;</td>
								</tr>
								<tr>
									<td align="right" valign="center" >
								         <DIV align=right class="labelcell" >Financing Source&nbsp;</DIV>
									</td>
									<td >
								        <span class="smallfieldcell"><SELECT  id="fundSource_name" name="fundSource_name"  class="combowidth2" exilListSource="fundSourceList">
								        </SELECT></span>
									</td>
									<td >&nbsp;</td>
									<td>&nbsp;</td>

								</tr>
								<tr  style="DISPLAY: none" id="rowBank">
					  <td><div align="right" valign="center" class="labelcell"> Bank<span class="leadon">*</span></div></td>
							  <td>
								<span class="smallfieldcell"><select  name="bank_id" id="bank_id" class="combowidth2" onChange="getAccountNumbers()" exilMustEnter="true" ></select></span>
								</td>
							  <td><div  align="right" valign="center" class="labelcell">Account Number<span class="leadon">*</span></div></td>
							  <td ><span class="smallfieldcell"><SELECT id="bankAccount_accountNumber" class="combowidth"  name="bankAccount_accountNumber" exilMustEnter="true" onchange="accntMod(this);"></SELECT></span>
							  		<input type="text" id="acc_Desc" name="acc_Desc"  class=labelcell readonly></td>
							  </tr>

								<tr  style="DISPLAY: none" id="rowRefno">
									<td align="right" ><div align="right" class="labelcell">Ref No</div>
									</td>
									<td >
                   					 <span class="fieldcell"><INPUT class=fieldcellwithinputwide name="chequeDetail_chequeNumber" exilDataType="exilUnsignedInt" id="chequeDetail_chequeNumber" MaxLength ="10"  disabled></span>
                   					 </td>
									<td align="right" valign="center" class="labelcell"><div align="right">Reference Date</div>
									</td>
									<td >
									<span class="smallfieldcell"><INPUT class=fieldcellwithinputwide name="chequeDetail_chequeDate" onkeyup="DateFormat(this,this.value,event,false,'3')"  exilDataType="exilAnyDate" id="chequeDetail_chequeDate" MaxLength ="11" disabled exilCalendar="true"></span>
           							</td>
								</tr>
								<tr ><!--<td align="right" valign="center" ><span align="right" class="normaltext"> Cash&nbsp;In&nbsp;Hand</span>
									</td>
									<td >
                   					 <input id="billCollector_cashInHand" class="fieldinput" name="billCollector_cashInHand" readonly>
									</td>-->
									<td><div align="right" valign="center" class="labelcell"> &nbsp;Amount<span class="leadon">*</span></div></td>
									 <td width="343" >
									<span class="fieldcell"><input class="fieldinput-right" name="chequeDetail_passedAmount" id="chequeDetail_passedAmount"  maxlength="16" exilDataType="exilUnsignedDecimal" exilMustEnter="true" exilMax="9999999999999.99" exilMin="1" ></span>
							  		</td>
							  		<td align="right" valign="center">
									<DIV class="labelcell" >Narration</DIV>
									</td>
									<td >
                                    <TEXTAREA class=narrationfieldinput id=voucherHeader_narration name=voucherHeader_narration exilDataType="exilAnyChar" MaxLength="250" rows="1" cols="20"></TEXTAREA>
									</td>
									</tr>
									<tr  name=assetRow id=assetRow style="DISPLAY: none">
										<td align="right" valign="center" class="leadon" onClick="showAssetDetails()"><a href="#">Asset Sale Details</a></td>
										<td colspan=3>&nbsp;</td>
									</tr>
									<!--<tr ><td align="right"><span align="right" class="normaltext" >Cheque&nbsp;In&nbsp;Hand </span></td>
									<td>
									<input id="billCollector_chequeInHand" class="fieldinput" name="billCollector_chequeInHand" readonly>
									</td>
									<td align="right" valign="center">
									<DIV class="normaltext" >Narration</DIV>
									</td>
									<td ><TEXTAREA class=narrationfieldinput id=voucherHeader_narration name=voucherHeader_narration exilDataType="exilAnyChar" MaxLength="250"></TEXTAREA>
									</td>

									<td >&nbsp;</td>
									<td >&nbsp;</td>-->

								</tr>
						</table>
					</td>
					</tr>
<tr ><td>&nbsp;</td></tr>
		<tr ><td>
      <TABLE id="boundarytableGrid" cellSpacing=0 cellPadding=0 width="55%" align=center border=1 NAME="boundarytableGrid" >

        <TR class=rowheader >
          <TD class=thStlyle width="41%"><DIV align=center>Boundary Level<FONT
      color=#ff0000>*</FONT> </DIV></TD>
          <TD class=thStlyle width="26%"><DIV align=center>Cash In Hand</DIV></TD>
          <TD class=thStlyle width="31%"><DIV align=center>Cheque In Hand Code</DIV></TD>
          </TR>
        <TR class=fieldcell >
         <TD class=smallfieldcell width="41%" exilRetainValue="true"><SPAN align="left" exilTrimLength="15">
			<SELECT id="boundaryLevelId" style="WIDTH: 158px; HEIGHT: 21px" name="boundaryLevelId" exilDataType="exilAlphaNumeric"  exilMustEnter="true" onChange="getCashChequeInHand(this);"  ></SELECT></SPAN> </TD>
          <TD class="smallfieldcell" exilRetainValue="true">
            <DIV><INPUT class="fieldcell" id="cashInHand" style="WIDTH: 172px; HEIGHT: 22px" readOnly size=35 name="cashInHand" exilDataType="exilAnyChar"><input type="hidden" id="cashinhandId" name="cashinhandId"></DIV></TD>
          <TD class="smallfieldcell" exilRetainValue="true">
            <DIV><INPUT class=fieldcellwithinput id="chequeInHand"
      style="WIDTH: 172px; HEIGHT: 22px" readOnly size=35 name="chequeInHand"
      exilDataType="exilAnyChar"><input type="hidden" id="chequeinhandId" name="chequeinhandId"></DIV></TD>
            </TR></TABLE>
</td></tr>
<tr ><td>&nbsp;</td></tr>
<tr style="DISPLAY: none" id="rowChequeGridLable" ><td height="16">
<table STYLE="margin-left:55px;"><tr class="rowheader" height="70%"><td  class="thStlyle ">&nbsp;&nbsp;&nbsp;&nbsp;Cheque Detail&nbsp;&nbsp;&nbsp;&nbsp;</td></tr></table>
</td></tr>
<tr style="DISPLAY: none" id="rowChequeGrid" ><td>
             <table id="chequeGrid" name="chequeGrid" STYLE="margin-left:28px;" cellSpacing=0 cellPadding=0 width="50%" align=left border=1 >
			 <tr class=rowheader >

			  <td class=thStlyle width="41%"><DIV align=center>Cheque Number</DIV></TD>
			  <td class=thStlyle width="26%"><DIV align=center>Amount</DIV></TD>
			  <td class=thStlyle width="31%"><DIV align=center>Cheque Date</DIV></TD>
			 </tr>
			  <tr class=smallfieldcell ><input  type="hidden" name="chequeGrid_chequeId" id="chequeGrid_chequeId">
			  <td class=smallfieldcell ><input class=fieldcellamount id="chequeGrid_chequeNo" name="chequeGrid_chequeNo" style="WIDTH: 172px; HEIGHT: 22px"  exilDataType="exilUnsignedInt" MaxLength ="10"  ></TD>
			  <td class=smallfieldcell ><input class=fieldcellamount id="chequeGrid_chequeAmount" name="chequeGrid_chequeAmount" style="WIDTH: 172px; HEIGHT: 22px"  exilDataType="exilUnsignedDecimal" maxlength="16" exilMin="1" onBlur="calculateTotal()" ></TD>
			  <td class=smallfieldcell ><input class=smallfieldcell id="chequeGrid_chequeDate" name="chequeGrid_chequeDate" onkeyup="DateFormat(this,this.value,event,false,'3')" style="WIDTH: 172px; HEIGHT: 22px"  onKeyDown="addNewRow('chequeGrid','chequeGrid_chequeNo')"  onblur="checkForModify(this)" SIZE="20"><A onclick="fillDate(this)" tabIndex=-1 href=#><IMG tabIndex=-1 src="/egi/resources/erp2/images/calendar.gif" valign=center WIDTH="22" HEIGHT="19" ></A> </TD>
              </tr></table>
</td></tr>
<tr style="DISPLAY: none" id="rowTotalGrid"  ><td>
			<table  STYLE="margin-left:28px;" cellSpacing=0 cellPadding=0 width="50%" align=left border=1>
			<tr>
			<td ><span style="WIDTH: 172px; HEIGHT: 22px" class=fieldcellamount id=SPAN1>Total</span></td>
            <td ><input class="fieldcellamount" size=16 id="chequeAmountTotal" name="chequeAmountTotal" style="WIDTH: 172px; HEIGHT: 22px" readOnly exilDataType="exilUnsignedDecimal" ></td>
            <td ><span style="WIDTH: 199px; HEIGHT: 22px">&nbsp;</span></td>
            </tr></table>
</td></tr>
<tr ><td>&nbsp;</td></tr>
			<tr>
					<td>
						<table align=center width="100%" border="1" cellpadding="0" cellspacing="0" name="voucherDetailGrid" ID="voucherDetailGrid" >
							<tr class="rowheader">
							<td width="1%"  class="thStlyle">&nbsp;&nbsp;</td>
								<td width="8%"  class="thStlyle">Function Name</td>
								<td width="45%" class="thStlyle" height="20"><div align="center" >Account&nbsp;Code</div></td>
								<td width="36%" class="thStlyle" height="20"><div align="center" >Account&nbsp;Head</div></td>
								<td width="12%" class="thStlyle" style="DISPLAY:none"><div align="center">Dr Amount</div></td>
                                        <td width="15%" class="thStlyle"><div align="center">Cr Amount</div></td>
								<td width="15%" class="thStlyle" height="20" style="DISPLAY:none"><div align="center">Narration</div></td>
								<td width="5%" class="thStlyle" height="20"><div align="center" >Details</div></td>
							</tr>
							<tr  class=smallfieldcell>
							<td class="tdStlyle" width="1%"  onClick="changeColor(this,'voucherDetailGrid');" name="selectTd" id="selectTd"></td>

							<td>
							<input type="hidden" name="cv_fromFunctionCodeId" id="cv_fromFunctionCodeId">

				         <input class="normaltext" size=10 name="function_code" id="function_code"  style="WIDTH: 105px; HEIGHT:22px" value="" autocomplete="off"  onkeyup="autocompletecodeFunction(this);"  exilDescField="cv_fromFunctionCodeId" exilDataSource="" onBlur="fillNeibrAfterSplit(this,'cv_fromFunctionCodeId');funClear(this)" exilInGrid="true" size="20"><IMG   id=IMG1 onclick=openSearch1(this,'function')
                  height=22 src="/egi/resources/erp2/images/plus1.gif" width=25 align=top border=0 >
										</td>
										<td >
								<input class="fieldinput-right" id="voucherDetail_glCode" name="voucherDetail_glCode" style="WIDTH: 60px; HEIGHT: 22px" value="" autocomplete="off" onkeyup="autocompletecode(this)" exilDescField="voucherDetail_accountName" exilDataSource="" onBlur ="fillNeibrAfterSplit(this,'voucherDetail_accountName')" exilDataType ="exilAlphaNumeric"   exilInGrid="true" size="20"><IMG id=IMG1 onclick=openSearch(this) height=22 src="/egi/resources/erp2/images/plus1.gif" width=25 align=top border=0 >
							  </td>
								<td >
								<input class="labelcellforsingletd" size="" id="voucherDetail_accountName" name="voucherDetail_accountName"  style=" HEIGHT: 21; width:377" readonly exilDataType="exilAnyChar">
								</td>
								<td style="DISPLAY:none"><input class="fieldinput-right" NAME="voucherDetail_debitAmount" id="voucherDetail_debitAmount" onBlur="colTotal(this,'debitTotal')" maxlength="16" style="WIDTH: 139px; HEIGHT: 19px" size ="19" exilDataType="exilUnsignedDecimal" exilMax="9999999999999.99" exilMin="0">
								</td>
								<td>
								<input class="fieldinput-right" NAME="voucherDetail_creditAmount" id="voucherDetail_creditAmount" onBlur="colTotal(this,'creditTotal')" maxlength="16" style="WIDTH: 130px; HEIGHT: 22px" size ="19" exilDataType="exilUnsignedDecimal" exilMax="9999999999999.99" exilMin="0" onKeyDown="addNewRow('voucherDetailGrid','voucherDetail_glCode,voucherDetail_accountName')">
						         </td>
								<td style="DISPLAY:none" >
									<input class="fieldinput-right" size="96" id="voucherDetail_narration" name="voucherDetail_narration" MaxLength="250" style="WIDTH: 137px; HEIGHT: 22px"  exilDataType="exilAnyChar">
								</td>
								<td>
										<A  class=link id=A1 style="WIDTH: 50px; HEIGHT: 19px" onclick ="openDetails(this,'voucherDetail_glCode','miscReceipt','entities_grid','')"	 href="#" >Click</A>
								</td>

							</tr>


						</table><div id="codescontainer"></div>
					</td>
				</tr>
				<tr >
					<td>
					<table>
							<tr>

								<td colspan="2" align="center"><input type="button"  class="button" value="Delete Row" id="deleteDetail" name="deleteDetail" onclick=" deleteRowTable('voucherDetailGrid');colAllTotal('voucherDetail_debitAmount','voucherDetail_creditAmount','debitTotal','creditTotal');" /></td>
								<td colspan="2" align="center"><input type="button"  class="button" value="Add Row" id="addDetail" name="addDetail" onclick="addNewRowFromButton('voucherDetailGrid','voucherDetail_glCode','voucherDetail_accountName');" /></td>
							</tr>
					</table>
				  </td>
				</tr>
					<tr >
					<td id="auto-row" colspan="2">&nbsp;<td/>
					</tr>
					<tr><td>
					<table  align=center width="100%" border="1" cellpadding="0" cellspacing="0" id=TABLE1>
						<tr >
						<td><table>
							<tr>
							<td width=77%></td>
							<td><span class="fieldcellamount" id=SPAN1>Total&nbsp;</span>
							</td>
							<td style="display:none"><input class="fieldcellamount" size=16 id="debitTotal" name="debitTotal" exilDataType="exilUnsignedDecimal"                 style="WIDTH: 139px; HEIGHT: 19px" readOnly>
							</td>
							<td><INPUT class=fieldcellamount id=creditTotal style="WIDTH: 139px; HEIGHT: 22px" readOnly size=16 exilDataType="exilUnsignedDecimal"  name=creditTotal>
							</td>
							</tr>
               			 </table></td>
						</tr>
					</table>
					</td>
				</tr>

			<tr >
				<td height="25" colspan="4" valign="bottom" class="smalltext"><p class="smalltext"><span class="leadon">*</span>
						- Mandatory Fields</p>
				</td>
			</tr><!--  Buttons for Request Form starts here -->
			<tr  >
			<td colspan="4">
			<table border="0" cellpadding="0" cellspacing="0" align="center" id=TABLE1 >
					<TBODY>
					<tr  >
						<td  align="middle"><!-- Buttons Start Here -->
							<table border="0" cellpadding="0" cellspacing="0" id=TABLE1 >
								<tbody>
								<tr id="modGrid">
										<td align="center" width=100% colspan=4>
										<input   type="button" class="button" value="Reverse" onclick=reverse(); />
										</td>
								</tr>
								<tr id="backbutton" >
									<td width=100% align=center colspan=4>
									<input   type="button" class="button" value="Back" onclick="back(window.self)" />

									</td>
								</tr>
								<tr id="reverseRecord"  style="DISPLAY: none">
									<td align="right"><span   valign="center" class="labelcell"> Voucher Number<SPAN class=leadon>*</SPAN></span>
									</td>
									<td><span class=fieldcell><input  class=fieldcell name="voucherHeader_newVcNo" id="voucherHeader_newVcNo" maxlength="10"   exilDataType="exilAlphaNumeric" style="width:148; height:19"></span>
									</td>
									<td align="right">
										<span   valign="center" class="labelcell" >Voucher Date<span class="leadon">*</span>
									</td>
									<td><span class=smallfieldcell> <INPUT class="smallfieldcell" name="voucherHeader_effDate" exilDataType="exilAnyDate" id   ="voucherHeader_effDate" style="WIDTH: 120x; HEIGHT: 19px" size="13" onkeyup="DateFormat(this,this.value,event,false,'3')" exilCalendar="true"></span></span>
									</td>
									<td><INPUT	 type   =hidden class   ="datefieldinput" name="diffDebit" id="diffDebit" style="WIDTH: 101px; HEIGHT: 19px"	size="13"></SPAN>
									</td>
								</tr>
								<tr>
								  <td colspan=4></td>
								<tr></tr>
								</tbody>
							</table>
						</td>
					</tr></TBODY></table><!-- Buttons End Here -->
					</td>
					</tr>
						<table border="0" cellpadding="0" cellspacing="0" width="100%">
								 <tr>
								 </tr>
								 </table>
										 <!--table border="0" cellpadding="0" cellspacing="0"  align="center">
										 <tr id="submitGrid">
										<td align="right" id="saveandnewlb">
										<IMG height=18 src="/egi/resources/erp2/images/Button_leftside.gif" width=7></td>
										<td bgcolor="#fe0000" valign="center" nowrap id="saveandnewb"><A class=buttonprimary onclick="return ButtonPress('savenew');" href="#">Save &amp; New</A></td>
										<td id="saveandnewrb">
										<IMG height=18 src="/egi/resources/erp2/images/Button_rightside.gif" width=7></td>
										<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
										<td><IMG height=18 src="/egi/resources/erp2/images/Button_leftside.gif" width=7></td>
										<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary onclick="return ButtonPress('saveclose');" href="#">Save &amp; Close</A></td>
										<td>
										<IMG height=18 src="/egi/resources/erp2/images/Button_rightside.gif" width=7></td>
										<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
										<td align="right">
										<IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
										<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=onClickCancel() href="#">Cancel</A></td>
										<td>
										<IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
										<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
										<td align="right">
										<IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
										<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=window.close(); href="#">Close</A></td>
										<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
										<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
										<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
										<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=showglEntry(); href="#">Show GLEntry</A></td>
										<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
										 </tr></table -->
						<table border="0" cellpadding="0" cellspacing="0"  align="center">
							 <tr id="submitGrid">
							 <td>
							 <input  id="saveandnew" type="button" class="button" value="Save & New" onclick="return ButtonPress('savenew');"/>
							 <input   type="button" class="button" value="Save & Close" onclick="return ButtonPress('saveclose');" />
							 <input   type="button" class="button" value="Cancel" onclick="onClickCancel()" />
							 <input   type="button" class="button" value="Close" onclick=window.close(); />
							 <input   type="button" class="button" value="Show GlEntry" onclick=showglEntry(); />
							 </td>
						</tr></table>
					 <table align="center" border="0" cellpadding="0" cellspacing="0">
					 				<tr id="reverseSubmit">
					 						<td width=100% align=center>
						 						<input type="button"  id="revsave" value="Submit" class="button" onclick="return ButtonPress('saveclose');"/>
						 						<input type="button" id="revclose" value="Close" class="button" onclick="window.close();" />
					 						</td>
									</tr>
					</table>
					 <table width="100%" border=0 cellpadding="3" cellspacing="0" id="showEntries" name="showEntries" style="DISPLAY: none">
					 							<tr >
					 							<td colspan=4>
					 							<table width="100%" align=center border="0" cellpadding="0" cellspacing="0" >
					 							<tr  height="25">
					 							 <TD class=displaydata align=middle ><h4>GLEntry</h4></TD></tr>
					 							</table>
					 							</td>
					 							</tr>
					 							<tr><td>
					 							<table width="80%" border="1" cellpadding="0" cellspacing="0" align=center id="entries" name="entries">
					 							<tr class="rowheader">
					 							<td class="columnheader" ><div align="left" valign="center" class="thStlyle"> Code Type</div></td>
					 								<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Account Code</div></td>
					 								<td  class="columnheader"><div align="left" valign="center" class="thStlyle"> Account Head</div></td>
					 								<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Debit </div></td>
					 								<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Credit</div></td>
					 								<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Narration</div></td>
					 							</tr>
					 							<tr class="labelcell">
					 								<td ><div name="display_CodeType"  id="display_CodeType"   readOnly maxLength="10" tabIndex=0>&nbsp;</div></td>
					 								<td ><div name="display_Code"  id="display_Code"   readOnly maxLength="10" tabIndex=0>&nbsp;</div></td>
					 								<td ><div name="display_Head"  id="display_Head"  readOnly maxLength="10" tabIndex=0>&nbsp;</div></td>
					 								<td ><div name="display_Debit"  id="display_Debit"  readOnly maxLength="16" tabIndex=0>&nbsp;</div></td>
					 								<td ><div name="display_Credit"  id="display_Credit"  readOnly maxLength="16" tabIndex=0>&nbsp;</div></td>
					 								<td ><div name="display_Narration" id="display_Narration"  readOnly maxLength="10" tabIndex=0>&nbsp;</div></td>
					 							</tr>
					 							</table>
					 							</td>
					 							</tr>
						</table>

		<table id="entities_grid" width="20%" style="DISPLAY: none">
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td><input id="grid_detTypeId" name="grid_detTypeId" style="WIDTH: 100px" size="20"></td>
			<td><input id="grid_detKeyId" name="grid_detKeyId" style="WIDTH: 100px" size="20"></td>
			<td><input id="grid_detValue" name="grid_detValue" style="WIDTH: 100px" size="20" ></td>
			<td><input id="grid_rowIndex" name="grid_rowIndex" style="WIDTH: 100px" size="20"></td>
			<td><input id="grid_amount" name="grid_amount" style="WIDTH: 100px"></td>
			<td><input id="grid_detCode" name="grid_detCode" style="WIDTH: 100px"></td>
	     	<td><input id="grid_rowFunId" name="grid_rowFunId" style="WIDTH: 100px" size="20"></td>
		</tr>
	</table>
		</form>

<!-- We will set the "left" position value inside autocompletion method -->
		<div style="position: absolute; top:170px;width:118px;height:30px" id="menu-popup">
				    <table id="completeTable" bgcolor="#cae1ff" border="1"/>
		</div>
</body>
</html>
