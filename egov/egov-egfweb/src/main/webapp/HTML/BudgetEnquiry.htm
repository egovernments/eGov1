#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>

<script language="javascript">
var canGoToAdd=false;
var searchedOnce=false;
function beforeRefreshPage(dc){
	if(dc.values['serviceID']=='budgetEnquiry'){	
		var tableObj=document.getElementById('mainData');
		try{if(dc.grids['mainData'].length<=1){
				alert('no data found');
				canGoToAdd=false;
				tableObj.style.display='none';
			}else{
				tableObj.style.display='block';
				canGoToAdd=true;
			}
		}catch(e){}
	}
	
}
function getData(obj){
	
	var finObj=document.getElementById('budget_financialYearID');
	var fndObj=document.getElementById('fund_id');
	var deptObj=document.getElementById('department_id');
	var finYearID;
	if(finObj.selectedIndex!=-1){
		 finYearID=finObj.options[finObj.selectedIndex].value;
	}else if(obj.id!="fund_id" && obj.id!="department_id"){
		 finYearID="";
		 alert("select financialyear");
		 return;
	}else{
		return;
	}
	
	if(fndObj.selectedIndex==-1){
		 alert("select fund");
		 return;
	}
	if(deptObj.selectedIndex==-1){
		 alert("select department");
		 return;
	}
	searchedOnce=true;
	var fundID=fndObj.options[fndObj.selectedIndex].value;
	var deptID=deptObj.options[deptObj.selectedIndex].value;
	PageManager.DataService.setQueryField("fundID",fundID);
	PageManager.DataService.setQueryField("deptID",deptID);
	PageManager.DataService.setQueryField("finYearID",finYearID);
	PageManager.DataService.callDataService('budgetEnquiry');			 
}
function getDataOnLoad(){
	PageManager.DataService.callDataService('financialYearIDandName');		 
}

function submitData(obj){
	
	document.getElementById('egUser_id').value = CookieManager.getCookie('currentUserId');
	
	//   ***1 only FO***,  ***2 FO***,  ***Admin, 3 All***    //
	if(!isValidUser(2, CookieManager.getCookie('userRole')) ) return false;	
	
	var finObj=document.getElementById('budget_financialYearID');
	var fndObj=document.getElementById('fund_id');
	var deptObj=document.getElementById('department_id');
	var financialYearID=null;
	if(finObj.selectedIndex!=-1)
		 financialYearID=finObj.options[finObj.selectedIndex].value;
	else
		 financialYearID="";
	if(financialYearID!=null &&  financialYearID.length!=0 ){
		if(obj.innerHTML=='Set'){
			window.location="Budget.htm?pageMode=add&finYearID="+financialYearID+"&fundID="+fundID+"&deptID="+deptID;
		}else{
			if(fndObj.selectedIndex==-1){
				alert("select fund");
				return;
			}
			if(deptObj.selectedIndex==-1){
				alert("select department");
				return;
			}	 
			var fundID=fndObj.options[fndObj.selectedIndex].value;
			var deptID=deptObj.options[deptObj.selectedIndex].value;
			if(!canGoToAdd){
				if(searchedOnce)
					alert('No data to modify');
				else
					alert('Search For Data First');	
				return;
			}
			window.location="Budget.htm?pageMode=modify&finYearID="+financialYearID+"&fundID="+fundID+"&deptID="+deptID;
		}
	}else{
		alert("Select financialyear ");
	}
	
}
 
</script> 
</head>
<body bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0" marginheight="0" marginwidth="0" onLoad="getDataOnLoad()"><!------------------ Header Begins Begins--------------------->
<form name="BudgetEnquiry">
<input type="hidden" name="egUser_id" id="egUser_id"> 
	<table width="102%" border=0 cellpadding="3" cellspacing="0">				
		
		<tr>
			<td class="rowheader" colspan="4" width="896"><span class="headerwhite2">Budget - Enquiry</span></td>
		</tr>
		<tr class="row1">
			<td><div class="normaltext" align="right">Fund<span class="leadon">*</span></div></td>
			<td>
				<select id="fund_id" name="fund_id" class="fieldinput" 
					      exilMustEnter="true" exilListSource="fundName">
				</select>
			</td>
			<td><div class="normaltext" align="right">Function<span class="leadon">*</span></div></td>
			<td>
				<select id="department_id" name="department_id" class="fieldinput" 
					      exilMustEnter="true" exilListSource="departmentName">
				</select>
			</td>

		</tr>
		<tr class="row2">
			<td ><div class="normaltext" align="right">FinancialYear<span class="leadon">*</span></div></td>
			<td>
				<select id="budget_financialYearID" name="budget_financialYearID" class="fieldinput" 
					 exilMustEnter="true" exilListSource="budget_financialYearID">
				</select>
			</td>
			<td ></td>
			<td>
				<input type=button value="Search" onClick="getData(this)" id=button1 name=button1 style="COLOR: red">
			</td>
		</tr>
		
		<tr class="row1">
			<td ></td>
			<td>	</td>
			<td ></td>
			<td></td>
		</tr>
		
		<tr class="row2">
			<td height="25" colspan="4" valign="bottom" class="smalltext" width="896"><p class="smalltext"><span class="leadon">*</span>
			- Mandatory Fields</p>
			</td>
		</tr>

<tr class="row1">
	<td colspan=4>
				<table width="40%" name="mainData" id="mainData" align=center border=1>
					<tr class="rowheader">
						<td width="5%" height=34 class="columnheader"><div align="center" class="columnheader">Account Code</div></td>
                        <td width="15%" class="columnheader"><div align="center">Account Head</div></td>
	                    <td width="10%" class="columnheader"><div align="center">Original Amount</div></td>
	                    <td width="10%" class="columnheader"><div align="center">Revised Amount</div></td><!--<td width="10%" class="columnheader"><div align="center">Fund</div></td>
	                    <td width="10%" class="columnheader"><div align="center">Department</div></td>-->
					</tr>
					<tr>
						<td><div name="chartOfAccounts_code"  id="chartOfAccounts_code" ></div>
						</td>
                        <td>
							<div  id="chartOfAccounts_name" name="chartOfAccounts_name" exilTrimLength="29"
							 style="WIDTH: 177px; HEIGHT: 22px" ></div>
		                </td>
	                    <td>
							<div class="fieldinput-right" id="budget_Amount" name="budget_Amount"  style="WIDTH:
			                 75px; HEIGHT: 22px" size="24" ></div>
	                    </td>
	                    <td>
							<div class="fieldinput-right" id="budget_revisedAmount" name="budget_revisedAmount"  style="WIDTH:
							 75px; HEIGHT: 22px" ></div>
	                    </td><!--<td>
							<div class="fieldinput" id="fund_name" name="fund_name"  style="WIDTH:
							 75px; HEIGHT: 22px" ></div>
	                    </td>
	                    <td>
							<div class="fieldinput" id="department_name" name="department_name"  style="WIDTH:
							 75px; HEIGHT: 22px" ></div>
	                    </td>-->
					</tr>
				</table>
	</td>
	</tr>		
	

		<tr class="row2" width="100%">
			<td colspan="4" align="middle" width="896"><!-- Buttons Start Here -->
				<table border="0" cellpadding="0" cellspacing="0" align=center>
					<tr>
						<td align="right">
							<IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>											
						<td bgcolor="#ffffff" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=submitData(this) href="#">
							Revise</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
						<td align="right">&nbsp;</td>
						<td align="right">
							<IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>											
						<td bgcolor="#ffffff" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=submitData(this) href="#">
						 Set</A></td>
						<td>
						<IMG id=IMG1 height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6 ></td>
						<td align="right">&nbsp;
						</td>						
						<td align="right">
							<IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>											
						<td bgcolor="#ffffff" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary  href="Home.htm">
							Cancel</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
						<td align="right">&nbsp;</td>
					</tr>
				</table>
			</td>
		</tr>
		
	</table>
</form>
</body>
</html>
