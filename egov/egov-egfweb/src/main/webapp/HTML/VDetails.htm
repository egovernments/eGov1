#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<html>
<head>
<link rel=stylesheet href="../exility/global.css" type="text/css">
<SCRIPT LANGUAGE="javascript" SRC="../exility/PageValidator.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/PageManager.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/ExilityParameters.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../script/jsCommonMethods.js"></Script>
<SCRIPT LANGUAGE="javascript">

function afterRefreshPage(dc)
{
		addSlNo();
		return true;
}

function beforeRefreshPage(dc)
{
	var t=document.getElementById('gridC').innerHTML;
	var tabObj=dc.grids['voucherSearchGrid'];
		if(!tabObj)	return false;
		if(tabObj.length<2)	alert("No Data");
		if(t=='Voucher Date')
		{
	 	for(var i=1;i<tabObj.length;i++)
		tabObj[i][2]=formatDate(tabObj[i][2]);
		}
}

function addSlNo(){
	var slNo=1;
	var tabObj=document.getElementById("voucherSearchGrid");
	for(var i=1;i<tabObj.rows.length;i++){
		var obj=PageManager.DataService.getControlInBranch(tabObj.rows[i],"slNo");
		obj.innerHTML=slNo;
		slNo++;
	}

}

function onloadTasks()
{
	var glc=PageManager.DataService.getQueryField('glc');
	PageManager.DataService.setQueryField('glcode',glc);
	PageManager.DataService.callDataService('vDetails');
}
function getDetails(obj){
	var mode="view";
	var row=PageManager.DataService.getRow(obj);
	var table=document.getElementById('voucherSearchGrid');
	var cgn1=PageManager.DataService.getControlInBranch(table.rows[row.rowIndex],"colA");
	cgn1=cgn1.innerHTML;
	var cgn2=cgn1.substring(0,3);
	switch(cgn2){
	case 'JVG':
	window.open("JV_General.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'SJV' :
	window.open("SupplierJournal.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'CJV' :
	window.open("ContractorJournal.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'SAL' :
	window.open("JV_Salary.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'PYS':
	window.open("PayInSlip.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'BTB':
	window.open("JV_Contra_BToB.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'BTC':
	window.open("JV_Contra_BToC.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'CTB':
	window.open("JV_Contra_CToB.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'FTF':
	window.open("JV_Contra_FToF.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'DBP':
	window.open("DirectBankPayment.htm?cgNumber="+cgn1+"&showMode=viewBank","","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'DCP' :
	window.open("DirectCashPayment.htm?cgNumber="+cgn1+"&showMode=viewCash","","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'SPH':
	window.open("SubLedgerPayment.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'SSP' :
	window.open("SubledgerSalaryPayment.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'ASP' :
	window.open("AdvanceJournal.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'MSR':
	window.open("MiscReceipt.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'PRB' :
	case 'PRO' :
	case 'PRF' :
	window.open("PT_Field.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'OTF':
	window.open("OT_Field.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;
	case 'OTO':
	window.open("OT_Office.htm?cgNumber="+cgn1+"&showMode="+mode,"","height=650,width=900,scrollbars=yes,left=30,top=30,status=yes");
	break;

	}
}


</SCRIPT>
</head>
<body bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0" marginheight="0" marginwidth="0" onLoad="onloadTasks()" ><!------------------ Header Begins Begins--------------------->
<form name="voucherDetails">
<table width="100%" border="0" cellpadding="0" cellspacing="0" id=TABLE1>
<tr>
<td class="rowheader" valign="center" colspan="4"><span class="headerwhite2">Voucher Search</span></td>
</tr>
<tr class="row2"><td>&nbsp;</td></tr>
</table>
<table width="100%" border="1" align="center" cellpadding="0" cellspacing="0" name="voucherSearchGrid" id="voucherSearchGrid" >
<tr class="rowheader">
	<td width="5%" height="34" class="columnheader"><div align="center" class="columnheader">Sl No</div></td>
	<td width="10%" class="columnheader"><div align="center" id="gridA">CG Number</div></td>
	<td width="10%" class="columnheader"><div align="center" id="gridB">Voucher Number</div></td>
	<td width="15%" class="columnheader"><div align="center" id="gridC">Voucher Date</div></td>
	<td width="10%" class="columnheader"><div align="center" id="gridF">Amount</div></td>
</tr>
<tr class="normaltext">
	<td><div id="slNo" name="slNo" exilTrimLength="8">&nbsp;</div></td>
	<td><div id="colA" name="colA" exilTrimLength="10">&nbsp;</div></td>
	<td><A onClick="getDetails(this)" href="#"><div id="colB" name="colB" exilTrimLength="10">&nbsp;</div></A></td>
	<td><div id="colC" name="colC" exilTrimLength="15">&nbsp;</div></td>
	<td align=right><div id="colD" name="colD" exilTrimLength="10">&nbsp;</div></td>
</tr>
</table>
</form>
</body>
</html>
