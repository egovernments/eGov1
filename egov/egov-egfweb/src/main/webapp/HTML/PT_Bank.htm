#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<meta http-equiv="KEYWORDS" content="">
		<meta http-equiv="DESCRIPTION" content="">
		<!-- Inclusion of the CSS files that contains the styles -->
		<link rel="stylesheet" href="../exility/global.css" type="text/css">
			<SCRIPT LANGUAGE="javascript" SRC="../exility/datefunctions.js"></SCRIPT>
			<script src="../exility/PageManager.js"></script>
			<script src="../exility/PageValidator.js"></script>
			<script src="../script/jsCommonMethods.js"></script>
			<script src="../script/predefinedAccCodes.js"></script>
			<script src="../exility/ExilityParameters.js"></script>
		<script>
		var noOfCess=0;
		var inSelect=0;
		
		 function reArrangeCalcTable()
		 {
		 		window.gridReArranged=true;
		 		var taxtab=document.getElementById('calcTable');
				for(var i=1;i<taxtab.rows.length;i++)
				{
					var ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'recordType');
					if(ctrl.innerHTML.toLowerCase()=='p')
					{
						addAccHeads(i);
						i+=2;
					}
				}
				addCodes();
				addTotalRow(0);				
		 }

 function addAccHeads(index)
		 {
			var taxtab=document.getElementById('calcTable');
			var tBody=taxtab.tBodies[0];
			var newRow=taxtab.rows[1].cloneNode(true);
			tBody.appendChild(newRow);
			clearAll(newRow);
			var ctl=PageManager.DataService.getControlInBranch(newRow,"accDesc");
			ctl.innerHTML="Interest";
			ctl=PageManager.DataService.getControlInBranch(newRow,"recordType");
			ctl.innerHTML="I";
			taxtab.moveRow(taxtab.rows.length-1,index+1);			
			
			 
			
			newRow=taxtab.rows[1].cloneNode(true);
			tBody.appendChild(newRow);
			clearAll(newRow);
			ctl=PageManager.DataService.getControlInBranch(newRow,"accDesc");
			ctl.innerHTML="Rebate";
			ctl=PageManager.DataService.getControlInBranch(newRow,"recordType");
			ctl.innerHTML="Rb";
			taxtab.moveRow(taxtab.rows.length-1,index+2); 
			if(index>1)
			{
				addTotalRow(index);
			}
		 }
		   function calcSubTaxes()
		  {
				
				var maintab=document.getElementById('voucherDetailsGrid');
				var taxtab=document.getElementById('calcTable');
				var year,inYear,percent,tempYear;
				var actAmt=0,prpCess=0,enteredAmt=0;
				var prTaxPos=0;
				var interest,penalty,rebate;
				for(var i=1;i<maintab.rows.length;i++)
				{
					var totalPercent=getTotalPercent(i);
					if(totalPercent==-1)continue;			
					 year=PageManager.DataService.getControlInBranch(maintab.rows[i].cells[0],'period').value;
					 //entered amount =totalAmount- (interest+penalty)
					 interest=parseFloat(PageManager.DataService.getControlInBranch(maintab.rows[i].cells[2],'interest').value);
					 penalty= parseFloat(PageManager.DataService.getControlInBranch(maintab.rows[i].cells[3],'penalty').value);
					 rebate= parseFloat(PageManager.DataService.getControlInBranch(maintab.rows[i].cells[4],'rebate').value);
					 tmtAmt=parseFloat(PageManager.DataService.getControlInBranch(maintab.rows[i].cells[1],'totalAmount').value);
					 if(isNaN(tmtAmt))tmtAmt=0;
					 if(isNaN(interest))interest=0;
					 if(isNaN(penalty))penalty=0;
					 if(isNaN(rebate))rebate=0;
					 enteredAmt=(tmtAmt+rebate)-(interest+penalty);
					 //formula used  --   actAmnt=entered amount * 100/(100+totalpercent)
					 actAmt=(enteredAmt*100)/(100+totalPercent);	

					 if(isNaN(enteredAmt)||enteredAmt<=0)
					 {
						 	actAmt=0; 
						 	enteredAmt=0;
					 }
					 
					 /*---------*/
					 	rInterest=interest.toFixed(2);
						rPenalty= penalty.toFixed(2);
					    rRebate=rebate.toFixed(2);
					    rTotAmt=tmtAmt.toFixed(2);
						rEnteredAmt=enteredAmt.toFixed(2);
						rActAmt=actAmt.toFixed(2);
					 /*----------*/

					 for(var j=1;j<taxtab.rows.length;j++)
					 {
						tempYear=PageManager.DataService.getControlInBranch(taxtab.rows[j].cells[0],'periodC').innerHTML;
						if(tempYear.length>=2)
						 	inYear=tempYear;
						if(inYear==year)
						{
							if(prTaxPos==0)prTaxPos=j;//when ever pt is calculated for new year that lilne has index for pt amount
							percent=rActAmt*(parseFloat(PageManager.DataService.getControlInBranch(taxtab.rows[j].cells[3],'percentC').innerHTML)/100);
							if(!isNaN(percent))
							{
								percent=percent.toFixed(2);
								prpCess+=parseFloat(percent);
								taxtab.rows[j].cells[4].childNodes[0].innerHTML=percent.toString();
							}
						}					 
					 }
					 //pt is calculated from entered amount - total cess as actAmnt might give paise differences
				 	 
					 if(!isNaN(parseFloat(rEnteredAmt)-prpCess))
					 {
					 	var rPropertyTax=(parseFloat(rEnteredAmt)-prpCess).toFixed(2);
					 	/*var rInterest=interest.toFixed(2);
					 	var rPenalty=penalty.toFixed(2);
					 	var rRebate=rebate.toFixed(2);*/
					 	var rTotalAmt=((parseFloat(rPropertyTax)+prpCess+parseFloat(rInterest)+parseFloat(rPenalty))-parseFloat(rRebate)).toFixed(2);
						var creditAmount=parseFloat(rPropertyTax)+parseFloat(rInterest)+parseFloat(rPenalty)+parseFloat(prpCess);
						var debitAmount=parseFloat(rTotAmt)+parseFloat(rRebate);
						var orgPT=0;
						if(creditAmount!=debitAmount){
							if((creditAmount-debitAmount)<1 &&  (creditAmount-debitAmount)>0){
								orgPT=parseFloat(rPropertyTax)-(creditAmount-debitAmount);
								 							
							}else if((debitAmount-creditAmount)<1 &&  (debitAmount-creditAmount)>0){
								orgPT=parseFloat(rPropertyTax)+(debitAmount-creditAmount);
								 							
							}
							rPropertyTax=orgPT.toFixed(2);
							alert(rPropertyTax+"afytr");
						}
						 taxtab.rows[prTaxPos].cells[4].childNodes[0].innerHTML=rPropertyTax;
						 taxtab.rows[prTaxPos+1].cells[4].childNodes[0].innerHTML=(parseFloat(rInterest)+parseFloat(rPenalty)).toString();
						 var formattedRebate;
						 if(rebate>0) formattedRebate="-"+rRebate.toString();
						 else formattedRebate=rRebate.toString();
						 taxtab.rows[prTaxPos+2].cells[4].childNodes[0].innerHTML=formattedRebate;
						 taxtab.rows[prTaxPos+noOfCess+3].cells[4].childNodes[0].innerHTML=rTotalAmt.toString();
						 
					 }
					 prTaxPos=0;//reset position of property tax  amount field
					 prpCess=0;
			  }					 
			}
		 
		 
		 
		function addCodes()
		 {
				var k=0;
				var taxtab=document.getElementById('calcTable');
				for(var i=1;i<taxtab.rows.length;i++)
				{
					var ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'recordType');
					switch(ctrl.innerHTML.toLowerCase())
					{
						case "p" :var ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'accCode');
									  ctrl.innerHTML=g_propertyTaxCodes[k];
									  ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'accDesc');
									  ctrl.innerHTML=g_propertyTaxNames[k];
									  break;
						case "i" :var ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'accCode');
									  ctrl.innerHTML=g_interestCode;
									  ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'accDesc');
									  ctrl.innerHTML=g_interestName;
									  break;	
						case "pt":var ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'accCode');
									  ctrl.innerHTML=g_penaltyCode;
									  ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'accDesc');
									  ctrl.innerHTML=g_penaltyName;
									  k++;
									  break;
						case "rb":var ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'accCode');
									  ctrl.innerHTML=g_rebateCode;
									  ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'accDesc');
									  ctrl.innerHTML=g_rebateName;
									  break;
					   case  "c":var ctrl=PageManager.DataService.getControlInBranch(taxtab.rows[i],'periodC');				  
								 ctrl.innerHTML="";
								 break;
					}
					
				}
		 }
		 function clearAll(newRow)
		 {
			ctl=PageManager.DataService.getControlInBranch(newRow,"periodC");
			ctl.innerHTML="";
			ctl=PageManager.DataService.getControlInBranch(newRow,"accCode");
			ctl.innerHTML="";
			ctl=PageManager.DataService.getControlInBranch(newRow,"accDesc");
			ctl.innerHTML="";
			ctl=PageManager.DataService.getControlInBranch(newRow,"percentC");
			ctl.innerHTML="";
			ctl=PageManager.DataService.getControlInBranch(newRow,"fAmount");
			ctl.innerHTML="";
			ctl=PageManager.DataService.getControlInBranch(newRow,"recordType");
			ctl.innerHTML="";
		 }
		
		 function addTotalRow(index)
		 {
				var taxtab=document.getElementById('calcTable');
				var newRow=taxtab.rows[1].cloneNode(true);
				var tBody=taxtab.tBodies[0];
				tBody.appendChild(newRow);
				clearAll(newRow);
				var ctl=PageManager.DataService.getControlInBranch(newRow,"accDesc");
				ctl.innerHTML="Total";
				ctl=PageManager.DataService.getControlInBranch(newRow,"recordType");
				ctl.innerHTML="T";
				if(index>0)
					taxtab.moveRow(taxtab.rows.length-1,index);			
		}	
		  
		 function calculateTotal()
		 {
		 	var table=document.getElementById("voucherDetailsGrid");
			var totalAmountCell;
			var tAmountObj,tInterestObj,tPenaltyObj,tRebateObj;
			var tAmount=0,tInterest=0,tPenalty=0,tRebate=0,temp;
			tAmountObj=document.getElementsByName('totalAmount');
			tInterestObj=document.getElementsByName('interest');
			tPenaltyObj=document.getElementsByName('penalty');
			tRebateObj=document.getElementsByName('rebate');
			for(var i=0;i<tAmountObj.length;i++)
			{	
				temp=parseFloat(tAmountObj[i].value);
				if(!isNaN(temp)) tAmount+=temp;
				temp=parseFloat(tInterestObj[i].value);
				if(!isNaN(temp)) tInterest+=temp;
				temp=parseFloat(tPenaltyObj[i].value)
				if(!isNaN(temp))tPenalty+=temp;
				temp=parseFloat(tRebateObj[i].value);
				if(!isNaN(temp))	tRebate+=temp;
			}
			tAmountObj=document.getElementById('totalAmountF');
			if(!isNaN(tAmount)) tAmountObj.value=tAmount;
			tInterestObj=document.getElementById('interestF');
			if(!isNaN(tInterest)) tInterestObj.value=tInterest;			
			tPenaltyObj=document.getElementById('penaltyF');
			if(!isNaN(tPenalty)) tPenaltyObj.value=tPenalty;
			tRebateObj=document.getElementById('rebateF');
			if(!isNaN(tRebate)) tRebateObj.value=tRebate;
			//calcSubTaxes(PageManager.DataService.getRow(obj).rowIndex);
		 }
		 function hidePercentageColumn()
		 {
		 	var tblObj = document.getElementById('calcTable');
		    var rows = tblObj.rows;
		    for(i=0;i<rows.length;i++)
			{
				var cols = rows[i].cells;
				cols[3].style.display='none';
				cols[5].style.display='none';
        	}
		 }
		
		 function showSplitUp(){
			 var tableObj=document.getElementById("calcTable");
			 tableObj.style.display="block";
			 calcSubTaxes();
			 var textObj=document.getElementById("splitText");
			 textObj.innerHTML="Refresh Splitup"
		 }
		function isRecordsFilled(){
		 	    var totalObj=document.getElementById("totalAmountF");
		 	     if(isNaN(totalObj.value)||totalObj.value<=0){
						alert("No Data to Post");
						return false;
	 			 }
				return true;
		 }
		
		//This page is expecting branchId,accNo,regionId from other pages if any
		function clearCombo(cId)
		 {
			var bCtrl=document.getElementById(cId);
			for(var i=bCtrl.options.length-1;i>=0;i--)
			{
				bCtrl.remove(i);
			}
		 }
		 function checkTotalAmount()
		 {
		 	    var table=document.getElementById("voucherDetailsGrid");
			    for(var i=1;i<table.rows.length;i++)
			    {
					var tObj=PageManager.DataService.getControlInBranch(table.rows[i],"totalAmount");
					var totalAmount=parseFloat(tObj.value);
					var interest=parseFloat(PageManager.DataService.getControlInBranch(table.rows[i],"interest").value);
					var penalty=parseFloat(PageManager.DataService.getControlInBranch(table.rows[i],"penalty").value);
					var rebate=parseFloat(PageManager.DataService.getControlInBranch(table.rows[i],"rebate").value);					
					if(isNaN(totalAmount))totalAmount=0;
					if(isNaN(interest))interest=0;
					if(isNaN(penalty))penalty=0;
					if(isNaN(rebate))rebate=0;
					var iandp=interest+penalty;
					if(totalAmount<iandp)
					{
						alert("Total Amount Cannot be Less Than Sum of Interest & Penalty In Record "+i);
						tObj.focus();
						return 0;
					}
					if(totalAmount<rebate){
						alert("Total Amount Cannot be Less Than rebate in Record "+i);
						tObj.focus();
						return 0;
					}
			    }
				return 1;
		 }
		 function fillBankDetails()
		 {	
			window.hasQueryString=false;
			var brId=PageManager.DataService.getQueryField("branchId");
			selectBank(brId);
			window.branchChange=true;
			bankChange(brId);
			
		 }
		 function selectBank(brId)
		 {
			var bankObj=document.getElementById("bank_id");
			for(var i=0;i<bankObj.length;i++)
			{
				var text=bankObj.options[i].value;
				var index=text.indexOf("-");
				var internalBrId=text.substring(index+1,text.length);
				if(parseInt(internalBrId)==parseInt(brId))
				{
					bankObj.options[i].setAttribute("selected",true);
					break;
				}
			}
		 }
		 function selectAccNo()
		 {
			try{
				var accNo=PageManager.DataService.getQueryField("accNo");
				var accObj=document.getElementById("bankAccount_accountNumber");
				for(var i=0;i<accObj.length;i++)
				{
					if(accObj.options[i].value.toLowerCase()==accNo.toLowerCase())
					{
						accObj.options[i].setAttribute("selected",true);
						break;
					}
				}
				
			}catch(e){}	
		 }
		 function setDefaults()
		 {
			var obj=document.getElementById('department_name');
			obj.value=g_departmentName;
			obj=document.getElementById('fund_name');
			obj.value=g_fundName;
		 }
		 function afterRefreshPage(dc)
		 {
		 
				calculateTotal();	
				var voucherHeader_voucherDate=dc.values['voucherHeader_voucherDate'];				
				if(voucherHeader_voucherDate){				
				voucherDate=formatDate(voucherHeader_voucherDate);						
				document.getElementById('voucherHeader_voucherDate').value=voucherDate;		
				}
				var chequeDetail_chequeDate=dc.values['chequeDetail_chequeDate'];
				if(chequeDetail_chequeDate){
				chequeDetail_chequeDate=formatDate(chequeDetail_chequeDate);			
				document.getElementById('chequeDetail_chequeDate').value=chequeDetail_chequeDate;		
				}			
				var vNum=dc.values['voucherHeader_voucherNumber'];	
				if(vNum){			
				var a=vNum.split("-");
				document.getElementById ('voucherHeader_voucherNumber').value=a[0];				
				}
				var bId=dc.values['bank_id'];
				if(bId){					
				var index=bId.indexOf("-");
				brId=bId.substring(index+1,bId.length);
				var accObj=document.getElementById('bankAccount_accountNumber');
				accObj.setAttribute("exilListSource","bankAccount_accountNumber");
				PageManager.DataService.setQueryField('bankAccount_branchId',brId);
				PageManager.DataService.setQueryField("accType1","Banks Account-Nationalised Banks-Collection");
				PageManager.DataService.setQueryField("accType2","Bank Account - Nationalised Banks - General");
		 		PageManager.DataService.callDataService('accountNumber');
				}

				if(!window.gridReArranged)
					reArrangeCalcTable();	
				if(window.hasQueryString)
				{
					if(PageManager.DataService.getQueryField("branchId")!=null)
					 fillBankDetails();
				} 
				else if(window.branchChange)	
				{	
					window.branchChange	=false;
					selectAccNo();
				}
				
				return true;
		 }
		 function beforeRefreshPage(dc)
		 {
			var tab=dc.grids['voucherDetailsGrid'];
			if(tab){
			for(var i=1;i<tab.length;i++){			
				tab[i][0]=tab[i][0]==-1?'':tab[i][0];
				tab[i][1]=tab[i][1]==-1?'':tab[i][1];
				tab[i][2]=tab[i][2]==-1?'':tab[i][2];
				tab[i][3]=tab[i][3]==-1?'':tab[i][3];
				tab[i][4]=tab[i][4]==-1?'':tab[i][4];
			  }
			 } 	

			if(isNaN(parseInt(dc.values['voucherHeader_cgn']))) return;
			dc.values['voucherHeader_cgn']='PRB'+dc.values['voucherHeader_cgn'];
		 }
		 function afterUpdateService(dc)
		 {
			window.location="PT_Bank.htm";
		 }
		 function bankChange(brId) 
		 {
			//select accountnumber from bankaccount where branchid=id
			if(brId==null)
			{
				var bCtrl=document.getElementById('bank_id');
				if(bCtrl.selectedIndex==-1)return;
				var text=bCtrl.options[bCtrl.selectedIndex].value;
				var index=text.indexOf("-");
				brId=text.substring(index+1,text.length);
			}
			clearCombo("bankAccount_accountNumber");
			var accObj=document.getElementById('bankAccount_accountNumber');
			accObj.setAttribute("exilListSource","bankAccount_accountNumber");
			PageManager.DataService.setQueryField('bankAccount_branchId',brId);
			PageManager.DataService.setQueryField("accType1","Banks Account-Nationalised Banks-Collection");
			PageManager.DataService.setQueryField("accType2","Bank Account - Nationalised Banks - General");
		 	PageManager.DataService.callDataService('accountNumber');
		 }
		 
		 function insertDate()
		 {
			insertDates('voucherHeader_voucherDate');
		 }
		
		 function ButtonPress(name)
		 {
		   if(name.toLowerCase()=='submit')
		   {
		 	   if(PageValidator.validateForm())
		 	   {
		 		 if(checkTotalAmount()==0)return;
		 		 if(checkNarration('voucherDetail_narration')==0)return;
		 		 if(!isRecordsFilled())return;
		 	   	 PageManager.UpdateService.submitForm('propertyTaxBank');
		 	   }
		   }
		 }
		 function onloadTasks()
		 {
			PageManager.DataService.setQueryField("filter","Nationalised Banks");
			//PageManager.DataService.setQueryField("filter1","Collection Banks");
			PageManager.DataService.setQueryField("conditionForBank","1");
			PageManager.ListService.callListService();		 
			var cgn=PageManager.DataService.getQueryField('cgNumber');
		 	 if(cgn){		 	 
		 		//PageManager.DataService.callDataService('getPTFList');	 	 				
				PageManager.DataService.setQueryField('cgNumber',cgn);
				PageManager.DataService.setQueryField('billCollector_type','BillCollector');
 		 		PageManager.ListService.callListService();
				PageManager.DataService.callDataService('getPTBDetails');											
				hideButtons();	
				disableControls(0,true);										
		 	 }else{

					var vcNo=document.getElementById("voucherHeader_voucherNumber");
					vcNo.focus();
					window.gridReArranged=false; 
					window.hasQueryString=false; 
					if(window.location.search.indexOf("?")>=0)
						window.hasQueryString=true; 
					insertDate();
					hidePercentageColumn();
					setDefaults();
					PageManager.DataService.callDataService('ReceiptPropertyTaxData');
					obj=document.getElementById('modGrid').style.display="none";
			}
		 }
		 
		  function getTotalPercent(index)
		 {
			var totalCombo=document.getElementById('inTotalCess');
			var countCombo=document.getElementById('inNoOfCess');
			var mainTable=document.getElementById('voucherDetailsGrid');
			var pObj=PageManager.DataService.getControlInBranch(mainTable.rows[index],"period");
			var totalPercent=-1;
			for(var i=0;i<totalCombo.options.length;i++)
			{
				if(totalCombo.options[i].value.toLowerCase()==pObj.value.toLowerCase())
					{
						totalPercent=parseInt(totalCombo.options[i].text);
						noOfCess=parseInt(countCombo.options[i].text);
						break;
					}
			}
		 	return totalPercent;
		 }
		function disableControls(frmIndex, isDisable){		
			for(var i=0;i<document.forms[frmIndex].length;i++)			
				document.forms[frmIndex].elements[i].disabled =isDisable;														
		}
		function modify(){
			var cgn=PageManager.DataService.getQueryField('cgNumber');
		 		if(cgn){
		 			vGrid=document.getElementById('voucherDetailsGrid').cloneNode(true);
		 			new_vGrid=document.body.appendChild(vGrid);
		 			new_vGrid.name= 'voucherDetailsGridNew';
		 			new_vGrid.disabled=false;
		 			
		 			tGrid=document.getElementById('totalsGrid').cloneNode(true);
		 			new_tGrid=document.body.appendChild(tGrid);
		 			new_tGrid.name= 'voucherDetailGridNew';
		 			new_tGrid.disabled=true;
		 			
		 			disableControls(0,false);
		 			document.getElementById('modGrid').style.display='none';
		 			document.getElementById('submitGrid').style.display='block';	 			 				 			
		 			//document.getElementById ('text1').style.display ='block';
		 	 	}
		}
		function hideButtons(){
			document.getElementById('modGrid').style.display='none';			
			document.getElementById('submitGrid').style.display ="none";
			//document.getElementById ('text1').style.display ="none";
		}
			
		
		
		
	 </script>

	</head>
	<body bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0"
		 marginheight="0" marginwidth="0" onLoad="onloadTasks();PageValidator.addCalendars();"><!------------------ Header Begins Begins--------------------->
		<form name="journalVoucher">
		
			<table width="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td valign="top" class="normaltext"><!------------Content begins here ------------------>
						<table width="100%" border="0" cellpadding="3" cellspacing="0">
							<TBODY>
								<tr>
									<td class="rowheader" valign="center" colspan="4"><span class="headerwhite2"> Property Tax - Bank</span></td>
								</tr>
								<tr class="row1">
									<td ><div align="right" valign="center" class="normaltext"> CG&nbsp;Number</div>
									</td>
									<td >
									<input name="voucherHeader_cgn" class="fieldinput" id="voucherHeader_cgn" readOnly maxLength=10>
									</td>
									<td ><div align="right" valign="center" class="normaltext">Voucher Number<span class="leadon">*</span></div>
									</td>
									<td >
                                    <INPUT class=fieldinput 
            id="voucherHeader_voucherNumber" name="voucherHeader_voucherNumber" maxLength="10" exilDataType="exilAnyChar" exilMustEnter="true">
										</td>
					</td>
				</tr>
				<tr class="row2">
					<td ><div align="right" valign="center" class="normaltext">Ward<span class="leadon">*</span></div>
					</td>
					<td >
					<SELECT id="organizationStructure_id"   
						name="organizationStructure_id" class="fieldinput" exilMustEnter="true" exilListSource="wardOnRegion">
					</SELECT>
          
					</td>
					<td ><div align="right" valign="center" class="normaltext">Voucher Date<span class="leadon">*</span></div>					</td>
					<td ><INPUT 
            class=datefieldinput id="voucherHeader_voucherDate"  
            name="voucherHeader_voucherDate" exilDataType="exilAnyDate" exilMustEnter="true" exilCalendar="true">
					</td>
				</tr>
				<tr class="row1">
					<td ><div align="right" valign="center" class="normaltext"> Bank
							<span class="leadon">*</span></div>
					</td>
					<td ><SELECT id="bank_id"   
            class="fieldinput"  name="bank_id" onChange="bankChange(null)" exilMustEnter="true" exilListSource="bankAndBranch"></SELECT>&nbsp;
					</td>
					<td ><div align="right" valign="center" class="normaltext">
                      Account Number<SPAN 
            class=leadon>*</SPAN>
                       </div>
					</td>
					<td >
						<SELECT id="bankAccount_accountNumber"   
            class="fieldinput"       
            name="bankAccount_accountNumber" exilMustEnter="true" >
                        </SELECT></td>
				</tr>
				
				<tr class="row2">
					<td ><div align="right" valign="center" class="normaltext">Fund Name</div>
					</td>
					<td >
						<input name="fund_name" class="fieldinput" id="fund_name" disabled maxLength="50" exilDataType="exilAnyChar">&nbsp; 
          
					</td>
					<td ><div align="right" valign="center" class="normaltext">
            <div class=normaltext align=right 
            valign="center">Function</DIV>  </div>
					</td>
					<td >
						<input name="department_name" class="fieldinput" id="department_name" disabled maxLength="50" exilDataType="exilAnyChar">
					</td>
				</tr>
				<tr class="row1">
					<td ><div align="right" valign="center" class="normaltext">Narration</div>
					</td>
					<td ><TEXTAREA class=narrationfieldinput id=voucherDetail_narration name=voucherDetail_narration exilDataType="exilAnyChar"></TEXTAREA>&nbsp;
					</td>
					<td ><div align="right" valign="center" class="normaltext">&nbsp;</div>
					</td>
					<td >&nbsp;
					</td>
				</tr>
				<tr class="row2">
					<td >&nbsp;
					</td>
					<td class="fieldinput"><A 
            onmouseover="window.status  ='Date Picker';return true;" 
            onmouseout="window.status='';return true;" 
            href="javascript:show_calendar('journalVoucher.voucherDate','MM/DD/YY','2001', '2');"></A></td>
					<td align="right" valign="center" class="normaltext"><div align="right"> &nbsp;</div>
					</td>
					<td class="fieldinput">&nbsp; 
          
					</td>
				</tr>
				<tr class="row1">
					<td align="right" valign="center" class="normaltext"><div align="right">&nbsp;</div>
					</td>
					<td class="fieldinput">&nbsp;
					</td>
					<td align="right" valign="center" class="normaltext">&nbsp;
						<DIV></DIV>
					</td>
					<td class="fieldinput">&nbsp;
						
					</td>
				</tr>
			</table>
			
			<table width="100%" border="0" cellpadding="0" cellspacing="0" ID="Table1">
				<tr>
					<td>
							<table width="40%" border="1" cellpadding="0" cellspacing="0" ID="voucherDetailsGrid">
							<tr class="rowheader">
								<td width="8%" class="columnheader"><div align="center">Period</div></td>
								<td width="8%" class="columnheader"><div align="center">Total Amount</div></td>
								<td width="8%" class="columnheader"><div align="center">Interest</div></td>
								<td width="8%" class="columnheader"><div align="center">Penalty</div></td>
								<td width="8%" class="columnheader"><div align="center">Rebate</div></td>
								
							</tr>
							
							
							<tr class="normaltext">
							
							<td class="columnheader" width="8%">
							<input        
                  name="financialyear_id" 
                  id="financialyear_id" style="WIDTH: 136px; HEIGHT: 22px" 
                  type=hidden size=17>
				<input     
                  readOnly align="left"
                  name="period" id="period" style="WIDTH: 137px;   HEIGHT: 22px" size  ="15" exilDataType="exilAnyChar" 
                  exilTrimLength="15">
						  </td>
								<td class="columnheader" width="8%"><input class="fieldinput-right"  size="22" ID="totalAmount" NAME="totalAmount" 
									onkeyup="calculateTotal()"	  
                  style   ="WIDTH:   148px; HEIGHT: 
                  19px" maxLength="9" exilDataType="exilUnsignedDecimal" exilMin="0" 
                  exilMax="999999.99"></td>
								<td class="columnheader" width="8%"><INPUT 
                  class=fieldinput-right id="interest"   style="WIDTH:
                  148px; HEIGHT: 19px" size =22 
                  name="interest" onkeyup="calculateTotal()"
                     
                  maxLength="9" exilDataType="exilUnsignedDecimal" exilMin="0" 
                  exilMax="999999.99"></td>
								<td class="columnheader" width="8%"><INPUT 
                  class=fieldinput-right id="penalty"  style="WIDTH:
                  148px; HEIGHT: 19px" size =22 onkeyup="calculateTotal()"
				    
                  name="penalty" 
                  maxLength="9" exilDataType="exilUnsignedDecimal" exilMin="0" 
                  exilMax="999999.99"></td>
								<td class="columnheader" width="8%"><INPUT 
                  class=fieldinput-right id="rebate"   style="WIDTH:
                  148px; HEIGHT: 19px" size =22 onkeyup="calculateTotal()"
                    
                  name="rebate" 
                  maxLength="9" exilDataType="exilUnsignedDecimal" exilMin="0" 
                  exilMax="999999.99"></td>
								
							</tr>
								<tr class="normaltext">
							
							<td class="columnheader" width="8%">
							<input        
                  name="financialyear_id" 
                  id="financialyear_id" style="WIDTH: 136px; HEIGHT: 22px" 
                  type=hidden size=17>
				<input     
                  readOnly align="left"
                  name="period" id="period" style="WIDTH: 137px;   HEIGHT: 22px" size  ="15" exilDataType="exilAnyChar" 
                  exilTrimLength="15">
						  </td>
								<td class="columnheader" width="8%"><input class="fieldinput-right"  size="22" ID="totalAmount" NAME="totalAmount" 
								   onkeyup="calculateTotal()"   
                  style   ="WIDTH:   148px; HEIGHT: 
                  19px" maxLength="9" exilDataType="exilUnsignedDecimal" exilMin="0" 
                  exilMax="999999.99"></td>
								<td class="columnheader" width="8%"><INPUT 
                  class=fieldinput-right id="interest"  style="WIDTH:
                  148px; HEIGHT: 19px" size =22 onkeyup="calculateTotal()"
                   
                  name="interest" maxLength="9" exilDataType="exilUnsignedDecimal" 
                  exilMin="0" 
                  exilMax="999999.99"></td>
								<td class="columnheader" width="8%"><INPUT 
                  class=fieldinput-right id="penalty"   style="WIDTH:
                  148px; HEIGHT: 19px" size =22 onkeyup="calculateTotal()"
				    
                  name="penalty" 
                  maxLength="9" exilDataType="exilUnsignedDecimal" exilMin="0" 
                  exilMax="999999.99"></td>
								<td class="columnheader" width="8%"><INPUT 
                  class=fieldinput-right id="rebate"   style="WIDTH:
                  148px; HEIGHT: 19px" size =22 onkeyup="calculateTotal()"
                    
                  name="rebate" 
                  maxLength="9" exilDataType="exilUnsignedDecimal" exilMin="0" 
                  exilMax="999999.99"></td>
								
							</tr>
						</table>
														
	
					</td>
				</tr>
				
				<tr>
				<td>
				<table border="1" width="40%" id="totalsGrid" name="totalsGrid">
				 <tr class="row1">
					<td width="8%" class="normaltext" align="right">
					<INPUT 
                  class=fieldinput-right  
                  style="BORDER-RIGHT: thin; BORDER-TOP: thin; BORDER-LEFT: thin; WIDTH: 131px; HEIGHT: 19px" 
                  size =12 value="Total" readOnly id=text1 name=text1>
					</td>
					<td  width="8%" class="columnheader">
                    <INPUT 
                  class=fieldinput-right id=totalAmountF 
                  style="BORDER-RIGHT: thin; BORDER-TOP: thin; BORDER-LEFT: thin; WIDTH: 146px; HEIGHT: 19px" 
                  disabled name=totalAmountF ></td>
								<td width="8%" class="columnheader"><INPUT 
                  class=fieldinput-right id=interestF 
                  style="BORDER-RIGHT: thin; BORDER-TOP: thin; BORDER-LEFT: thin; WIDTH: 144px; HEIGHT: 19px" 
                  disabled size=21 name=interestF></td>
								<td class="columnheader" width="8%"><INPUT 
                  class=fieldinput-right id=penaltyF 
                  style="BORDER-RIGHT: thin; BORDER-TOP: thin; BORDER-LEFT: thin; WIDTH: 144px; HEIGHT: 19px" 
                  disabled size=21 name=penaltyF></td>
								<td class="columnheader" width="8%"><INPUT 
                  class=fieldinput-right id=rebateF 
                  style="BORDER-RIGHT: thin; BORDER-TOP: thin; BORDER-LEFT: thin; WIDTH: 142px; HEIGHT: 19px" 
                  disabled size=19 
        name=rebateF></td>
                 
							</tr>
				</table>

				</td>
				</tr>
				
				<tr class="row2" height=10>
					<td colspan="4" align="middle"></td>
				
				<tr class="row2">
				<td colspan="4" align="middle"><!-- Buttons Start Here -->
					 
					 <table border="0" cellpadding="0" cellspacing="0">
					<tr id="modGrid">
							<td align="right">
                            <IMG height=18 src="/egi/resources/erp2/images/Button_leftside.gif" width=6></td>
							<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary onclick=modify();  href="#">Modify</A></td>
							<td>
                            <IMG height=18 src="/egi/resources/erp2/images/Button_rightside.gif" width=6></td>
							<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
							
							</tr>
					<tr id="submitGrid">

							<td align="right">
                            <IMG height=18 src="/egi/resources/erp2/images/Button_leftside.gif" width=7></td>
							<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary onclick="ButtonPress('submit')" href="#">Submit</A></td>
							<td>
                            <IMG height=18 src="/egi/resources/erp2/images/Button_rightside.gif" width=7></td>
							<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
							<td align="right">
                            <IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
							<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary href="ReceiptSearch.htm">Cancel</A></td>
							<td>
                            <IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
							<td><IMG style="LEFT: -2px; WIDTH: 8px; TOP: 1px; HEIGHT: 16px" height=16 src="/egi/resources/erp2/images/spacer.gif" width=16 ></td>
							<td align="right">
                            <IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
							<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary href="Home.htm">Close</A></td>
							<td>
                            <IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
                            <td>&nbsp;</td>
                            <td align="right">
                            <IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
							<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary id=splitText onclick=showSplitUp() href="#" name=splitText>Show Splitup</A></td>
							<td>
                            <IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
							<td><IMG style="LEFT: -2px; WIDTH: 8px; TOP: 1px; HEIGHT: 16px" height=16 src="/egi/resources/erp2/images/spacer.gif" width=16 ></td>
						</tr>

					</table>
					 
					 
					 
					 
					 
					 
					 
					 
					 
					 
				</td>
			</tr>
				
				<tr class="row2" height=10>
					<td colspan="4" align="middle"></td>
				<tr>
					<td>
						<table width="80%" border="1" cellpadding="0" cellspacing="0" ID="calcTable" name="calcTable" align="center" style="DISPLAY: none">
							<tr class="rowheader">
								<td width="20%" height="34" class="columnheader"><div align="center" class="columnheader">Period 
								</div>
								</td>
								<td width="20%" height="34" class="columnheader"><div align="center" class="columnheader">A/C 
										Code</div>
								</td>
								<td width="20%" class="columnheader"><div align="center">A/C Head</div>
								</td>
								<td width="10%" class="columnheader"><div align="center">Percentage</div>
								</td>
								<td width="10%" class="columnheader"><div align="center">Amount</div></td>
								<td width="10%" class="columnheader"><div align="center">Type</div></td>
								</tr>
							<tr class="normaltext">
								<td class="columnheader"><div class="fieldinput" ID="periodC" name="periodC"></div></td>
								<td class="columnheader"><div class="fieldinput" ID="accCode" name="accCode"></div></td>
								<td class="columnheader" ><div class="fieldinput" ID="accDesc" name="accDesc"></div></td>
								<td class="columnheader"><div class="fieldinput" ID="percentC" name="percentC"></div></td>
								<td class="columnheader"><div class="fieldinput" ID="fAmount" name="fAmount" align="right"></div></td>
								<td class="columnheader"><div class="fieldinput" ID="recordType" name="recordType" align="right"></div></td>
							</tr>
							
							<tr class="normaltext">
								<td class="columnheader"><div class="fieldinput" ID="periodC" name="periodC"></div></td>
								<td class="columnheader"><div class="fieldinput" ID="accCode" name="accCode"></div></td>
								<td class="columnheader" ><div class="fieldinput" ID="accDesc" name="accDesc"></div></td>
								<td class="columnheader"><div class="fieldinput" ID="percentC" name="percentC"></div></td>
								<td class="columnheader"><div class="fieldinput" ID="fAmount" name="fAmount" align="right"></div></td>
								<td class="columnheader"><div class="fieldinput" ID="recordType" name="recordType" align="right"></div></td>
							</tr>
							
					</table>
					</td>
				</tr>
					
			</table></TD></TR>
			<tr class="row2">
				<td height="25" colspan="4" valign="bottom" class="smalltext"><p class="smalltext"><span class="leadon">*</span>
						- Mandatory Fields</p>
				</td>
			</tr></TBODY></TABLE><!------------ Content ends here ------------------></TD></TR></TABLE></TD><!------------Right Navigation Ends here------------------></TR></TABLE><!---------------- Footer begins here ----------><!---------------- Footer ends here ---------->
			<select name="inNoOfCess" id="inNoOfCess" style="VISIBILITY: hidden" exilListSource="rptCessCount"></select>
		<select name="inTotalCess" id="inTotalCess" style="VISIBILITY: hidden" exilListSource="rptCessTotal"></select>
			</form>
	</body>
	
</html>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		
