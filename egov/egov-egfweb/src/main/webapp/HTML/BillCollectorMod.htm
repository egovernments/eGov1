#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>

<script language="javascript">

var pageMode="modify";
var sameWindow=0;

function getData(){
	var billCollector_codeToSearch = PageManager.DataService.getQueryField('billCollector_codeToSearch');
	PageManager.ListService.callListService();
	PageManager.DataService.callDataService('billCollData');
	if (billCollector_codeToSearch){
		PageManager.DataService.callDataService('billCollectorData');
		document.getElementById('trModify').style.display='block';
		document.getElementById('trNew').style.display='none';

		}else {
		pageMode="add";
		//document.getElementById('screenName').innerHTML="Bill Collector - New";
		document.getElementById('trModify').style.display='none';
		document.getElementById('trNew').style.display='block';

		//document.getElementById('submitButton').innerHTML="New";
		//clearCombo('billCollector_regionId');
		//clearCombo('billCollectorDetail_wardId');
	}
	document.billCollectorModify.billCollector_code.focus();


}

function beforeRefreshPage(dc){
	//return true;
}

function afterRefreshPage(dc){
	if(dc.values['billCollector_isActive']=='0')
		document.getElementById('billCollector_isActive').checked=false;
	else if(dc.values['billCollector_isActive']=='1')
		document.getElementById('billCollector_isActive').checked=true;

}

function selectRadio(){
	var billCollector=PageManager.DataService.getQueryField('billCollector_type');
 	var billColl=document.getElementsByName('billCollector_type');
		for(var i=0;i<billColl.length;i++){
		if(billColl[i].value.toLowerCase()==billCollector.toLowerCase()){
		 	billColl[i].checked=true;
			break;
		 }
	}
}


function ButtonPress(name){
if(name.toLowerCase()=='savenew')
sameWindow=1;
	document.getElementById('egUser_id').value = CookieManager.getCookie('currentUserId');
	//   ***1 only FO***,  ***2 FO***,  ***Admin, 3 All***    //
	if(!isValidUser(2, CookieManager.getCookie('userRole')) ) return false;

	if(!checkNarration('billCollector_narration')) return false;
	if (pageMode == "modify"){
		PageManager.UpdateService.submitForm('billCollDetailUpdation');
	}else{
		/*var billCollectorName = document.getElementById('bill_name').value;
		if(billCollectorName != 'Invalid value entered.'){
		alert('BillCollector Code already exists');
		}else {*/
		PageManager.UpdateService.submitForm('billCollDetailInsertion');
	//}
	}
}

function onClickCancel(){
	window.location="BillCollectorMod.htm?showMode=new";
}

function onChangeDeptCode(){
	var bCtrl=document.getElementById('department_code');
	var deptCode = bCtrl.options[bCtrl.selectedIndex].value;
	PageManager.DataService.setQueryField('departmnt_code',deptCode);
	PageManager.DataService.callDataService('departmentNameId');
}

function clearCombo(cId){
	var bCtrl=document.getElementById(cId);
	for(var i=bCtrl.options.length-1;i>=0;i--){
		bCtrl.remove(i);
	}
}


function afterUpdateService(dc){

	str = "DC came back with success=" + dc.success + " and other fields are\n";
	if(sameWindow == 1){
	  window.location="BillCollectorMod.htm";
      }else{
	window.location="BillCollector.htm?billCollector_codeToSearch=" + dc.values['billCollector_code'];
	}
	sameWindow=0;
	return true;

}


function verifybillCollectorCode(evnt){
	//PageManager.DescService.onblur(evnt);
}


</script>
<title>Collection / Payment</title>
</head>
<body bgcolor="#ffffff" onKeyDown ="CloseWindow(event);" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0" marginheight="0" marginwidth="0" onLoad="getData();"><!------------------ Header Begins Begins--------------------->
<form name="billCollectorModify">
<input type="hidden" name="egUser_id" id="egUser_id">
<input type="hidden" name="billCollector_ID" id="billCollector_ID">
<input type="hidden" name="bill_name" id="bill_name">
<input type="hidden" name="billCollector_cashInHand" id="billCollector_cashInHand">
<input type="hidden" name="OS_regionName" id="OS_regionName">
<input type="hidden" name="billCollector_chequeInHand" id="billCollector_chequeInHand">
<input type="hidden" name="billCollector_departmentId" id="billCollector_departmentId">
<input type="hidden" name="finalWardList" id="finalWardList">
<input type="hidden" name="tableName" id="tableName" value="billCollector">
<Select type="hidden" id="billCollectorDetail_ward" name="billCollectorDetail_ward"  style="display:none"></select>

	<table width="100%" border=0 cellpadding="6" cellspacing="0">
		<tr>
			<td valign="top" class=""><!------------Content begins here ------------------>
				<table width="100%" border=0 cellpadding="3" cellspacing="0">

					<tr >
						<td align="right" valign="center"  width="221"><div align="right" class="labelcell">Code<span class="leadon">*</span></div></td>
						<td width="228" ><span class="fieldcell"><input name="billCollector_code" class="fieldcell" id="billCollector_code" exilDataType="exilAlphaNumeric" exilMustEnter="true" maxlength=10 exilDataSource="billCodeVerification" exilDescField="bill_name" onBlur="verifybillCollectorCode(event);" size=20></span></td>
						<td align="right" valign="center" width="205"><div align="right"  class="labelcell">Name<span class="leadon">*</span></div></td>
						<td width="212"><span class="fieldcell"><input name="billCollector_name" class="fieldcell" id="billCollector_name" exilDataType="exilAnyChar" exilMustEnter="true" maxlength=50 size=20></span></td>
					</tr>
					<tr>
						<td align="right" valign="center"  width="221"><div align="right" class="labelcell">Department&nbsp;Code<span class="leadon">*</span></div></td>
						<td width="228"><span class="smallfieldcell">
								<SELECT id="department_code" name="department_code" class="combowidth2" exilMustEnter="true" exilListSource="departmentCodeList" maxlength=4  onChange="onChangeDeptCode();"></SELECT>
						</span></td>
						<td align="right" valign="center"  width="205" ><div align="right" class="labelcell">Department&nbsp;Name<span class="leadon">*</span></div></td>
						<td  width="212">
								<span class="fieldcell"><input name="department_name" class="fieldcell" id="department_name"  readonly="true" size=20 exilDataType="exilAnyChar"></span></td>
					</tr>

					<tr >
						<td colspan=2 align="center"><span class="labelcellmedium" >Bill Collector
						<input type="radio" checked id=billCollector_type name=billCollector_type value=BillCollector style="width:20px">&nbsp;
						 <span class="labelcellmedium">Counter</span>
							<INPUT id="billCollector_type" type=radio name="billCollector_type" value=Counter style="width:20px"></span>
							<span class="labelcellmedium">Cashier</span>
							<INPUT id="billCollector_type" type=radio name="billCollector_type" value=Cashier style="width:20px"></span></td>
							<td ></td>
							<td ></td>
					</tr>
					<tr >
						<td width="221"><div align="right"><DIV align="right" valign="center" class="labelcell" >Narration</DIV></div></td>
						<td width="228"><TEXTAREA id=billCollector_narration class="narrationfieldinput" name=billCollector_narration exilTrimLength="20" maxlength=250 rows=3 cols=40 exilDataType="exilAnyChar"></TEXTAREA>&nbsp;</td>
						<td width="205" align="right"><div  class="labelcell" >Active</div></td>
						<td width="212"><INPUT id="billCollector_isActive" class="fieldinput" type=checkbox name="billCollector_isActive" checked="true" value="1" style="width:20px">&nbsp;</td>
					</tr>
					<tr>
                    	<td  colspan=4 width="100%">&nbsp;</td>
                    </tr>

                    <tr>
			<td height="25" colspan="4" valign="bottom" class="smalltext" width="884"><p class="smalltext"><span class="leadon">*</span>
					- Mandatory Fields</p>
			</td>
		</tr>
                    <tr>
			<td colspan="4" align="middle" width="100%"><!-- Buttons Start Here -->
				<table border="0" cellpadding="0" cellspacing="0">
					<!--<tr name="trModify" id="trModify">
						<td align="right"><IMG src="/egi/resources/erp2/images/Button_leftside.gif" width="7" height="18"></td>
						<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary href="#" onClick="ButtonPress('saveclose');" id="submitButton">Submit</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_rightside.gif" width="7" height="18"></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onClick="onClickCancel();" href="#" >Cancel</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=window.close() href="#">Close</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
					</tr>-->
					<tr name="trModify" id="trModify">
													<td width=100% align=center>
													<input type="button" class="button" id="submitButton" value="Submit" onclick="ButtonPress('saveclose')" />
													<input id="newButton"type="button" class="button" value="Cancel" onclick="onClickCancel()" />
													<input id="closeButton"type="button" class="button" value="Close" onclick="window.close()" />
													</td>
												</tr>

                  <!--<tr name="trNew" id="trNew">
						<td align="right"><IMG src="/egi/resources/erp2/images/Button_leftside.gif" width="7" height="18"></td>
						<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary href="#" onClick="ButtonPress('savenew');" id="savenNew">Save & New</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_rightside.gif" width="7" height="18"></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>

						<td align="right"><IMG src="/egi/resources/erp2/images/Button_leftside.gif" width="7" height="18"></td>
						<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary href="#" onClick="ButtonPress('saveclose');" id="savenClose">Save & Close</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_rightside.gif" width="7" height="18"></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>

						<td align="right"><IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onClick="onClickCancel();" href="#" >Cancel</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>

						<td align="right"><IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=window.close() href="#">Close</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
					</tr>-->
				<tr name="trNew" id="trNew">
							<td width=100% align=center>
									<input type="button" class="button" id="savenNew" value="Save & New" onclick="ButtonPress('savenew');" />
									<input id="savenClose"type="button" class="button" value="Save & Close" onclick="ButtonPress('saveclose');" />
									<input id="cancelButton"type="button" class="button" value="Cancel" onclick="onClickCancel();" />
									<input id="closeButton"type="button" class="button" value="Close" onclick="window.close()" />
					</td>
				</tr>


				</table>
			</td>
		</tr>

	</table><!------------ Content ends here ------------------></TD></TR></TABLE></TD><!------------Right Navigation Ends here------------------></TR></TABLE><!---------------- Footer begins here ----------><!---------------- Footer ends here ---------->
</form>
</body>
</html>
