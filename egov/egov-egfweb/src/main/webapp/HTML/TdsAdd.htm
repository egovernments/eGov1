#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="KEYWORDS" content="">
<meta http-equiv="DESCRIPTION" content="">
<!-- Inclusion of the CSS files that contains the styles -->
<link rel="stylesheet" href="../css/egov.css" type="text/css">
<SCRIPT LANGUAGE="javascript" SRC="../exility/datefunctions.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/ExilityParameters.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/PageManager.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/PageValidator.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/CookieManager.js"></Script>
<script language="javascript" src="../script/jsCommonMethods.js"></script>
   <SCRIPT type="text/javascript" src="../script/calendar.js" type="text/javascript" ></SCRIPT>

<script language="javascript">
pageMode="modify";
var sameWindow=0;
var effDate;

function getData(){
PageValidator.addCalendars();
PageManager.ListService.callListService();
	document.getElementById('tds_type').focus();
	var tds_ID=PageManager.DataService.getQueryField('tds_ID');
	var tds_type=PageManager.DataService.getQueryField('tds_type');
	if(tds_ID){
		PageManager.DataService.callDataService('checkForModify');
		PageManager.DataService.callDataService('tdsModData');
		document.getElementById('trModify').style.display='block';
		document.getElementById('trNew').style.display='none';

	}else{
	pageMode="New";
	document.getElementById('screenName').innerHTML="Relation to Creditors - New";
	document.getElementById('trModify').style.display='none';
	document.getElementById('trNew').style.display='block';
	PageManager.DataService.callDataService('getTitle'); // this dataservice is called only to refresh the page for filling current user id
	}

}
function afterRefreshPage(dc){
	    effDate= document.getElementById('tds_effectiveFrom').value;
		if(effDate)	{
		//effDate=formatDate(effDate);
		effDate=formatDate2(effDate);
		document.getElementById('tds_effectiveFrom1').value=effDate;

		}
		if(dc.values['egUser_id'])  
		{
			document.getElementById('tds_createdby').value=dc.values['egUser_id'];
			document.getElementById('egUser_id').value=dc.values['egUser_id'];
		}
		else if(dc.values['current_UserID']) 
		{
			document.getElementById('tds_createdby').value=dc.values['current_UserID'];
			document.getElementById('egUser_id').value=dc.values['current_UserID'];
		}
		
		return true;
}
/*function formatDate(dateText){
	var months = new Array(12);
	months[1] = "Jan"
	months[2] = "Feb"
	months[3] = "Mar"
	months[4] = "Apr"
	months[5] = "May"
	months[6] = "Jun"
	months[7] = "Jul"
	months[8] = "Aug"
	months[9] = "Sep"
	months[10] = "Oct"
	months[11] = "Nov"
	months[12] = "Dec"

	dateText=dateText.substring(0,10);
	var dateArray= dateText.split('-');
	var newDate=dateArray[2]+"-"+ months[parseInt(dateArray[1], 10)] +"-"+dateArray[0];
	return newDate;
}*/

function onClickCancel(){
	window.location="TdsEnq.htm";
}



function ButtonPress(name){
if(name.toLowerCase()=='savenew')
   sameWindow=1;
	//   ***1 only FO***,  ***2 FO***,  ***Admin, 3 All***    //
	if(!isValidUser(2, CookieManager.getCookie('userRole')) ) return false;
	if(document.getElementById('tds_rate').value>100) { alert("Rate should be less than 100."); return}

	//document.getElementById('egUser_id').value = CookieManager.getCookie('currentUserID');
	//document.getElementById('tds_createdby').value = CookieManager.getCookie('currentUserID');

	var effDate1=document.getElementById('tds_effectiveFrom1').value;
	document.getElementById('tds_effectiveFrom').value=formatDate5(effDate1);

	if(pageMode == "modify"){
		var eDate=document.getElementById('tds_effectiveFrom1').value;

		var cnt= document.getElementById('count').value;
		//if(compareDate(formatDateToDDMMYYYY(eDate),formatDateToDDMMYYYY(effDate)) == 1){
		if(compareDate(formatDateToDDMMYYYY1(eDate),formatDateToDDMMYYYY1(effDate)) == 1){
					alert('Effective From should be greater than '+effDate);
					return false;
		}
		var tds_ID_Get=PageManager.DataService.getQueryField('tds_ID');
		if(!(tds_ID_Get) && formatDate4(eDate)!=formatDate4(effDate))
		PageManager.UpdateService.submitForm('tdsInsert');
		else
		PageManager.UpdateService.submitForm('tdsUpdate');
	}else{
	PageManager.UpdateService.submitForm('tdsInsert');
	}
}

 /*function compareDate(dt1, dt2){
			var d1, m1, y1, d2, m2, y2, ret;
			dt1 = dt1.split('-');
			dt2 = dt2.split('-');
			d1 = parseInt(dt1[0]); m1 = parseInt(dt1[1]); y1 = parseInt(dt1[2]);
			d2 = parseInt(dt2[0]); m2 = parseInt(dt2[1]); y2 = parseInt(dt2[2]);

			ret = (y2>y1) ? 1 : (y2<y1) ? -1 : (m2>m1) ? 1 : (m2<m1) ? -1 : (d2>d1) ? 1 : (d2<d1) ? -1 : 0 ;
			return ret;
		 }*/

function beforeRefreshPage(dc){
		return true;
}



function afterUpdateService(dc){
	str = "DC came back with success=" + dc.success + " and other fields are\n";
	if(sameWindow == 1){
	  window.location="TdsAdd.htm";
      }else{
	window.location="TdsEnq.htm";
	}
	sameWindow=0;
	return true;
}

function openSearch(obj)
{
		var a = new Array(2);
		var sRtn;
		var str = "tdsadd";
		sRtn= showModalDialog("Search.html?screenName="+str,"","dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
		if(sRtn != '')
		{
			a = sRtn.split("`~`");
				var x = document.getElementById('tds_glCode');
				x.value = a[0];
				var y = document.getElementById('tds_glCodeId');
				y.value = a[2];
		}
}

</script>
<title>Creditorsrelation</title>
</head>
<body bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0" marginheight="0" marginwidth="0" onLoad="getData();" onKeyDown ="CloseWindow(event);">
<table><tr><td><div id="main"><div id="m2"><div id="m3">
<form name="TdsAdd">
<input type="hidden" name="egUser_id" id="egUser_id">
<input type="hidden" name="tds_createdby" id="tds_createdby">
<input type="hidden" name="tds_ID" id="orders_ID" size="20">
<input type="hidden" name="tds_lastModified" id="tds_lastModified" size="20">
<input  type="hidden" name="count" id="count">
<input type="hidden" name="tds_effectiveFrom" id="tds_effectiveFrom" size="20">

<table width="100%" height="74%" border="0" cellpadding="0" cellspacing="0">
	  </table>
	<table width="100%" border=0 cellpadding="6" cellspacing="0">
			<tr>
			<td valign="top" class="normaltext"><!------------Content begins here ------------------>
						<table width="100%" border=0 cellpadding="3" cellspacing="0" id="asset" name="asset" >
							<tr>
								<td class="tableheader" colspan="4" width="884"><span id="screenName" class="">Relation to Creditors - Modify</span></td>
							</tr>
							<tr>
							  <td><div align="right" class="labelcell">Type<span class="leadon">*</span></div></td>
							   <td>
								<span class="fieldcell"><input name="tds_type" class="fieldcell" id="tds_type" exilMustEnter="true" exilDataType="exilAnyChar" size="10" ></span>
							  </td>
							    <td><div align="right" class="labelcell">Rate<span class="leadon">*</span></div></td>
							   <td>
								<span class="fieldcell"><input name="tds_rate" class="fieldcell" id="tds_rate" exilMustEnter="true" exilDataType="exilUnsignedDecimal" size="10" ></span>
							  </td>
								</td>
							</tr>
						<tr>
							 <td><div align="right" class="labelcell">Effective From<span class="leadon">*</span></div></td>
							  <td><span class="smallfieldcell"><input name="tds_effectiveFrom1" id="tds_effectiveFrom1" class="datefieldinput"
            					size="10"  onkeyup="DateFormat(this,this.value,event,false,'3')"  exilDataType="exilAnyDate" exilCalendar="true" exilMustEnter="true">
								</span></td>
								<td align="right" valign="center" class="labelcell"><div align="right">Account Code<span class="leadon">*</span></div></td>
								<td width="274" ><span class="smallfieldcell"><input type="hidden" id="tds_glCodeId" name="tds_glCodeId"  class="fieldinput"><input class="fieldinput" name="tds_glCode" id="tds_glCode"  exilMustEnter="true" readOnly exilDataType="exilAlphaNumeric">
								</span><IMG id=IMG1 onclick="openSearch(this)" height=22 src="/egi/resources/erp2/images/plus1.gif" width=25 align=top border=0  ></td>
							<tr>

							<tr>
							  <td><div align="right" valign="center" class="labelcell">Active</div></td>
							  <td><input type="checkbox" name="tds_isActive" id="tds_isActive" value="1" checked>
								</td>
							  <td></td>
							  <td></td>
							 </tr>



                <tr>
				<td height="25" colspan="4" valign="bottom" class="smalltext" width="884"><p class="smalltext"> </p>
				</td>
			</tr>
			<tr>
							<td colspan="4" align="middle" width="100%"><!-- Buttons Start Here -->
								<table border="0" cellpadding="0" cellspacing="0">
					<!--	<tr>
						<td align="right"><IMG src="/egi/resources/erp2/images/Button_leftside.gif" width="7" height="18"></td>
						<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary href="#" onclick="onClickModify()" id="submitButton">Modify</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_rightside.gif" width="7" height="18"></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onClick="onClickCancel();" href="#">Cancel</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary href="Home.htm">Close</A></td>
						<td><IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
						</tr> -->
						<!--<tr name="trModify" id="trModify">
											<td align="right">
                                            <IMG src="/egi/resources/erp2/images/Button_leftside.gif" width="7" height="18"></td>
											<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary href="#" id="submitButton" onclick="ButtonPress('saveclose');" >Submit</A></td>
											<td>
                                            <IMG src="/egi/resources/erp2/images/Button_rightside.gif" width="7" height="18"></td>
											<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=16></td>
											<td align="right">
                                            <IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
											<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onClick="onClickCancel();" href="#" >Cancel</A></td>
											<td>
                                            <IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
											<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=16></td>
											<td align="right">
                                            <IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
											<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=window.close() href="#">Close</A></td>
											<td>
                                            <IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
										</tr>-->
										<tr name="trModify" id="trModify">
													<td width=100% align=center>
													<input type="button" class="button" id="submitButton" value="Submit" onclick="ButtonPress('saveclose')" />
													<input type="button" class="button" value="Cancel" onclick="onClickCancel()" />
													<input type="button" class="button" value="Close" onclick="window.close()" />
													</td>
												</tr>

										<!--<tr name="trNew" id="trNew">
											<td align="right">
											<IMG src="/egi/resources/erp2/images/Button_leftside.gif" width="7" height="18"></td>
											<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary href="#" id="savenNew" onclick="ButtonPress('savenew');;" >Save & New</A></td>
											<td>
											<IMG src="/egi/resources/erp2/images/Button_rightside.gif" width="7" height="18"></td>
											<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=16></td>
											<td align="right">
                                            <IMG src="/egi/resources/erp2/images/Button_leftside.gif" width="7" height="18"></td>
											<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary href="#" id="savenClose" onclick="ButtonPress('saveclose');" >Save & Close</A></td>
											<td>
                                            <IMG src="/egi/resources/erp2/images/Button_rightside.gif" width="7" height="18"></td>
											<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=16></td>
											<td align="right">
                                            <IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
											<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onClick="onClickCancel();" href="#" >Cancel</A></td>
											<td>
                                            <IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
											<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=16></td>
											<td align="right">
                                            <IMG src="/egi/resources/erp2/images/Button_second_leftside.gif" width="6" height="18"></td>
											<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=window.close() href="#">Close</A></td>
											<td>
                                            <IMG src="/egi/resources/erp2/images/Button_second_rightside.gif" width="6" height="18"></td>
										</tr>-->
										<tr name="trNew" id="trNew">
													<td width=100% align=center>
													<input type="button" class="button" id="savenNew" value="Save & New" onclick="ButtonPress('savenew');" />
													<input type="button" class="button" id="savenClose"value="Save & Close" onclick="ButtonPress('saveclose');" />
													<input type="button" class="button" value="Cancel" onclick="onClickCancel();" />
													<input type="button" class="button" value="Close" onclick="window.close()" />
																										</td>
												</tr>


						</table><!-- Buttons End Here -->
					</td>
				</tr>

							  </table>

							</td>
						</tr>


                              </table>
							 </td>
						  </tr>

					</table><!------------ Content ends here ------------------></TD></TR></TABLE></TD><!------------Right Navigation Ends here------------------></TR></TABLE><!---------------- Footer begins here ----------><!---------------- Footer ends here ---------->
</form>
</div></div></div></td></tr></table>
</body>
</html>
