#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
<SCRIPT LANGUAGE="javascript">
var showSection=true;
var str="";
var isDrillDown="false";
var isIE;
var req2;
var req;
var codeArray=new Array();
var j=-1;
var k=-1
var sIndex,sValue,sText;
var wIndex,wValue,wText;
var acccodeArray;
var codeObj;
var dedAcccodeArray;
var dedCodeObj;
var conNameArray;
var conNameObj;
var worksArray;
var worksObj;
var funcArray;
var funcObj;
var yuiflag = new Array();


function calculateTDS(){
	var tds=document.getElementById('worksDetail_tdsAmount');
	var passedAmt=document.getElementById('supplierBillDetail_passedAmount');
	var supplierPercent=document.getElementById('supplier_tds');
	var tdsAmt=(passedAmt.value*supplierPercent.value)/100;
	tds.value=tdsAmt;
}
function isValidAmount(){
	var billAmount=document.getElementById('supplierBillDetail_billAmount').value;
	var passedAmount=document.getElementById('supplierBillDetail_passedAmount').value ;
	var totalValue=document.getElementById('worksDetail_totalValue').value;
	var totalPassedAmount=document.getElementById('worksDetail_totalPassedAmount').value;
	if(isNaN(parseInt(totalPassedAmount)))totalPassedAmount="0";
	var advanceAmount=document.getElementById('worksDetail_advanceAmount').value ;
	var adjustmentAmount=document.getElementById('worksDetail_adjustmentAmount').value ;
	if(isNaN(parseInt(adjustmentAmount)))adjustmentAmount="0";
	if((parseFloat(billAmount)+parseFloat(totalPassedAmount))>parseFloat(totalValue)){
		alert("Bill amount cannot exceeded total amount");
		document.getElementById('supplierBillDetail_billAmount').focus();
		return false;
	}
/*	if((parseFloat(passedAmount)+parseFloat(adjustmentAmount))>parseFloat(billAmount))
	 {
		alert("Passed amount and adjustment amount exceeded bill amount:");
		document.getElementById('supplierBillDetail_passedAmount').focus();
		return false;
	}*/
	if(parseFloat(adjustmentAmount)>parseFloat(advanceAmount)){
		alert("Adjustment amount cannot exceed advance amount");
		document.getElementById('worksDetail_adjustmentAmount').focus();
		return false;
	}
	/*if(((parseFloat(passedAmount)+parseFloat(advanceAmount))-parseFloat(adjustmentAmount))>(parseFloat(totalValue)-parseFloat(totalPassedAmount)))
	 {
		alert("Adjust advance amount and passed amount ");
		document.getElementById('supplierBillDetail_passedAmount').focus();
		return false;
	}
	if(((parseFloat(totalValue)-parseFloat(totalPassedAmount))-(parseFloat(passedAmount)+parseFloat(adjustmentAmount)))<
		(parseFloat(advanceAmount)-parseFloat(adjustmentAmount)))
	 {
		alert("Adjust advance amount and passed amount ");
		document.getElementById('supplierBillDetail_passedAmount').focus();
		return false;
	}*/
	if(	(parseFloat(passedAmount)<=0) &&
		((parseFloat(totalValue)-parseFloat(totalPassedAmount))!=parseFloat(advanceAmount))){
		alert("Passed Amount cannot be zero ");
		document.getElementById('supplierBillDetail_passedAmount').focus();
		return false;
	}


	return true;
}
function showAdvanceRow(flag){
	var tab=document.getElementById('TABLEM');
	if(!flag){
		tab.rows[9].style.display='none';
	}
	else{
		tab.rows[9].style.display='block';
	}
}

function showHide(){
	var tab=document.getElementById('TABLEM');
	var buton=document.getElementById('sh_button');
	if(!showSection){
		tab.rows[12].style.display='block';
		showSection=true;
		buton.value="-";
	}
	else{
		buton.value="+";
		tab.rows[12].style.display='none';
		showSection=false;
	}
}
function clearCombo(cId)
{
   var bCtrl=document.getElementById(cId);
   if(bCtrl.options.length!=null){
   for(var i=bCtrl.options.length-1;i>=0;i--)
   {
   	bCtrl.remove(i);
   }
   }
   var obj=document.getElementById('worksDetail_orderDate');
   obj.value="";
   obj=document.getElementById('worksDetail_totalValue');
   obj.value="";
   obj=document.getElementById('worksDetail_totalPassedAmount');
   obj.value="";
   obj=document.getElementById('worksDetail_advanceAmount');
   obj.value="";
   obj=document.getElementById('worksDetail_adjustmentAmount');
   obj.value="";
   document.getElementById('worksDetail_outstandingAmount').value="";
  // showAdvanceRow(false);
}
function loadWorkOrders(splCode){
	clearCombo('worksDetail_name');

	if(splCode==null || splCode=="")return;

	PageManager.DataService.setQueryField('relationId',splCode);
	//var obj=document.getElementById('worksDetail_id');
	//obj.setAttribute('exilListSource','supBillDetail_worksDetailID');
	//alert(document.getElementById('worksDetail_id').value)
	var obj=document.getElementById('worksDetail_name');
	obj.setAttribute('exilListSource','conBillDetail_worksDetailID');

	PageManager.DataService.callDataService('workOrderNameList');
}

function loadWorkOrderData(workOrderID){
	//if(obj.selectedIndex==-1)return;
	//var workOrderID=obj.options[obj.selectedIndex].value;
	//alert('workOrderID='+workOrderID)
	PageManager.DataService.setQueryField('workOrderID',workOrderID);
	PageManager.DataService.callDataService('workOrderData_supplier');

	loadFund();
	loadFundSource();
	var tableObj=document.getElementById("gridSupplierJournal");
	//alert("tableObj.rows.length"+tableObj.rows.length);
	//var gltable= document.getElementById("gridContractorJournal");
		for(var i=tableObj.rows.length-1;i>=1;i--)
			{
				tableObj.deleteRow(i);
			}


	PageManager.DataService.addNewRow('gridSupplierJournal');
	PageManager.DataService.addNewRow('gridSupplierJournal');

}
function onBodyLoad(){
	//document.title="Supplier Bill";
	document.getElementById('voucherHeader_voucherNumber').focus();
    document.getElementById('reverseSubmit').style.display ="none";
	//showAdvanceRow(false);
	PageValidator.addCalendars();
	//PageManager.ListService.callListService();
	var cgn=PageManager.DataService.getQueryField('cgNumber');
	var sm=PageManager.DataService.getQueryField('showMode');
	 if(cgn && (sm=="modify"))
	 {
	 			isDrillDown="true";
				PageManager.DataService.setQueryField('cgNumber',cgn);
				PageManager.DataService.callDataService('getSupplierDetails');
				//var obj=document.getElementById('worksDetail_id');
			//	obj.setAttribute('exilListSource','conBillDetail_worksDetailID');
				PageManager.DataService.callDataService('getSuWoDetails');
				document.getElementById('voucherHeader_voucherNumber').setAttribute('exilDataType','exilAlphaNumeric');
				document.getElementById('modGrid').style.display='block';
				document.getElementById('submitGrid').style.display ="none";
				document.getElementById('cgnLabel').style.display='block';
				document.getElementById('cgnText').style.display='block';
				document.getElementById('IMG2').style.display ="none";
				 document.getElementById('backbutton').style.display="none";
				disableControls(0,true);
	}
	if(cgn && (sm=="view"))
	 {
	 				isDrillDown="true";
					PageManager.DataService.setQueryField('cgNumber',cgn);
					//PageManager.DataService.callDataService('getSupplierDetails');
					//var obj=document.getElementById('worksDetail_name');
					//obj.setAttribute('exilListSource','conBillDetail_worksDetailID');

					PageManager.DataService.callDataService('getSuWoDetails');
					document.getElementById('modGrid').style.display='none';
					document.getElementById('submitGrid').style.display ="none";
					document.getElementById('cgnLabel').style.display='block';
						document.getElementById('cgnText').style.display='block';
						 document.getElementById('backbutton').style.display='block';
						 document.getElementById('IMG2').style.display ="none";
					disableControls(0,true);
	}
	else if(cgn && (sm=="edit")){

					isDrillDown=true;
					PageManager.DataService.setQueryField('cgNumber',cgn);
					//PageManager.DataService.callDataService('getSupplierDetails');
					//var obj=document.getElementById('worksDetail_id');
					//obj.setAttribute('exilListSource','conBillDetail_worksDetailID');
					PageManager.DataService.callDataService('getSuWoDetails');
					document.getElementById('voucherHeader_voucherNumber').setAttribute('exilDataType','exilAlphaNumeric');
					document.getElementById('modGrid').style.display='none';
					document.getElementById('submitGrid').style.display ="none";
					document.getElementById('saveandnew').style.display ="none";
			  		document.getElementById('cgnLabel').style.display='block';
			  		document.getElementById('cgnText').style.display='block';
			  		document.getElementById('backbutton').style.display='none';
			  		//var mdcol=document.getElementById('TypeOfCollection').value;
			  		//document.getElementById('screenName').innerHTML="Supplier Bill -Modify";

					edit();
		 	 }

	if(!cgn)
	{
		PageManager.DataService.callDataService('cgNumber');
		PageManager.DataService.addNewRow('gridSupplierJournal');
		//document.supplierJournal.voucherHeader_voucherNumber.focus();
		obj=document.getElementById('modGrid').style.display="none";
		 document.getElementById('backbutton').style.display="none";
		document.getElementById('statusInfo').style.display ="none";
	}
	//alert(document.getElementById('supplier_code1').value);
	//var temp=document.getElementById('supplier_code').value;
	//alert(temp.value);
	//alert("end onbody");
	 loadDropDownCodes();
	 loadDropDownSuppliers();
	 loadDropDownFuncNames();

}

function loadDropDownCodes()
	 {

	 	var type='getAllCoaCodes';
		var url = "../commons/Process.jsp?type=" +type+ " ";
		var req2 = initiateRequest();
		req2.onreadystatechange = function()
		{
			  if (req2.readyState == 4)
			  {
				  if (req2.status == 200)
				  {
					var codes2=req2.responseText;
					var a = codes2.split("^");
					var codes = a[0];
					acccodeArray=codes.split("+");
					codeObj = new YAHOO.widget.DS_JSArray(acccodeArray);


				  }
			  }
		};
		req2.open("GET", url, true);
		req2.send(null);
	 }
function loadDropDownFuncNames()
	 {

	 	var type='getAllFunctionName';
		var url = "../commons/Process.jsp?type=" +type+ " ";
		var req2 = initiateRequest();
		req2.onreadystatechange = function()
		{
			  if (req2.readyState == 4)
			  {
				  if (req2.status == 200)
				  {
					var codes2=req2.responseText;
					var a = codes2.split("^");
					var codes = a[0];
					funcArray=codes.split("+");
					funcObj= new YAHOO.widget.DS_JSArray(funcArray);


				  }
			  }
		};
		req2.open("GET", url, true);
		req2.send(null);
	 }


 	 function loadDropDownSuppliers()
		 {
//alert("hi");
			var url="../commons/Process.jsp?type=supplierName";
			var req = initiateRequest();
			req.onreadystatechange = function()
			{
				  if (req.readyState == 4)
				  {
					if (req.status == 200)
						{
							var codes2=req.responseText;
							var a = codes2.split("^");
							var codes = a[0];
							var conNameArray=codes.split("+");
							conNameObj = new YAHOO.widget.DS_JSArray(conNameArray);
						}
				  }
			};
			//alert("hi");
			req.open("GET", url, true);
			req.send(null);

 	}


function autocompletecode(obj)
	{
		var currRow=PageManager.DataService.getRow(obj);
		var coaCodeObj = PageManager.DataService.getControlInBranch(currRow,'chartOfAccounts_glCode');
		container=document.getElementById('codescontainer');
		objPosition=findPos(obj);
		container.style.position="absolute";
		container.style.left=objPosition[0];
		container.style.top=objPosition[1]+20;

		if(yuiflag[currRow.rowIndex] == undefined)
   		{

		//40 --> Down arrow, 38 --> Up arrow
					if(event.keyCode != 40 )
					{
						if(event.keyCode != 38 )
						{

								var oAutoComp = new YAHOO.widget.AutoComplete(coaCodeObj,'codescontainer', codeObj);
								oAutoComp.queryDelay = 0;
								oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
								oAutoComp.useShadow = true;
								oAutoComp.useIFrame = true;
						}
					if(event.keyCode == 13)
				{

				}

					}
				yuiflag[currRow.rowIndex] = 1;
		}

	}
function autocompletefuncName(obj)
	{
		var currRow=PageManager.DataService.getRow(obj);
		var coaCodeObj = PageManager.DataService.getControlInBranch(currRow,'function_code');
		container=document.getElementById('codescontainer');
		objPosition=findPos(obj);
		container.style.position="absolute";
		container.style.left=objPosition[0];
		container.style.top=objPosition[1]+20;

		if(yuiflag[currRow.rowIndex] == undefined)
   		{
		//40 --> Down arrow, 38 --> Up arrow
					if(event.keyCode != 40 )
					{
						if(event.keyCode != 38 )
						{

								var oAutoComp = new YAHOO.widget.AutoComplete(coaCodeObj,'codescontainer', funcObj);
								oAutoComp.queryDelay = 0;
								oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
								oAutoComp.useShadow = true;
								oAutoComp.useIFrame = true;
						}
					if(event.keyCode == 13)
				{

				}

					}
			yuiflag[currRow.rowIndex] = 1;
		}

	}

function autocompleteSupList(obj)
	{

		//40 --> Down arrow, 38 --> Up arrow
 //window.captureEvents(Event.CLICK);
 document.getElementById('supplier_code1').value="";
 document.getElementById('worksDetail_name').value="";
 document.getElementById('worksDetail_code').value="";
 container=document.getElementById('codescontainer');
	objPosition=findPos(obj);
	container.style.position="absolute";
	container.style.left=objPosition[0]+20;
	container.style.top=objPosition[1]+20;

					if(event.keyCode != 40 )
					{
						if(event.keyCode != 38 )
						{
								var oAutoComp = new YAHOO.widget.AutoComplete(obj,'codescontainer', conNameObj);
								oAutoComp.queryDelay = 0;
								oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
								oAutoComp.useShadow = true;
								oAutoComp.useIFrame = true;
						}


					/*	if(event.keyCode == 13)
						{
							 var arr=document.getElementById('contractor_name').value.split("`-`");
							if(arr[1]==null){ alert("Enter valid contractor name"); return  }
							else{
								document.getElementById('contractor_name').value=arr[0];
								document.getElementById('contractor_code').value=arr[1];
								getAccName(event);
								 return false;
								}
						}*/


			}

			if(event.type=='click')	{alert("clicked"); }

//window.releaseEvents(event.CLICK);

	}
function findPos(obj)
{
	var curleft = curtop = 0;
	if (obj.offsetParent)
	{
		curleft = obj.offsetLeft;
		curtop = obj.offsetTop;
		while (obj = obj.offsetParent)
		{ //alert(obj.nodeName);
			curleft =curleft + obj.offsetLeft;
			curtop =curtop + obj.offsetTop; //alert(curtop);
		}
	}
	return [curleft,curtop];
}
function edit(){
				var cgn=PageManager.DataService.getQueryField('cgNumber');
		 		if(cgn){
		 			//document.forms[0].voucherHeader_cgn.disabled=true;
		 			//document.forms[0].voucherHeader_voucherNumber.disabled=true;
		 			document.getElementById("vnum").style.display="block";
		 			document.getElementById('submitGrid').style.display ="block";
					document.getElementById('modeOfExec').value="edit";
					//enableControls(0,false);
		 	 	}
		}



function beforeRefreshPage(dc)
{
	if(dc.values['glCodeName'])
	{
		  glNameCode=dc.values['glCodeName'];
		 showEntry();
	}
	if(dc.values['serviceID']=='cgNumber'){
		if(isNaN(parseInt(dc.values['voucherHeader_cgn']))) return;
		dc.values['voucherHeader_cgn'] = 'SJV' + dc.values['voucherHeader_cgn'];
	}else if(dc.values['serviceID']=='workOrderData_supplier'){
		var advAmount=dc.values['worksDetail_advanceAmount'];
		//if(advAmount!=null &&  parseFloat(advAmount)>0)
		// showAdvanceRow(true);
		//else
		// showAdvanceRow(false);
	}

	supplier_code = PageManager.DataService.getQueryField('supplierCode');
	if(supplier_code != null)
	dc.values['supplier_code'] = supplier_code;
	if(isDrillDown && (dc.values['serviceID']=='getSupplierDetails' ))
	{
		dc=createRowIndex(dc,'gridSupplierJournal','entities_grid');
	}
	if (dc.values['serviceID']=='getSupplierDetails')
	{
		var entityGrid=dc.grids['entities_grid'];
		if(entityGrid.length==1)
		{
			entityGrid[1]=new Array();
			for (var i=0;i<4; i++)
				entityGrid[1][i]='';
			dc.grids['entities_grid']=entityGrid;
		}
	}
}
       function funClear(obj, tableName)
		 {
		   if(tableName.toLowerCase() == 'chartofaccounts')
			{
				var v =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'function_code')
				var w =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'cv_fromFunctionCodeId')
				if(v.value=="")
				{
				v.value = "";
				w.value = "";
				}
			}

		}
	   function openSearch(obj,tableName)
	   {
		 if(PageManager.DataService.getQueryField('showMode')!=null && (PageManager.DataService.getQueryField('showMode')=='view' || PageManager.DataService.getQueryField('showMode')=='modify')) return false;
		 var a = new Array(4);
         var sRtn ;
         var str="";

         if (tableName.toLowerCase()=='chartofaccounts'){
			//str="Search.html?screenName=supplierJV";
			  str="Search.html?filterServiceID=7";
         } 
         else if(tableName.toLowerCase()=='relation')
         {
			//str="Search.html?tableNameForCode=relation&relationType=1";
			str="Search.html?tableNameForCode=relationnames&relationType=1";
         }

		sRtn= showModalDialog(str,"","dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
         if ( sRtn != '' )
	       {
			 a = sRtn.split("`~`");

			if(tableName.toLowerCase() == 'chartofaccounts')
			{
			  var x = PageManager.DataService.getControlInBranch(obj.parentNode,'chartOfAccounts_glCode');
			  x.value = a[0];
			  var y = PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'chartOfAccounts_name');
			  y.value = a[1];
			/*  var v =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'function_code')
			  var w =PageManager.DataService.getControlInBranch(obj.parentNode.parentNode,'cv_fromFunctionCodeId')
			  if(v.value=="")
			  {
			  v.value = a[3];
			  w.value = a[4];
			  }
			  //alert("a 0 value= "+a[0]+" a 1 value = " +a[1]+" a 2 value ="+a[2]+" a 3 value = " +a[3]+" a 4 value= "+a[4]);*/

			}
			if(tableName.toLowerCase() == 'relation')
			{
			  var x = PageManager.DataService.getControlInBranch(obj.parentNode,'supplier_code1');
			  x.value = a[0];
			  var y = document.getElementById('relation_id');
			  y.value = a[2];
			  var z = document.getElementById('supplier_name');
			  z.value = a[1];
			  //loadWorkOrders(a[0]);
			}
		   }
         }
         function openSearch1(obj, tableName)
         {
		if(PageManager.DataService.getQueryField('showMode')!=null && (PageManager.DataService.getQueryField('showMode')=='view' || PageManager.DataService.getQueryField('showMode')=='modify')) return false;
		var a = new Array(2);
		var sRtn;
		var str="";
		if(tableName.toLowerCase()=='function'){
		 str = "Search.html?tableNameForCode=function";

		sRtn= showModalDialog(str,"",
				"dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
		if(sRtn != '')
		{
			a = sRtn.split("`~`");

			if(tableName.toLowerCase() == 'function')
			{
				//alert("a 0 value= "+a[0]+" a 1 value = " +a[1]+" a 2 value ="+a[2]);
				var y = PageManager.DataService.getControlInBranch(obj.parentNode,'function_code');
				y.value = a[1];
				var x = PageManager.DataService.getControlInBranch(obj.parentNode,'cv_fromFunctionCodeId');
				x.value = a[2];

			}
		}
	}
  }

		  
  	   	function openSearch2(obj, tableName)
  	   	{
	  	   	if(PageManager.DataService.getQueryField('showMode')!=null && PageManager.DataService.getQueryField('showMode')=='view') return false;
			var a = new Array(2);
			var sRtn;
			var str="";
			if(tableName.toLowerCase()=='worksdetail')
			{
				if(document.getElementById('relation_id').value=="") { alert("Select Supplier"); return;}
					str = "Search.html?tableNameForCode=worksdetail&relationId="+document.getElementById('relation_id').value;
			}
			sRtn= showModalDialog(str,"","dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
			if(sRtn != '')
			{
				a = sRtn.split("`~`");
				
				if(tableName.toLowerCase() == 'worksdetail')
				{
					//alert("a 0 value= "+a[0]+" a 1 value = " +a[1]+" a 2 value ="+a[2]);
					var rowObj=PageManager.DataService.getRow(obj);
					//alert(rowObj.innerHTML);
					PageManager.DataService.getControlInBranch(rowObj,'worksDetail_id').value = a[2];
					PageManager.DataService.getControlInBranch(rowObj,'worksDetail_name').value=a[1];
					PageManager.DataService.getControlInBranch(rowObj,'worksDetail_code').value = a[0];
	
					setWorkCode();
				}	
			}
  	   }
  	   
       function colTotal(obj,target)
       {
	      var a = document.getElementsByName(obj.name);
 	      count = 0;
 	      for(var i = 0; i<=a.length-1;i++) {
 	      if(a[i].value)
 	      count += parseFloat(a[i].value);
 	      }
 	      count=Math.round(count*100)/100 ;
	      document.getElementById(target).value = count;
       }

       function checkNarration(narration)
		{
			if(narration.value.length>=250){
			  alert("Narration Cannot Be More Than " + 250 + " Characters");
			  return false;
			}
			return true;
		}

	   function getAccName(event) {
				  		clearTable(document.getElementById("completeTable"));
						PageManager.DescService.onblur(event);
					}
	   function getFunId(event) {
				  		clearTable(document.getElementById("completeTable"));
						PageManager.DescService.onblur(event);
			}

       function ButtonPress(name){

       	  insertBlankRow('entities_grid',1);//insert blank row at position=1
            document.getElementById("supplier_code").value=document.getElementById("supplier_code1").value;
            if(name.toLowerCase()=='savenew')
            str="new";
            if(name.toLowerCase()=='saveclose')
            str="close";
            var cgn=PageManager.DataService.getQueryField('cgNumber');

            if(cgn)
            {
             disableControls(0,false);
			  	var gltable= document.getElementById("gridSupplierJournal");
			  	code=PageManager.DataService.getControlInBranch(gltable.rows[1],'chartOfAccounts_glCode').value;
			  	code1=PageManager.DataService.getControlInBranch(gltable.rows[1],'voucherDetail_debitAmount').value;
			  	code2=PageManager.DataService.getControlInBranch(gltable.rows[1],'voucherDetail_creditAmount').value;

			  	if(code== ''){
				alert('Please enter the Account code ');
				return false;
				}
			  	if(code1== 0 && code2==0){
				alert('Please enter the Amount ');
				return false;
				}
				if(!validate())
				return false;
             }
             else
             {
             	var vt=document.getElementById('voucherHeader_voucherDate').value;
				var wt=document.getElementById('worksDetail_orderDate').value;
				if( compareDate(formatDate6(wt),formatDate6(vt)) == -1 ){
						alert('Voucher Date cannot be prior to Purchase Order Date');
						return false;
		  	}
		  	var netAmt=parseFloat(document.getElementById("worksDetail_NetAmount").value);
			var adjustedAmt=parseFloat(document.getElementById("worksDetail_adjustmentAmount").value);
			var basicAmt=netAmt+adjustedAmt;
			if(basicAmt<0)
			{
			  alert("Deductions Cannot be greater than Passed Amount");
			  return false;
			}
			else if(adjustedAmt>0 && adjustedAmt>basicAmt)
			{
			   alert("Cannot Adjust Amount: "+adjustedAmt);
			   return false;
			}

       		if(!PageValidator.validateForm())
				return false;
			if(!isValidAmount())
				return false;
			if(!validate())
				return false;
				disableControls(0,false);
			}
		 		var dbDate=document.getElementById('databaseDate').value;
				var vhDate=document.getElementById('voucherHeader_voucherDate').value;
				var billDate=document.getElementById('supplierBillDetail_billDate').value;
				var mrnDate=document.getElementById('supplierBillDetail_mrnDate').value;
				if(compareDate(formatDateToDDMMYYYY1(vhDate),formatDateToDDMMYYYY1(dbDate)) == -1 )
				{
				alert('Voucher Date should be less than or equal to '+dbDate);
				document.getElementById('voucherHeader_voucherDate').focus();
				return false;
				}
				if(compareDate(formatDateToDDMMYYYY1(billDate),formatDateToDDMMYYYY1(dbDate)) == -1 )
				{
				alert('Bill Date should be less than or equal to '+dbDate);
				document.getElementById('supplierBillDetail_billDate').focus();
				return false;
				}
				if(compareDate(formatDateToDDMMYYYY1(mrnDate),formatDateToDDMMYYYY1(dbDate)) == -1 )
				{
				alert('MRN Date should be less than or equal to '+dbDate);
				document.getElementById('supplierBillDetail_mrnDate').focus();
				return false;
				}
				var sm=PageManager.DataService.getQueryField('showMode');
				if(sm=='modify')
				{
				var effDate=document.getElementById('voucherHeader_effDate').value;
				if(compareDate(formatDateToDDMMYYYY1(effDate),formatDateToDDMMYYYY1(dbDate)) == -1 ){
				alert('Voucher Date should be less than or equal to '+dbDate);
				document.getElementById('voucherHeader_effDate').focus();
				return false;
				}
				}
			/* calculate dr and cr column total*/
			var drcrobj=document.getElementById('voucherDetail_debitAmount');
			colTotal(drcrobj,'debitTotal');
			drcrobj=null;
			drcrobj=document.getElementById('voucherDetail_creditAmount');
			colTotal(drcrobj,'creditTotal');

			PageManager.UpdateService.submitForm('supplierJournal');
		}

		function validate(){
			var i, j, debit=0, credit=0, drTotal=0, crTotal=0, billAmount=0, passedAmount=0;
			var adjAmt=0;
			if(isNaN(parseFloat(document.getElementById('worksDetail_adjustmentAmount').value)))
				adjAmt=0;
			else
				adjAmt=	parseFloat(document.getElementById('worksDetail_adjustmentAmount').value);
			billAmount = eval(document.supplierJournal.supplierBillDetail_billAmount.value);
			passedAmount = eval(document.supplierJournal.supplierBillDetail_passedAmount.value);
			bilAmount = isNaN(billAmount) ? 0 : billAmount;
			passedAmount = isNaN(passedAmount) ? 0 : passedAmount;

			if(bilAmount < passedAmount){
				alert('passed amount cannot be greater than bill amount');
				return false;
			}

			/* checking for duplicate account codes */
			if(!checkForFunction_AccountCode('gridSupplierJournal','cv_fromFunctionCodeId','chartOfAccounts_glCode')) return false;

			for(i=0; i<document.supplierJournal.voucherDetail_debitAmount.length; i++){

				table = document.getElementById('gridSupplierJournal');


				debit = eval(document.supplierJournal.voucherDetail_debitAmount[i].value);
				credit = eval(document.supplierJournal.voucherDetail_creditAmount[i].value);
				debit = isNaN(debit)?0:debit;
				credit = isNaN(credit)?0:credit;
				drTotal = drTotal + debit;
				crTotal = crTotal + credit;

				if( (debit > 0 || credit > 0) && document.supplierJournal.chartOfAccounts_glCode[i].value.length == 0){
					document.supplierJournal.chartOfAccounts_glCode[i].focus();
					alert('account code is missing for credit/debit supplied field ' + i);
					return false;
				}
				if(debit > 0 && credit > 0){
						document.supplierJournal.voucherDetail_debitAmount[i].focus();
					alert('one account can have only credit or debit...CHECK ACCOUNT : ' + document.supplierJournal.chartOfAccounts_glCode[i].value);
					return false;
				}
				if(debit==0 && credit == 0 &&  document.supplierJournal.chartOfAccounts_glCode[i].value.length != 0){
					document.supplierJournal.voucherDetail_debitAmount[i].focus();
					alert('enter debit/credit amount for the account code ' + document.supplierJournal.chartOfAccounts_glCode[i].value);
					return false;
				}
				if(isNaN(eval(document.supplierJournal.voucherDetail_debitAmount[i].value)))
					document.supplierJournal.voucherDetail_debitAmount[i].value = 0;
				if(isNaN(eval(document.supplierJournal.voucherDetail_creditAmount[i].value)))
					document.supplierJournal.voucherDetail_creditAmount[i].value = 0;
			}

			if(i==0)
			{
				debit = eval(document.supplierJournal.voucherDetail_debitAmount.value);
				credit = eval(document.supplierJournal.voucherDetail_creditAmount.value);
				debit = isNaN(debit)?0:debit;
				credit = isNaN(credit)?0:credit;
				drTotal = drTotal + debit;
				crTotal = crTotal + credit;

				if( (debit > 0 || credit > 0) && document.supplierJournal.chartOfAccounts_glCode.value.length == 0){
					document.supplierJournal.chartOfAccounts_glCode.focus();
					alert('supply account code for the credit/debit');
					return false;
				}
				if(debit > 0 && credit > 0){
						document.supplierJournal.voucherDetail_debitAmount.focus();
					alert('one account can have only credit or debit...CHECK ACCOUNT : ' + document.supplierJournal.chartOfAccounts_glCode.value);
					return false;
				}
				if(debit==0 && credit == 0 &&  document.supplierJournal.chartOfAccounts_glCode.value.length != 0){
					document.supplierJournal.voucherDetail_debitAmount.focus();
					alert('enter debit/credit amount for the account code ' + document.supplierJournal.chartOfAccounts_glCode.value);
					return false;
				}
				if(isNaN(eval(document.supplierJournal.voucherDetail_debitAmount.value)))
					document.supplierJournal.voucherDetail_debitAmount.value = 0;
				if(isNaN(eval(document.supplierJournal.voucherDetail_creditAmount.value)))
					document.supplierJournal.voucherDetail_creditAmount.value = 0;
			}

			if(crTotal > drTotal){
				alert('total credit cant exceed  total debit amount');
				return false;
			}
			/*if(crTotal<=0){
				alert('no transaction with no credit/debit');
				return false;
			}
			if(crTotal != passedAmount){
				alert('passed amount and credit/debit amount must be same');
				return false;
			}*/

			if(drTotal<=0){
				alert('no transaction with no debit');
				return false;
			}
			if(drTotal != passedAmount){
				alert('passed amount must be same as debit amount ');
				return false;
			}
			return true;
		}

		function afterUpdateService(dc)
		{
			disableControls(0,true);
			if(str=="new")	window.location = "SupplierJournal.htm"
			if(str=="close") window.close()
		}

		function onClickCancel()
		{
			window.location = "SupplierJournal.htm"
		}
		function afterRefreshPage(dc){


			var cgn=PageManager.DataService.getQueryField('cgNumber');
			var sm=PageManager.DataService.getQueryField('showMode');
			if("getRelationIdFromCode"==dc.values['serviceID'] )
			{
				//loadWorkOrders(document.getElementById('relation_id').value);
				if(document.getElementById("worksDetail_id").value!='')
					loadWorkOrderData(document.getElementById("worksDetail_id").value);
			}

			if("getSupplierDetails"==dc.values['serviceID'] &&sm=="edit" && cgn)
			{
			   var vnum=dc.values['voucherHeader_voucherNumber'];
			   var subVnum=vnum.substring(0,2);

			   document.getElementById("voucherHeader_voucherNumber").value=vnum.substring(2,vnum.length);
			   document.getElementById("vnum").value=subVnum;

			    if(document.getElementById("oldVoucherDate").value == "")
			    {
			   			document.getElementById("oldVoucherDate").value=formatDate2(dc.values['voucherHeader_voucherDate']);
		 		}
		 		//alert(document.getElementById("oldVoucherDate").value);
				var obj=document.getElementById("asset_name");
				if(dc.values['asset_id'])
		 		  obj.options[obj.selectedIndex].value=dc.values['asset_id'];

			}
			if(dc.values['databaseDate']!='' && dc.values['serviceID']=='cgNumber')
			{
			var dt=dc.values['databaseDate']
			document.getElementById('voucherHeader_voucherDate').value=dt;
			}
			if(dc.values['serviceID']=='workOrderData_supplier')
			{
				var worksDetordDate =dc.values['worksDetail_orderDate'];
				worksDetordDate=formatDateToDDMMYYYY4(worksDetordDate);
				document.getElementById('worksDetail_orderDate').value=worksDetordDate;
			}

			if(dc.values['serviceID']=='getSuWoDetails')
			{
			var cgn=PageManager.DataService.getQueryField('cgNumber');
			PageManager.DataService.setQueryField('cgNumber',cgn);
			PageManager.DataService.callDataService('getSupplierDetails');
			}

			if(dc.values['serviceID']=='getSupplierDetails'){
				var voucherStatus=dc.values['voucherHeader_status'];
				var voucherConfirmed=dc.values['voucherHeader_confirmed'];
				if(voucherConfirmed=='0')
					document.getElementById('voucherHeader_status').value="Unconfirmed";
				else if(voucherConfirmed=='1' && voucherStatus=='0')
					document.getElementById('voucherHeader_status').value="Confirmed";
				else if(voucherStatus=='1')
					document.getElementById('voucherHeader_status').value="Reversed";
				else if(voucherStatus=='2')
				document.getElementById('voucherHeader_status').value="Reversal";
				var voucherHeader_voucherDate=dc.values['voucherHeader_voucherDate'];
				if(voucherHeader_voucherDate){
				voucherDate=formatDate2(voucherHeader_voucherDate);
				document.getElementById('voucherHeader_voucherDate').value=voucherDate;
				}
				var worksDetail_orderDate=dc.values['worksDetail_orderDate'];
				if(worksDetail_orderDate){
				worksDetail_orderDate=formatDate2(worksDetail_orderDate);
				document.getElementById('worksDetail_orderDate').value=worksDetail_orderDate;
				}
				var supplierBillDetail_billDate	=dc.values['supplierBillDetail_billDate'];
				if(supplierBillDetail_billDate){
				supplierBillDetail_billDate	=formatDate2(supplierBillDetail_billDate);
				document.getElementById('supplierBillDetail_billDate').value=supplierBillDetail_billDate;
				}
				var supplierBillDetail_mrnDate=dc.values['supplierBillDetail_mrnDate'];
				if(supplierBillDetail_mrnDate){
				supplierBillDetail_mrnDate	=formatDate2(supplierBillDetail_mrnDate);

				document.getElementById('supplierBillDetail_mrnDate').value=supplierBillDetail_mrnDate;
				}
				var pAmount=dc.values['supBillDetail_passedAmount'];
				if(pAmount){
				document.getElementById('supplierBillDetail_passedAmount').value=pAmount;
				var obj=document.getElementById('supplier_code1').value=dc.values['supplier_code'];
				}

				var poId=dc.values['worksDetail_id'];
				if(poId){
				//PageManager.DataService.setQueryField('supplierCode',dc.values['relation_id']);
				PageManager.DataService.setQueryField('worksDetail_code',dc.values['worksdetail_code']);
				PageManager.DataService.callDataService('AssetListMod');

				}

				var tab=dc.grids['gridSupplierJournal'];
				if(tab){
				var count1 = 0,count2=0;
				for(var i=1;i<tab.length;i++){
				count1 += parseFloat(tab[i][4]);
				count2 += parseFloat(tab[i][5]);
				}
				document.getElementById("debitTotal").value = count1;
				document.getElementById("creditTotal").value = count2;
				getNetamt();
				}
			 }
			}
   		function disableControls(frmIndex, isDisable){
			for(var i=0;i<document.forms[frmIndex].length;i++)
			{
				document.forms[frmIndex].elements[i].disabled =isDisable;
				if(PageManager.DataService.getQueryField('showMode')=='view' &&
					document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='backbutton')
					document.forms[frmIndex].elements[i].disabled =false;
				if(PageManager.DataService.getQueryField('showMode')=='modify'
						&& (document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='modGrid' ||
						 document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='reverseSubmit' ))
					document.forms[frmIndex].elements[i].disabled =false;
			}
		}
		function modify(){
				var cgn=PageManager.DataService.getQueryField('cgNumber');
		 		if(cgn){
		 			/*vGrid=document.getElementById('gridSupplierJournal').cloneNode(true);
		 			new_vGrid=document.body.appendChild(vGrid);
		 			new_vGrid.name= 'voucherDetailGridNew';
		 			new_vGrid.disabled=false;

		 			tGrid=document.getElementById('buttonTable').cloneNode(true);
		 			new_tGrid=document.body.appendChild(tGrid);
		 			new_tGrid.name= 'voucherDetailGridNew';
		 			new_tGrid.disabled=true;

		 			disableControls(0,false);
		 			document.getElementById('modGrid').style.display='none';
		 			document.getElementById('submitGrid').style.display='block';*/
		 			//document.getElementById ('text1').style.display ='block';
		 			document.getElementById('reverseRecord').style.display='block';
		 			var vcObj=document.getElementById('voucherHeader_newVcNo');
		 			vcObj.setAttribute('exilMustEnter','true');
		 			vcObj.disabled=false;
		 			var vdObj=document.getElementById('voucherHeader_effDate')
		 			vdObj.setAttribute('exilMustEnter','true');
		 			vdObj.disabled=false;
		 			document.getElementById('modeOfExec').value="modify";
		 			document.getElementById('reverseSubmit').style.display ="block";
		 	 	}
		}
		function hideButtons(){
			document.getElementById('modGrid').style.display='block';
			document.getElementById('submitGrid').style.display ="none";
			//document.getElementById ('text1').style.display ="none";
		}
		function loadFund(){
			var woId=document.getElementById("worksdetail_id").value;
			if(woId.length==null)return;
			PageManager.DataService.setQueryField('workOrderID',woId);
			PageManager.DataService.callDataService('workFundMap');
		}
		function loadFundSource(){
			var woId=document.getElementById("worksdetail_id").value;
			if(woId.length==null)return;
			PageManager.DataService.setQueryField('workOrderID',woId);
			PageManager.DataService.callDataService('workFundSourceMap');
		}
		function showglEntry()
		{
			hideColumn(0);
			/*if(!PageValidator.validateForm())
				return false;*/
			var gltable= document.getElementById("gridSupplierJournal");
			code=PageManager.DataService.getControlInBranch(gltable.rows[1],'chartOfAccounts_glCode').value;
			if(code)
			{
			PageManager.DataService.setQueryField("showGlEntries","show");
			PageManager.DataService.callDataService('supplierJournal');
			}
			else
			{
				alert("Enter Account code Details");
				return false;
			}
		}
		function showEntry()
		{
			var trObj;
			var tObj=document.getElementById("showEntries");
			var cr=parseFloat(0),dr=parseFloat(0);
			tObj.style.display="block";
			var tableObj=document.getElementById("entries");
			var gltable= document.getElementById("gridSupplierJournal");
			for(var i=tableObj.rows.length-1;i>=2;i--)
			{
				tableObj.deleteRow(i);
			}
			for(var i=1;i<gltable.rows.length;i++)
			{

				code=PageManager.DataService.getControlInBranch(gltable.rows[i],'chartOfAccounts_glCode').value;
				if(code)
				{
				name=PageManager.DataService.getControlInBranch(gltable.rows[i],'chartOfAccounts_name').value;
				debit=PageManager.DataService.getControlInBranch(gltable.rows[i],'voucherDetail_debitAmount').value;
				debit=isNaN(parseFloat(debit))?0:parseFloat(debit);
				dr=parseFloat(dr)+parseFloat(debit);
				credit=PageManager.DataService.getControlInBranch(gltable.rows[i],'voucherDetail_creditAmount').value;
				credit=isNaN(parseFloat(credit))?0:parseFloat(credit);
				cr=parseFloat(cr)+parseFloat(credit);
				narration=PageManager.DataService.getControlInBranch(gltable.rows[i],'voucherDetail_narration').value;
				var Obj=PageManager.DataService.getControlInBranch(tableObj.rows[1],"display_Code");
				trObj=PageManager.DataService.getRow(Obj);
				 if(i*1==1){
								newRow=trObj;
								objt1=PageManager.DataService.getControlInBranch(newRow,'display_Code');
				 				objt2=PageManager.DataService.getControlInBranch(newRow,'display_Head');
				 				objt3=PageManager.DataService.getControlInBranch(newRow,'display_Debit');
				 				objt4=PageManager.DataService.getControlInBranch(newRow,'display_Credit');
				 				objt5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
				 				if(code=="") code=" -"; if(name=="") name=" -"; if(debit=="") debit=" 0"; if(credit=="") credit=" 0"; if(narration=="") narration=" -";
				 				objt1.innerHTML=code;
				 				objt2.innerHTML=name;
				 				objt3.innerHTML=debit;
				 				objt4.innerHTML=credit;
								objt5.innerHTML=narration
				 }else{

						 var newRow=trObj.cloneNode(true);
						newRow=tableObj.tBodies[0].appendChild(newRow);
						objt1=PageManager.DataService.getControlInBranch(newRow,'display_Code');
						objt2=PageManager.DataService.getControlInBranch(newRow,'display_Head');
						objt3=PageManager.DataService.getControlInBranch(newRow,'display_Debit');
						objt4=PageManager.DataService.getControlInBranch(newRow,'display_Credit');
						objt5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
						if(code=="") code=" -"; if(name=="") name=" -"; if(debit=="") debit=" 0"; if(credit=="") credit=" 0"; if(narration=="") narration=" -";
						objt1.innerHTML=code;
						objt2.innerHTML=name;
						objt3.innerHTML=debit;
						objt4.innerHTML=credit;
						objt5.innerHTML=narration;
				}
			  }
			}
			var iRow=glNameCode.split(";");
			var rowContents=null;tempObj=null;
			for(var i=1;i<(iRow.length)-1;i++)
			{
				rowContents=iRow[i].split("^");
				var newRow=trObj.cloneNode(true);
				newRow=tableObj.tBodies[0].appendChild(newRow);
				tempObj1=PageManager.DataService.getControlInBranch(newRow,'display_CodeType');
				tempObj1.innerHTML=rowContents[0];
				tempObj2=PageManager.DataService.getControlInBranch(newRow,'display_Code');
				tempObj2.innerHTML=rowContents[1];
				tempObj3=PageManager.DataService.getControlInBranch(newRow,'display_Head');
				tempObj3.innerHTML=rowContents[2];
				tempObj5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
				tempObj5.innerHTML=" -";

			}
			if(isNaN(parseFloat(document.getElementById('supplierBillDetail_passedAmount').value)))
			passedAmount=0;
			else
			passedAmount=parseFloat(document.getElementById('supplierBillDetail_passedAmount').value);

			if(isNaN(parseFloat(document.getElementById('worksDetail_adjustmentAmount').value)))
			adjAmt=0;
			else
			adjAmt=	parseFloat(document.getElementById('worksDetail_adjustmentAmount').value);

			//totalamount=(parseFloat(passedAmount)-parseFloat(cr)-parseFloat(adjAmt));
			totalamount=(parseFloat(passedAmount)-parseFloat(cr));

			for(var i=1;i<tableObj.rows.length;i++)
			{
				var typeObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_CodeType");
				var type=typeObj.innerHTML;
				if(type =='SupAdvCode')
				{
					var trObj=PageManager.DataService.getRow(typeObj);
					col1=PageManager.DataService.getControlInBranch(trObj,'display_Credit');
					col1.innerHTML=adjAmt;
					col2=PageManager.DataService.getControlInBranch(trObj,'display_Debit');
					col2.innerHTML="0";
					totalamount=(parseFloat(passedAmount)-parseFloat(cr)-parseFloat(adjAmt));
					if(adjAmt*1==0)
						tableObj.rows[i].style.display='none';
				}
			}
			
			for(var i=1;i<tableObj.rows.length;i++)
			{
				var typeObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_CodeType");
				var type=typeObj.innerHTML;
				if(type =='SupPayCode')
				{
					var trObj=PageManager.DataService.getRow(typeObj);
					col1=PageManager.DataService.getControlInBranch(trObj,'display_Credit');
					col1.innerHTML=totalamount;
					col2=PageManager.DataService.getControlInBranch(trObj,'display_Debit');
					col2.innerHTML="0";
				}
			}

			
			 var dSum=0;
			 var cSum=0;
			for(var i=1;i<tableObj.rows.length;i++)
			{

			  var dObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_Debit");
			  var cObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_Credit");
			 if(!isNaN(parseFloat(dObj.innerHTML)))
			 {
			   var sum=(parseFloat(dObj.innerHTML));
			   dSum=parseFloat(dSum)+parseFloat(sum);
			 }
			 if(!isNaN(parseFloat(cObj.innerHTML)))
			 {
			   var sum=(parseFloat(cObj.innerHTML));
			   cSum=parseFloat(cSum)+parseFloat(sum);
			 }
			}
			var newRow=trObj.cloneNode(true);
			newRow=tableObj.tBodies[0].appendChild(newRow);
			objt1=PageManager.DataService.getControlInBranch(newRow,'display_Code');
			objt2=PageManager.DataService.getControlInBranch(newRow,'display_Head');
			objt3=PageManager.DataService.getControlInBranch(newRow,'display_Debit');
			objt4=PageManager.DataService.getControlInBranch(newRow,'display_Credit');
			objt5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
			objt1.innerHTML=" ";
			objt2.innerHTML=" ";
			objt3.innerHTML=dSum;
			objt4.innerHTML=cSum;
			objt5.innerHTML=" ";

	}

	function hideColumn(index)
	{
		var table=document.getElementById('entries');
	   	for(var i=0;i<table.rows.length;i++){
			table.rows[i].cells[index].style.display="none";
	   	}
	}
function getpamt(obj)
{
	if(obj.value==null || obj.value=="")return;
	var osAmt=document.getElementById("worksDetail_outstandingAmount").value;
	osAmt=isNaN(osAmt)?0:osAmt;
	osAmt=new Number(osAmt);
	var billAmt=document.getElementById("supplierBillDetail_billAmount").value;
	billAmt=isNaN(billAmt)?0:billAmt;
	billAmt=new Number(billAmt);
	if(billAmt>osAmt)
	{
	   alert("Bill Amount Cannot be greater than Outstanding Amount..");
	   document.getElementById("supplierBillDetail_billAmount").value=0;
	   return false;
	}
	
	var pasedAmt=document.getElementById('supplierBillDetail_passedAmount').value;
	if(pasedAmt==null || pasedAmt=="")
       document.getElementById('supplierBillDetail_passedAmount').value=obj.value;
}

//Added By Lakshmi
function chkAmount()
{
	var adjstAmt=document.getElementById("worksDetail_adjustmentAmount").value;
	if(adjstAmt==null || adjstAmt=="") document.getElementById("worksDetail_adjustmentAmount").value=new Number(0);
	else if(isNaN(adjstAmt))
	{
	   alert("Enter Only Numbers!!!...");
	   document.getElementById("worksDetail_adjustmentAmount").selected();
	   return false;
	}
	var advAmt=document.getElementById("worksDetail_advanceAmount").value;
	advAmt=isNaN(advAmt)?0:advAmt;
	adjstAmt=new Number(adjstAmt);
	advAmt=isNaN(advAmt)?0:advAmt;
	advAmt=new Number(advAmt);
	if(adjstAmt>advAmt)
	{
	   alert("Adjustment Amount Cannot be greater than Advance Amount");
	   document.getElementById("worksDetail_adjustmentAmount").focus();
	   return false;
	}
	var passedAmt=document.getElementById("supplierBillDetail_passedAmount").value;
	passedAmt=isNaN(passedAmt)?0:passedAmt;
	passedAmt=new Number(passedAmt);
	var billAmt=document.getElementById("supplierBillDetail_billAmount").value;
	billAmt=isNaN(billAmt)?0:billAmt;
	billAmt=new Number(billAmt);

	if(billAmt<passedAmt)
	{
	   alert("Passed Amount Cannot be greater than Bill Amount..");
	  // document.getElementById("contractorBillDetail_passedAmount").focus();
	   return false;

	}
	getNetamt();
}
function getNetamt()
{
	passedAmt=parseFloat(document.getElementById('supplierBillDetail_passedAmount').value);
	passedAmt=isNaN(passedAmt)?0:passedAmt;
	adjustAmt=parseFloat(document.getElementById("worksDetail_adjustmentAmount").value);
	adjustAmt=isNaN(adjustAmt)?0:adjustAmt;

	var netPay=0;
	var credit=document.getElementById("creditTotal").value;
	credit=isNaN(parseFloat(credit))?0:parseFloat(credit);

	netAmt=passedAmt-credit;
	if(netAmt<0)
	{
	   alert("Deductions Cannot be more than Passed Amount");
	  // document.getElementById("contractorBillDetail_passedAmount").focus();
	   //return false;

	}
	else if(netAmt<adjustAmt)
	{
	 	alert("Cannot Adjust Amount: "+adjustAmt);
	}
	document.getElementById("worksDetail_NetAmount").value=netAmt-adjustAmt;
}


/*
	We implement AJAX here. The remaining functions are present in script/jsCommonMethods.js.
	Whenever user enters some value this function will be triggered.
*/

  // VALIDATION FOR FUNCTION NAME CODE
   function autoCompletion1(obj) {
   		var menu=document.getElementById("menu-popup");
		menu.style.setAttribute("left", "0px");
      	var row,nameCell;
      	  	var currRow=PageManager.DataService.getRow(obj);
			var size=codeArray.length-1;
		   	if(codeArray != null)
		   	{
		   		//keyCodes Values
		   		//13 - enter, 8 - backspace, 46 - delete, 40 - down arrow, 38 - up arrow
		   		if(event.keyCode == 13)
		   		{
		   		 getFunId(event);
		   		 return false;
		      		}
		      		if((event.keyCode == 8) || (event.keyCode == 46))
		   			k=-1;
		      		while(event.keyCode == 40 && codeArray[0] != null)	{
		      		if(size<(k+1))
					{
						k=-1;
					}
		      			k++;
		      			PageManager.DataService.getControlInBranch(currRow,'function_code').value=codeArray[k];
						//alert(codeArray[k]);
		      			return false;
		      			}
		     		while(event.keyCode == 38 && codeArray[0] != null)	{
		      		if(k==-1)
						{
							return false;
						}
					if(k==0)
						{
							k=size+1;
						}
	     		     k--;
		       	 	PageManager.DataService.getControlInBranch(currRow,'function_code').value=codeArray[k];
		       	 	//alert(codeArray[k]);
	        	 	return false;
		     			}
      }

        function_code=PageManager.DataService.getControlInBranch(currRow,'function_code').value;
   		var type='functionName';
          if (function_code == "") {
              clearTable(document.getElementById("completeTable"));
          } else {
               var url = "../commons/Process.jsp?type=" +type+ "&name=" + function_code+ " ";
	           	var req2 = initiateRequest();
              req2.onreadystatechange = function() {
                  if (req2.readyState == 4) {
                      if (req2.status == 200) {
                      	var codes2=req2.responseText;
                      	paintCodes(codes2,document.getElementById("auto-row"),document.getElementById("menu-popup"),document.getElementById("completeTable"));
                      	  	}
                      	  	else {

                          clearTable(document.getElementById("completeTable"));
                      }
                  }
              };
                   req2.open("GET", url, true);
                   req2.send(null);
          }
   }

// VALIDATION FOR ACCOUNT CODE
function autoCompletion2(obj) {
var menu=document.getElementById("menu-popup");
menu.style.setAttribute("left", "150px");
   	var row,nameCell;
  	var currRow=PageManager.DataService.getRow(obj);
	var size=codeArray.length-1;
	if(codeArray != null)
	{
		//keyCodes Values
		//13 - enter, 8 - backspace, 46 - delete, 40 - down arrow, 38 - up arrow

		if(event.keyCode == 13)
		{
			 getAccName(event);
			return false;
   		}
   		if((event.keyCode == 8) || (event.keyCode == 46))
			j=-1;
   		while(event.keyCode == 40 && codeArray[0] != null)	{
   			if(size<(j+1))
			{
			   j=-1;
			 }
		   	j++;
   			PageManager.DataService.getControlInBranch(currRow,'chartOfAccounts_glCode').value=codeArray[j];
   			//alert(codeArray[j]);
  			return false;
   			}
  		while(event.keyCode == 38 && codeArray[0] != null)	{
   			if(j==-1)
			{
				return false;
			}
			if(j==0)
			{
				j=size+1;
			}
	   		 j--;
    	 	PageManager.DataService.getControlInBranch(currRow,'chartOfAccounts_glCode').value=codeArray[j];
    	 	//alert(codeArray[j]);
     	 	return false;
  			}
   }

      chartOfAccounts_glCode=PageManager.DataService.getControlInBranch(currRow,'chartOfAccounts_glCode').value;
		var type='coaDetailCode';
       if (chartOfAccounts_glCode == "") {
           clearTable(document.getElementById("completeTable"));
       } else {
                   var url = "../commons/Process.jsp?type=" +type+"&glCode=" + chartOfAccounts_glCode+ " ";
          	var req = initiateRequest();
           req.onreadystatechange = function() {
               if (req.readyState == 4) {
                   if (req.status == 200) {
                   	var codes=req.responseText;
                    paintCodes(codes,document.getElementById("auto-row"),document.getElementById("menu-popup"),document.getElementById("completeTable"));
                   	}
                    else {

                       clearTable(document.getElementById("completeTable"));
                   }
               }
           };
                req.open("GET", url, true);
                req.send(null);
       }
   }




  /* function setWorkCode()
   {
	  alert('setWorkCode=');
	   var obj=document.getElementById("worksDetail_name");
	   var arr;
	   if(wIndex!=null)
	   	{
	   			document.forms[0].worksDetail_name.options[wIndex]= new Option(wText,wValue);
		}
	   	document.getElementById("fundsource_name").value="";
	   	document.getElementById("fundsource_id").value="";
	   	document.getElementById("fund_name").value="";
	   	document.getElementById("fund_id").value="";
		document.getElementById("worksDetail_adjustmentAmount").value="";
	   arr=obj.options[obj.selectedIndex].innerHTML.split("`-`");
	   document.getElementById("worksDetail_code").value=arr[1];
	   obj.options[obj.selectedIndex].text=arr[0];
	   document.getElementById("worksDetail_id").value=obj.options[obj.selectedIndex].value;
	   wIndex=obj.selectedIndex;
	   wValue=obj.options[obj.selectedIndex].value;
	   wText=arr[0]+"`-`"+arr[1];
	   loadWorkOrderData(obj.options[obj.selectedIndex].value);
	   var wCode=document.getElementById("worksDetail_code").value;
		PageManager.DataService.setQueryField('worksDetail_code',wCode);
		PageManager.DataService.callDataService('AssetListMod');
}*/
	function setWorkCode()
    {
	  //alert('setWorkCode=');
	   var obj=document.getElementById("worksDetail_name");
	   var arr;
	   	document.getElementById("fundsource_name").value="";
	   	document.getElementById("fundsource_id").value="";
	   	document.getElementById("fund_name").value="";
	   	document.getElementById("fund_id").value="";
		document.getElementById("worksDetail_adjustmentAmount").value="";
	   loadWorkOrderData(document.getElementById("worksDetail_id").value);
	   var wCode=document.getElementById("worksDetail_code").value;
		PageManager.DataService.setQueryField('worksDetail_code',wCode);
		PageManager.DataService.callDataService('AssetListMod');
}

function autoCompletionSupList(obj) {
	var menu=document.getElementById("menu-popup");
	menu.style.setAttribute("left", "430px");
	// var row,nameCell;
	//var currRow=PageManager.DataService.getRow(obj);
	if(codeArray != null)
	{
		//keyCodes Values
		//13 - enter, 8 - backspace, 46 - delete, 40 - down arrow, 38 - up arrow
		if(event.keyCode == 13)
		{
			 var arr=document.getElementById('supplier_name').value.split("`-`");
			 document.getElementById('supplier_name').value=arr[0];
			 document.getElementById('supplier_code1').value=arr[1];
			 getAccName(event);
			 return false;
   		}
   		if((event.keyCode == 8) || (event.keyCode == 46))
			j=-1;
   		while(event.keyCode == 40 && codeArray[0] != null)
   		{
   			j++;
   		   	document.getElementById('supplier_name').value=codeArray[j];
  			return false;
   		}
  		while(event.keyCode == 38 && codeArray[0] != null)
  		{
   			j--;
    	 	document.getElementById('supplier_name').value=codeArray[j];
    	 	return false;
  		}
   }
     conName=document.getElementById('supplier_name').value
      var type='supplierName';
       if (conName == "") {
           clearTable(completeTable);
       } else {
            var url = "../commons/Process.jsp?type=" +type+"&name=" + conName+ " ";
          	var req = initiateRequest();
           req.onreadystatechange = function() {
               if (req.readyState == 4) {
                   if (req.status == 200) {
                   	var codes=req.responseText;
                      paintCodes(codes,document.getElementById("auto-row3"),document.getElementById("menu-popup"),document.getElementById("completeTable"));
                     } else {
                       clearTable(completeTable);
                   }
               }
           };
           req.open("GET", url, true);
           req.send(null);
       }
   }

function getRelationId()
{
	splitConCode();
	code=document.getElementById('supplier_code1').value;
	document.getElementById('relation_id').value="";
	if (code=='') return;
		PageManager.DataService.setQueryField('relation_code',code);
	PageManager.DataService.callDataService('getRelationIdFromCode');
	document.getElementById('worksDetail_code').value="";
}
function splitConCode()
{
//alert("hi");
 var arr=document.getElementById('supplier_name').value.split("`-`");
							if(arr[1]==null){  return  }
							else{
								document.getElementById('supplier_name').value=arr[0];
								document.getElementById('supplier_code1').value=arr[1];
								//getAccName(event);
								 return false;
								}
}
		 function fillNeibrAfterSplit(obj,neibrObjName)
		 {
			var currRow=PageManager.DataService.getRow(obj);
			neibrObj=PageManager.DataService.getControlInBranch(currRow,neibrObjName);
			yuiflag[currRow.rowIndex] = undefined;
			var temp = obj.value; temp = temp.split("`-`");
			obj.value=temp[0];
			if(temp[1]==null) return; else 	neibrObj.value = temp[1];
		 }



        </SCRIPT>
	</head>
	<body onLoad="onBodyLoad();" onKeyDown ="CloseWindow(event);" bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0"
		 marginheight="0" marginwidth="0" ><!------------------ Header Begins Begins--------------------->
		<form name="supplierJournal">

		<input  type="hidden" id="glCode" name="glCode">
		<input type="hidden" name="budgetCheckRequired" id="budgetCheckRequired" value="true">
		<!-- <input type="hidden" id="worksDetail_totalValue" name="worksDetail_totalValue">
		<input type="hidden" id="worksDetail_totalPassedAmount" name="worksDetail_totalPassedAmount" > -->
		<input type="hidden" id="relation_id" name="relation_id" >
		<input type="hidden" id="supplier_code" name="supplier_code" >
		<input type="hidden" name="tType" id="tType" value="J">
		<input type="hidden" name="cgnNum" id="cgnNum">
		<input type="hidden" name="modeOfExec" id="modeOfExec" value="new">
		<input type="hidden" name="voucherHeader_id" id="voucherHeader_id">
		<input type="hidden" name="databaseDate" id="databaseDate">
		<input type="hidden" name="oldVoucherDate" id="oldVoucherDate">


			<table align=center  width="100%" border="0" cellpadding="0" cellspacing="0" id=TABLE1 style="display:none">
				<tr>
					<td valign="top" class="normaltext"><!------------Content begins here ------------------>
						<tr><td id="auto-row3">&nbsp;<td width="0"/></tr>
                                    </td></tr></table>

						<table width="100%" border="0" cellpadding="3" cellspacing="0" id="TABLEM">
							<TBODY>
								<tr >
									<td width="20%" align="right" valign="center" id="cgnLabel" name="cgnLabel" style="DISPLAY: none"><div class="labelcell" align="right">CG Number&nbsp;&nbsp;</div>
									</td>
									<td width="40%"  id="cgnText" name="cgnText" style="DISPLAY: none" >
										<span class="fieldcell"><input name="voucherHeader_cgn" class="fieldinput" id="voucherHeader_cgn" maxlength="10" readOnly exilDataType="exilAlphaNumeric" exilMustEnter="true" SIZE="20" ></span>
									</td>
									<td  width="20%" align="right" valign="center"><div class="labelcell" align="right">Voucher Number<span class="leadon">*</span></div>
									</td>
									<td width="20%" ><table cellpadding="0" cellspacing="0"><tr>
											<td><span class="smallfieldcell"><input  type=text readonly style="WIDTH:25px; HEIGHT: 20px" maxlength="2" name="vnum" id="vnum" style="display:none"></span></td>
											<td><span  class=smallfieldcell><input class="smallfieldcell" name="voucherHeader_voucherNumber" id="voucherHeader_voucherNumber" maxlength="10"  exilDataType="exilAlphaNumeric" exilMustEnter="true" size="20" style="width:120px"></span></tr></table>
									</td>
								</td>
								</tr>
				<tr >

					<td align="right" valign="center" ><div class="labelcell" align="right">Supplier Name<span class="leadon">*</span></div></td>
					<td>
					<!--	<select name="supplier_name" class="combowidth2 id="supplier_name" maxlength="50" onChange="displayCode()"  exilMustEnter="true"  ></select>-->
						<span class=smallfieldcell><input  style="width:300px" id="supplier_name" name="supplier_name" autocomplete="off"  onkeyup="autocompleteSupList(this);"  maxlength="20" style=" HEIGHT: 22" size="19" onBlur="getRelationId()" ></span>
						<IMG id=IMG2 onclick="openSearch(this, 'relation','')" height=22 src="/egi/resources/erp2/images/plus1.gif" width=25 align=top border=0  >
						<span class=smallfieldcell><input  class="fieldcell" name="supplier_code1" id="supplier_code1"   readOnly SIZE="17"  tabindex=-1></input></span>
                    </td>

					<td align="right" valign="center" class="normaltext"><div class="labelcell"  align="right">Voucher Date<span class="leadon">*</span></div></td>
					<td ><span class="smallfieldcell">
                    <input name="voucherHeader_voucherDate" class="smallfieldcell" id="voucherHeader_voucherDate" maxlength="11" onkeyup="DateFormat(this,this.value,event,false,'3')" exilMustEnter="true" exilDataType="exilAnyDate" exilCalendar="true" SIZE="20" ></span></td>
				</tr>

				<tr >
					<td align="right" valign="center" ><div class="labelcell" align="right">Purchase Order<span class="leadon">*</span></div>
					</td>
					<!-- <td>
							<span class=smallfieldcell><select name="worksDetail_name"  class="combowidth2" id="worksDetail_name" exilListSource="conBillDetail_worksDetailID"
									 onChange="setWorkCode()"  exilMustEnter="true">
							</select></span>
							<span class=smallfieldcell><input  name="worksDetail_code" id="worksDetail_code"   readOnly SIZE="26" tabindex=-1 ></input></span>
							<input type="hidden" name="worksDetail_id" id="worksDetail_id">
					</td> -->
					<td>
						<table border=0>
							<tr>
								<td rowspan=2><span  class=fieldcell><TEXTAREA class=narrationfieldinput
									id=worksDetail_name name=worksDetail_name rows=1 cols=20 maxlength=250
									exilDataType="exilAnyChar" readonly exilMustEnter="true" tabindex=-1></TEXTAREA></span></td>
								<td><IMG id=IMG1 onclick="openSearch2(this, 'WorksDetail')" height=22 src="/egi/resources/erp2/images/plus1.gif" width=25 align=top border=0  tabIndex=0>
								<span  class=fieldcell><input  name="worksDetail_code" id="worksDetail_code" tabindex=-1 readOnly size="18" ></input></span>
								<input type='hidden'  name="worksDetail_id" id="worksDetail_id"  ></input>
								</td>
							</tr>
						</table>
					</td>

					<td align="right" valign="center" class="normaltext"><div class="labelcell"  align="right">PO Date<span class="leadon">*</span></div></td>
					<td ><span class="smallfieldcell">
                    <input class=smallfieldcell name="worksDetail_orderDate" class="datefieldinput" id="worksDetail_orderDate" maxlength="11" readOnly tabindex=-1 onkeyup="DateFormat(this,this.value,event,false,'3')"

            exilMustEnter="true" SIZE="20" tabindex=-1></span></td>
				</tr>


				<tr >
					<td align="right" valign="center" ><div class="labelcell" align="right">Fund</div></td>
					<td ><input type="hidden" id="fund_id" class="fieldinput" name="fund_id">
                    <span class="fieldcell"><input id="fund_name" class="labelcell" name="fund_name" tabindex=-1 readOnly size="20" tabindex=-1></span>
					</td>
					<td></td>
					<td></td>
				<!--	<td align="right" valign="center" class="normaltext"><div align="right">Function<span class=leadon
				<td></td>

					           >*</span></div>
					</td>
					<td>
                    <SELECT id="department_id" class="fieldinput" name="department_id" exilMustEnter="true" exilListSource="departmentNameList"></SELECT></td></TD>
                   -->
					<!-- <td width="11%" ><div align="right" valign="center" class="normaltext">
						Asset</div></td>
					<td width="190" >
                    <select name="asset_name" class="combowidth1" id="asset_name" maxlength="50" exilListSource="selected_Asset"
 ></select>
					</td>
					-->
				</tr>
				<tr >
					<td align="right"><span align="right" valign="center" class="labelcell">Total Value of PO</span></td>
					<td nowrap><span  class=fieldcell><input id="worksDetail_totalValue" name="worksDetail_totalValue" tabindex=-1 class="fieldinput-right" readOnly></span>
					<span valign="center" style="font:  11px Verdana, Geneva, Arial, Helvetica, sans-serif;background-color: transparent;color: #3670A7;width=50px">Billed Amount</span>
					<span  class=fieldcell2>
					<input name="worksDetail_totalPassedAmount"  id="worksDetail_totalPassedAmount" tabindex=-1 exilDataType="exilUnsignedDecimal"  readOnly style="width:100px;height:20px;text-align:right"></span></td>
					<td align="right"><span align="right" valign="center" class="labelcell">Outstanding Amount</span></td>
					<td ><span  class=fieldcell><input id="worksDetail_outstandingAmount" name="worksDetail_outstandingAmount" tabindex=-1 class="fieldinput-right" readOnly></span>
				</tr>
					
				<tr >
				<td align="right" valign="center" class=""><div class="labelcell" align="right">Financing Source</div></td>
					<td><input type="hidden" id="fundSource_id" class="labelcell" name="fundSource_id"><span class="fieldcell"><input id="fundSource_name" tabindex=-1 class="fieldinput" name="fundSource_name" readOnly SIZE="20" tabindex=-1></span>
					</td>
                   <td align="right" valign="center" class="normaltext"><div class="labelcell"  align="right">Advance Outstanding</div>
					</td>
					<td ><span class="fieldcell">
					<INPUT class=fieldinput-right id="worksDetail_advanceAmount" name="worksDetail_advanceAmount"
            			readOnly exilDataType="exilUnsignedDecimal" SIZE="20" tabindex=-1></span>
					</td>
				</tr>

				<tr >
					<td align="right" valign="center" ><div class="labelcell" align="right">MRN Number</div>
					</td>
					<td><span class="fieldcell">
						<input name="supplierBillDetail_mrnNumber" class="fieldinput" id="supplierBillDetail_mrnNumber"  maxlength="10" exilDataType="exilAnyChar" SIZE="20"></span>
					</td>
					<td align="right" valign="center" class="normaltext"><div class="labelcell"  align="right">Bill Amount<span class="leadon">*</span></div>
					</td>
					<td ><span class="fieldcell">
						<input name="supplierBillDetail_billAmount" class="fieldinput-right" id="supplierBillDetail_billAmount"  maxlength="16" onBlur="getpamt(this)" exilDataType ="exilUnsignedDecimal" exilMustEnter="true" exilMax="999999.99" exilMin="1" SIZE="20"></span>
					</td>
				</tr>
				<tr >
					<td align="right" valign="center" ><div class="labelcell" align="right">MRN Date</div>
					</td>
					<td><span class="smallfieldcell">
                    <input name="supplierBillDetail_mrnDate" class="datefieldinput" id="supplierBillDetail_mrnDate" maxlength="11" onkeyup="DateFormat(this,this.value,event,false,'3')"  exilDataType="exilAnyDate" exilCalendar="true" SIZE="20"></span></td>
					<td align="right" valign="center" class="normaltext"><div class="labelcell" align="right">
						Passed Amount<span class="leadon">*</span></div>
					</td>
					<td ><span class="fieldcell">
						<input name="supplierBillDetail_passedAmount" class="fieldinput-right" id="supplierBillDetail_passedAmount"
           			 maxlength="16" tabindex=- 1 exilDataType="exilUnsignedDecimal" exilMustEnter="true" exilMax="999999.99" exilMin="0" onblur="chkAmount()" SIZE="20"></span>
					</td>

				</tr>


				<tr >
					<td align="right" valign="center" ><div class="labelcell"  align="right">Bill Number</div>
					</td>
					<td ><span class="fieldcell">
						<input name="supplierBillDetail_billNumber" class="fieldinput" id="supplierBillDetail_billNumber" maxlength="10"  style="LEFT: 3px; TOP: 19px"
            			exilDataType="exilAnyChar" SIZE="20"></span>
					</td>
					<td align="right" valign="center" class="normaltext"><div class="labelcell" align="right">Adjustment Amount</div>
					</td>
					<td ><span class="fieldcell">
						<INPUT class=fieldinput-right id="worksDetail_adjustmentAmount" name="worksDetail_adjustmentAmount"  exilDataType="exilUnsignedDecimal" maxlength="16" onblur="chkAmount()" SIZE="20"></span>
					</td>

				</tr>
				<tr >
					<td align="right" valign="center" class="normaltext"><div class="labelcell" align="right">Bill Date</div>
					</td>
					<td ><span class="smallfieldcell">
                    <input name="supplierBillDetail_billDate" class="datefieldinput" id="supplierBillDetail_billDate"  maxlength="11" onkeyup="DateFormat(this,this.value,event,false,'3')" exilDataType="exilAnyDate" exilCalendar="true" SIZE="20"></span></td>
					<td align="right" valign="center" class="normaltext"><div class="labelcell" align="right">
						Net Payable</div>
					</td>
					<td ><span class="fieldcell">
					<INPUT class=fieldinput-right id="worksDetail_NetAmount" name="worksDetail_NetAmount" readOnly SIZE="20" tabindex=-1></span>
					</td>
				</tr>
				<tr >
					<td align="right" valign="center"><div class="labelcell" align="right">Narration</div>
					</td>
					<td ><span class=fieldcell><TEXTAREA class=narrationfieldinput onkeypress="return checkNarration(this)"  id=narration name=voucherHeader_narration rows=1 exilDataType="exilAnyChar"></TEXTAREA></span>
					</td>
                    <td align="right" valign="center" class="normaltext"><div class="labelcell" align="right">
						Approved By<SPAN class=leadon>*</SPAN> </div>
					</td>
					<td ><span class="fieldcell">
						<INPUT class=fieldinput id="supplierBillDetail_approvedBy" name="supplierBillDetail_approvedBy"  maxlength="25" exilDataType="exilAnyChar" exilMustEnter="true" SIZE="20"></span>
					</td>

				</tr>
				<tr  id="statusInfo">
						<td id="statusLabel"><div  class="labelcell" align="right" valign="center" class="normaltext">Status</div></td>
						  <td id="StatusText" ><span class="fieldcell">
							<input class="labelcell" name="voucherHeader_status" id="voucherHeader_status" SIZE="20" readonly></span>
						</td>
						 <td><div  class="labelcell" align="right" valign="center" class="normaltext" exilMustEnter="true">Created By</div></td>
						 <td ><span class="fieldcell"><input class="labelcell" name="voucherHeader_createdby" id="voucherHeader_createdby" SIZE="20" readonly></span></td>
				</tr>
				<tr><!--<td align="right" valign="center" class="normaltext"><div align="right">TDS Amount</div>
					</td>
					<td><INPUT class=fieldinput-right id="worksDetail_tdsAmount" name="worksDetail_tdsAmount"
							 readOnly exilDataType="exilUnsignedDecimal">
					</td>
					<td align="right" valign="center" class="normaltext"><div align="right">&nbsp;</div>
					</td>
					<td class="fieldinput">
						<INPUT id="supplier_tds" name="supplier_tds" type="hidden">

					</td>-->
				</tr><!--New code
				<tr >
					<td colspan=4 align="left">
						<input type="button" onClick="showHide()" value="+" id="sh_button" name="sh_button" style="COLOR: red">
					</td>
				</tr>
				<tr >
					<td colspan=4>
						<table width="100%" border="0" cellpadding="3" cellspacing="0" id="otherRecovery">
								<tr >
									<td width="20%" align="right" valign="center" class="normaltext"><div align="right">Sales
                  Tax&nbsp;&nbsp;</div>
									</td>
									<td class="fieldinput">
										<input name="voucherHeader_cgn" class="fieldinput" id="voucherHeader_" maxlength="10" readOnly exilDataType="exilAlphaNumeric" exilMustEnter="true" >
									</td>
									<td  width="25%" align="right" valign="center" class="normaltext"><div align="right">IT</div>
									</td>
									<td  width="30%" class="fieldinput">
										<input name="it" class="fieldinput-left" id="it" maxlength="10" exilDataType="exilAlphaNumeric" exilMustEnter="true" >
									</td>
								</tr>
								<tr >
									<td width="20%" align="right" valign="center" class="normaltext"><div align="right">Royalty&nbsp;&nbsp;</div>
									</td>
									<td class="fieldinput">
										<input name="voucherHeader_cgn" class="fieldinput" id="voucherHeader_" maxlength="10" readOnly exilDataType="exilAlphaNumeric" exilMustEnter="true" >
									</td>
									<td  width="25%" align="right" valign="center" class="normaltext"><div align="right">Security Deposit</div>
									</td>
									<td  width="30%" class="fieldinput">
										<input name="it" class="fieldinput-left" id="it" maxlength="10" exilDataType="exilAlphaNumeric" exilMustEnter="true" >
									</td>
								</tr>
								<tr >
									<td width="20%" align="right" valign="center" class="normaltext"><div align="right">Retention
                  Money&nbsp;&nbsp;</div>
									</td>
									<td class="fieldinput">
										<input name="voucherHeader_cgn" class="fieldinput" id="voucherHeader_" maxlength="10" readOnly exilDataType="exilAlphaNumeric" exilMustEnter="true" >
									</td>
									<td  width="25%" align="right" valign="center" class="normaltext"><div align="right">Contribution to
                  Contractors</div>
									</td>
									<td  width="30%" class="fieldinput">
										<input name="it" class="fieldinput-left" id="it" maxlength="10" exilDataType="exilAlphaNumeric" exilMustEnter="true" >
									</td>
								</tr>
								<tr >
									<td width="20%" align="right" valign="center" class="normaltext"><div align="right">Advance&nbsp;Amount&nbsp;&nbsp;</div>
									</td>
									<td class="fieldinput">
										<input name="voucherHeader_cgn" class="fieldinput" id="voucherHeader_" maxlength="10" readOnly exilDataType="exilAlphaNumeric" exilMustEnter="true" >
									</td>
									<td  width="25%" align="right" valign="center" class="normaltext"><div align="right">Adjustment
Amount</div>
									</td>
									<td  width="30%" class="fieldinput">
										<input name="it" class="fieldinput-left" id="it" maxlength="10" exilDataType="exilAlphaNumeric" exilMustEnter="true" >
									</td>
								</tr>
						</table>
					</td>
				</tr><!--New code-->
		</table>
                               <table align=center width="100%" border="0" cellpadding="0" cellspacing="0" ID="gridTable">
                                  <tr>
                                    <td>
                                    <table align=center width="100%" border="1" cellpadding="0" cellspacing="0" ID="gridSupplierJournal">

                                     <tr class="rowheader">
                                        <td width="1%"  class="thStlyle">&nbsp;&nbsp;</td>
                                        <td width="15%"  class="thStlyle"><div align="center">Function Name</div></td>
                                        <td width="10%" height="34" class="thStlyle"><div align="center" >Account Code</div></td>
                                        <td width="30%" class="thStlyle"><div align="center">Account Head</div></td>
                                        <td width="7%" class="thStlyle"><div align="center">Debit Amount</div></td>
                                        <td width="7%" class="thStlyle"><div align="center">Credit Amount</div></td>
                                        <td width="25%" class="thStlyle" style="DISPLAY:none"><div align="center">Narration</div></td>
                                        <td width="5%" class="thStlyle"><div align="center">Details</div></td>
                                     </tr>
                                <tr class="smallfieldcell">
                                <td class="tdStlyle" width="1%"  onClick="changeColor(this,'gridSupplierJournal');" name="selectTd" id="selectTd"></td>
                                       <td>
                                       <input type="hidden" name="cv_fromFunctionCodeId" id="cv_fromFunctionCodeId">
                                       <input class="normaltext" size=10 name="function_code" id="function_code"   style=" HEIGHT:
                  19" value="" autocomplete="off" onkeyup="autocompletefuncName(this);"  exilDescField="cv_fromFunctionCodeId" exilDataSource="functionIdKey"  onBlur="fillNeibrAfterSplit(this,'cv_fromFunctionCodeId');funClear(this, 'chartOfAccounts')" exilInGrid="true">
                  <IMG   id=IMG1 onclick=openSearch1(this,'function')
                  height=22 src="/egi/resources/erp2/images/plus1.gif" width=25 align=top border=0 >
										</td>
                                        <td >
                                        	<INPUT class=fieldinput-right   id="chartOfAccounts_glCode" name="chartOfAccounts_glCode"  value="" autocomplete="off" onkeyup="autocompletecode(this);" onBlur="fillNeibrAfterSplit(this,'chartOfAccounts_name')" maxlength="20" style="WIDTH: 75; HEIGHT: 21"  exilDataType
                  ="exilAlphaNumeric"

                  exilInGrid="true"><IMG id=IMG2 onclick="openSearch(this,'chartOfAccounts')" height=22 src="/egi/resources/erp2/images/plus1.gif" width=25 align=top border=0 >
                                        </td>
                                        <td >
											<INPUT class="" id=chartOfAccounts_name maxlength="50"   name=chartOfAccounts_name readOnly exilDataType="exilAnyChar" tabindex=-1 style="width:300px;">
                                        </td>
                                        <td class="columnheader">
	                                        <INPUT class=fieldinput-right id="voucherDetail_debitAmount" name="voucherDetail_debitAmount"  maxlength="16" style="WIDTH: 90px; HEIGHT: 19px" size   =4 onBlur="colTotal(this,'debitTotal');chkAmount();" exilDataType="exilUnsignedDecimal" exilMax="999999.99" exilMin="0">
                                        </td>
                                        <td class="columnheader">
                                        	<INPUT class=fieldinput-right id="voucherDetail_creditAmount" name="voucherDetail_creditAmount"  maxlength="16" style="WIDTH: 90px; HEIGHT: 19px" size   =3 onBlur="colTotal(this,'creditTotal');chkAmount();" exilDataType="exilUnsignedDecimal" exilMax="999999.99" exilMin="0" onKeyDown="addNewRow('gridSupplierJournal','chartOfAccounts_glCode')" >
                                        </td>
                                        <td class="columnheader" style="DISPLAY:none">
                                        	<input class="fieldinput-left" id="voucherDetail_narration" name="voucherDetail_narration"  style="WIDTH: 164px; HEIGHT: 19px" size =12 onKeyPress="return checkNarration(this)" exilDataType="exilAnyChar">
										</td>
										 <td><A  id=A1 style="WIDTH: 10px; HEIGHT: 19px" onclick ="openDetails(this,'chartOfAccounts_glCode','supplierjournal','entities_grid','')" 	 href="#"  >Click</A>
           								 </td>
                                       </tr>


                                       </table>


					<table>
							<tr>

								<td colspan="2" align="center"><input type="button"  class="button"  value="Delete Row" id="deleteDetail" name="deleteDetail" onclick=" deleteRowTable('gridSupplierJournal');colAllTotal('voucherDetail_debitAmount','voucherDetail_creditAmount','debitTotal','creditTotal');" /></td>
								<td colspan="2" align="center"><input type="button"  class="button"  value="Add Row" id="addDetail" name="addDetail" onclick="addNewRowFromButton('gridSupplierJournal','chartOfAccounts_glCode,chartOfAccounts_name');" /></td>
							</tr>
					</table>



					<div id="codescontainer"></div>
					<div id="functioncontainer"></div>

                  <table width="100%" border="0" cellpadding="0" cellspacing="0" ID="buttonTable">
                  <tr>
                  <td>
					<table align=center width="100%" border="1" cellpadding="0" cellspacing="0" ID="buttonInTable">
					<!--<tr >
						<td width="20%" class="normaltext" align=right>&nbsp;</td>
                        <td width="25%" class="normaltext" align=right>Total</td>
                        <td width="15%" class="columnheader"><INPUT class=fieldinput-right id="debitTotal" name="debitTotal" style="BORDER-RIGHT: thin; BORDER-TOP: thin; BORDER-LEFT: thin; WIDTH: 102px; BORDER-BOTTOM: thin; HEIGHT: 15px" disabled size=8 ></td>
                        <td width="15%" class="columnheader"><input class="fieldinput-right" size=8 id="creditTotal" name="creditTotal" disabled style="BORDER-RIGHT: thin; BORDER-TOP: thin; BORDER-LEFT: thin; WIDTH: 103px; BORDER-BOTTOM: thin; HEIGHT: 15px"
                 ></td>
						<td width="25%" class="columnheader"></td>
						<td width="25%" class="columnheader"></td>
                    </tr>-->
						<tr  class=labelcell3>			<td width="18%">
                                        	<span       style="WIDTH: 130px; HEIGHT: 19px" size   ="14" id=SPAN1></span>
                                         </td>
                                        <td width="18%">
                                        	<span       style="WIDTH: 120px; HEIGHT: 19px" size   ="14" id=SPAN1></span>
                                         </td>
                                        <td width="40%" align="right">
											<span     class="normaltext"
            style="WIDTH: 300px; HEIGHT: 19px" id=SPAN1
                 >Total&nbsp;</span>
                                        </td>
						                <td width="9%" ><span class="smallfieldcell">
						 	               <INPUT class=fieldcellamount style="WIDTH: 89; HEIGHT: 19" id="debitTotal" name="debitTotal" readOnly SIZE="20" tabindex=-1></span>
						                 </td>
						                 <td  width="9%"><span class="smallfieldcell">
						 					<INPUT class=fieldcellamount style="WIDTH: 92; HEIGHT: 19" id="creditTotal" name="creditTotal" readOnly SIZE="20" tabindex=-1></span>
						                 </td>
                                        <td  width="17%" style="DISPLAY:none">
                                        	<span style="WIDTH: 175px; HEIGHT: 19px" ></span>
										</td>
										 <td><A  id=A1 style="WIDTH: 10px; HEIGHT: 19px"  	 href="#"  tabindex=-1>     </A>
           								 </td>
                                       </tr>
                    </table>
      			<tr >
				<td height="25" colspan="4" valign="bottom" class="smalltext"><p class="smalltext">
					<span class="leadon">*</span>- Mandatory Fields</p>
				</td>
			</tr><!--  Buttons for Request Form starts here -->


   			<tr >
				<td colspan="4" align="middle"><!-- Buttons Start Here -->
					<table border="0" cellpadding="0" cellspacing="0">
						<tr id="modGrid">
								<td align="center" width=100% colspan=4>
								<input   type="button" class="button" value="Reverse"  onclick=modify(); />
								</td>
						</tr>
						<tr id="backbutton" >
							<td width=100% align=center colspan=4>
							<input   type="button" class="button" value="Back"  onclick="back(window.self)" />

							</td>
						</tr>
						<tr id="reverseRecord"  style="DISPLAY: none">
							<td align="right"><span   valign="center" class="labelcell"> Voucher Number<SPAN class=leadon>*</SPAN></span>
							</td>
							<td><span class=fieldcell><input  class=fieldcell name="voucherHeader_newVcNo" id="voucherHeader_newVcNo" maxlength="10"   exilDataType="exilAlphaNumeric" style="width:148; height:19"></span>
							</td>
							<td align="right">
								<span   valign="center" class="labelcell" >Voucher Date<span class="leadon">*</span>
							</td>
							<td><span class=smallfieldcell> <INPUT class="smallfieldcell" name="voucherHeader_effDate" exilDataType="exilAnyDate" id   ="voucherHeader_effDate" style="WIDTH: 120x; HEIGHT: 19px" size="13" onkeyup="DateFormat(this,this.value,event,false,'3')" exilCalendar="true"></span></span>
							</td>
							<td><INPUT	 type   =hidden class   ="datefieldinput" name="diffDebit" id="diffDebit" style="WIDTH: 101px; HEIGHT: 19px"	size="13"></SPAN>
							</td>
						</tr>

										<tr>
										<tr id="reverseRecord"  style="DISPLAY: none"
             ><!--<td>
													<div  align="right" valign="center" class="normaltext"> Voucher Number<SPAN class=leadon>*</SPAN> </div>
															</td>
															<td>
																<input class="fieldinput" name="voucherHeader_newVcNo" id="voucherHeader_newVcNo" maxlength="10"  exilDataType="exilAnyChar" >
															</td>

															<td><div  align="right" valign="center" class="normaltext" >Voucher Date<span class="leadon">*</span></div>
															</td>
															<td>
															<INPUT  class="datefieldinput" name="voucherHeader_effDate" id="voucherHeader_effDate" style="WIDTH: 101px;  HEIGHT: 19px" size   ="13"   exilDataType="exilPastDate"
																exilCalendar="true">

											</td>-->
											<td ><span  align="right" valign="center" class=""> Voucher Number<SPAN class=leadon>*</SPAN>
												 <span class=smallfieldcell>
											<input name="voucherHeader_newVcNo" id="voucherHeader_newVcNo" maxlength="5"  style="WIDTH: 146; HEIGHT: 22" size="8"

                        exilDataType="exilAlphaNumeric"> </span></span> </td>
											<td></td>
											<td ><span  align="right" valign="center" class="" >Voucher Date<span class="leadon">*</span>
											<span class=fieldcell><INPUT

                  class="datefieldinput" name   ="voucherHeader_effDate"
                  id="voucherHeader_effDate" style="WIDTH: 101px; HEIGHT: 19px" size="13" onkeyup="DateFormat(this,this.value,event,false,'3')" exilDataType="exilAnyDate" exilCalendar="true"></span></span></td>
											<td></td>
										</tr>
										<tr>
										  <td colspan=4></td>
										<tr></tr>
					</table>

							<table border="0" cellpadding="0" cellspacing="0">
							<tr id="submitGrid">
								<td>
								 <input  id="saveandnew" type="button" class="button" value="Save & New"  onclick="return ButtonPress('savenew');"/>
								 <input   type="button" class="button" value="Save & Close"  onclick="return ButtonPress('saveclose');" />
								 <input   type="button" class="button" value="Cancel"  onclick="onClickCancel()" />
								 <input   type="button" class="button" value="Close"  onclick=window.close(); />
								 <input   type="button" class="button" value="Show GlEntry"  onclick=showglEntry(); />
								 </td>
								</tr>
						</table>
						<table align="center" border="0" cellpadding="0" cellspacing="0">
					 				<tr id="reverseSubmit">
					 						<td width=100% align=center>
						 						<input type="button"  id="revsave" value="Submit" class="button"  onclick="return ButtonPress('saveclose');"/>
						 						<input type="button" id="revclose" value="Close" class="button"  onclick="window.close();" />
					 						</td>
									</tr>
						</table>
						</td>
						</tr></table>
						<table width="100%" border=0 cellpadding="3" cellspacing="0" id="showEntries" name="showEntries" style="DISPLAY: none">
												<tr >
												<td colspan=4>
												<table width="100%" align=center border="0" cellpadding="0" cellspacing="0" >
												<tr  height="25">
												 <TD class=displaydata align=center ><h4>GLEntry</h4></TD></tr>
												</table>
												</td>
												</tr>
												<tr><td>
												<table width="80%" border="1" cellpadding="0" cellspacing="0" align=center id="entries" name="entries">
												<tr class="thStlyle">
													<td class="columnheader" ><div align="center" valign="center" class="thStlyle"> Code Type</div></td>
													<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Account Code</div></td>
													<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Account Head</div></td>
													<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Debit </div></td>
													<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Credit</div></td>
													<td  class="columnheader"><div align="center" valign="center" class="thStlyle"> Narration</div></td>
												</tr>
												<tr class="labelcell">
													<td ><div name="display_CodeType"  id="display_CodeType"   readOnly maxLength=10 tabIndex=0>&nbsp;</div></td>
													<td ><div name="display_Code"  id="display_Code"   readOnly maxLength=10 tabIndex=0>&nbsp;</div></td>
													<td height="15" ><div name="display_Head"  id="display_Head"  readOnly maxLength=15 tabIndex=0>&nbsp;</div></td>
													<td ><div name="display_Debit"  id="display_Debit"  readOnly maxLength=16 tabIndex=0 style="text-align:right">&nbsp;</div></td>
													<td ><div name="display_Credit"  id="display_Credit"  readOnly maxLength=16 tabIndex=0 style="text-align:right">&nbsp;</div></td>
													<td ><div name="display_Narration" id="display_Narration"  readOnly maxLength=10 tabIndex=0>&nbsp;</div></td>
												</tr>
												</table>
												</td>
												</tr>
						</table>
						<table id="entities_grid" width="20%" style="DISPLAY: none" >
								<tr>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
								</tr>
								<tr>
									<td><input id="grid_detTypeId" name="grid_detTypeId" style="WIDTH: 100px" size="20"></td>
									<td><input id="grid_detKeyId" name="grid_detKeyId" style="WIDTH: 100px" size="20"></td>
									<td><input id="grid_detValue" name="grid_detValue" style="WIDTH: 100px" size="20" ></td>
									<td><input id="grid_rowIndex" name="grid_rowIndex" style="WIDTH: 100px" size="20"></td>
									<td><input id="grid_amount" name="grid_amount" style="WIDTH: 100px"></td>
									<td><input id="grid_detCode" name="grid_detCode" style="WIDTH: 100px"></td>
						          	<td><input id="grid_rowFunId" name="grid_rowFunId" style="WIDTH: 100px" size="20"></td>
								</tr>
	</table>
		</form>
<!-- We will set the "left" position value inside autocompletion method -->
		 <div style="position: absolute;top:170px;width:118px;height:30px" id="menu-popup" >
		 <table id="completeTable" bgcolor="#cae1ff" border="1"/>
		 </div>

	</body>
</html>
