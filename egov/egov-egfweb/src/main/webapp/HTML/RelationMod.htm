#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<script language="javascript">

var pageMode="modify";
var str="";
function getData(){
PageManager.ListService.callListService();
	cntrl = document.getElementById('relation_tdsId');
		cntrl.style.display="none";
	obj = document.getElementById('tbMain');
	document.getElementById('tds').innerHTML="";
	loadSelectData('../commonyui/egov/loadComboAjax.jsp', "eg_partytype","id", "code", " parentid is null ", 'dummy', 'relation_partyTypeId');
	var relationcodeToSearch = PageManager.DataService.getQueryField('relationcodeToSearch');
	if (relationcodeToSearch){
	PageManager.DataService.setQueryField('relationcodeToSearch',relationcodeToSearch);
	PageManager.DataService.callDataService('relationModData');
		var newrecord=document.getElementById('newrec')
		newrecord.style.display = "none";
	} else {
		pageMode="add";
		//document.getElementById('screenName').innerHTML="Create Supplier/Contractor";
		var mod=document.getElementById('modrec')
		mod.style.display = "none";
	}
	document.relationModify.relation_code.focus();
	PageManager.DataService.callDataService('getTitle');
}

function beforeRefreshPage(dc){
	if(dc.values['serviceID']=='relationModData'){
		document.getElementById('dummy').value=dc.values['relation_partyTypeId'];
		getSubPartyType('dummy','relation_subTypeId');
		document.getElementById('dummy').value='dummy';
		}

	return true;
}
function afterRefreshPage(dc){
/* we will use after enhancement ;allow user to give tds here and use that tds in journal
	if(dc.values['relation_tdsId']){
		cntrl = document.getElementById('relation_tdsId');
		cntrl.style.display="block";
		document.getElementById('tds').innerHTML="TDS<font color=red>*</font>";
	}
*/
	if(dc.values['relation_isActive']=='0')
		document.getElementById('relation_isActive').checked=false;
	else
		document.getElementById('relation_isActive').checked=true;

	if(dc.values['serviceID']=='getTitle')
		document.getElementById("relation_createdBy").value=dc.values['current_UserID'];

	return true;
}
function getRelationType(){
/* we will use after enhancement ;allow user to give tds here and use that tds in journal
	var control=document.getElementById('relation_relationTypeId');
	var type=control.options[control.selectedIndex].text;
	cntrl = document.getElementById('relation_tdsId');
	if(type=='Supplier'){
		cntrl.style.display="none";
		document.getElementById('tds').innerHTML="";
		cntrl.removeAttribute('exilMustEnter');
	}else{
		cntrl.style.display="block";
		document.getElementById('tds').innerHTML="TDS<font color=red>*</font>";
		cntrl.setAttribute('exilMustEnter',"true");
	}
	*/
}

function getRelationTypeId()
{
var control2=document.getElementById('relation_relationTypeId');

var control=document.getElementById('relation_partyTypeId');

	var type=control.options[control.selectedIndex].text;
	for(var i=0;i<control2.options.length;i++)
	{
	if(type==control2.options[i].text)
	{
	control2.selectedIndex=i;
	}
}
}


function ButtonPress(name){

	getRelationTypeId();
	//   ***1 only FO***,  ***2 FO***,  ***Admin, 3 All***    //
	if(name.toLowerCase()=='savenew')
	str="new";
	if(name.toLowerCase()=='saveclose')
	str="close";
	if(!isValidUser(2, CookieManager.getCookie('userRole')) ) return false;
	if(!PageValidator.validateForm())
				return false;

	document.getElementById('egUser_id').value = CookieManager.getCookie('currentUserId');

	if(document.getElementById('relation_subTypeId').options.length==0)
		document.getElementById('relation_subTypeId').options[0] = new Option("--Choose--","");
	if(!checkNarration('relation_narration')) return false;
	var control=document.getElementById('relation_relationTypeId');
	var type=control.options[control.selectedIndex].value;

	if(type=='Supplier'){
		var tds=document.getElementById('relation_tdsId');
		if(tds.selectedIndex>=0) {
			tds.options[0].value="null";
			tds.options[0].setAttribute('selected','true');
		}
	}

	if (pageMode == "add"){
		PageManager.UpdateService.submitForm('relationInsert');

	}

	if (pageMode == "modify")
	{
	if(!isValidUser(2, CookieManager.getCookie('userRole')) ) return false;

		document.getElementById('egUser_id').value = CookieManager.getCookie('currentUserId');

		if(!checkNarration('relation_narration')) return false;
		var control=document.getElementById('relation_relationTypeId');
		var type=control.options[control.selectedIndex].value;
		if(type=='Supplier'){
			var tds=document.getElementById('relation_tdsId');
			if(tds.selectedIndex>=0) {
				tds.options[0].value="null";
				tds.options[0].setAttribute('selected','true');
			}
		}

		PageManager.UpdateService.submitForm('relationUpdate');
	}

}

function onClickCancel(){
	window.location="RelationMod.htm";
}


function onCancel(){
	window.location="Relation.htm";
}

function afterUpdateService(dc)
{
	if(dc.values['serviceID']='relationUpdate')
	{
	window.location = "Relation.htm?relation_codeToSearch="+dc.values['relation_code'];//+"&showMode=view";
	}
	if(str=="new")
	{
		window.location = "RelationMod.htm";
	}
	if(str=="close")
	{
	window.close();
	}
}
//loads subparty type
function getSubPartyType(objName1,objName2)
{
	loadSelectData('../commonyui/egov/loadComboAjax.jsp', "eg_partytype","id", "code", " parentid=#1 ", objName1, objName2);
	//alert("'relation_subTypeId').value:"+document.getElementById('relation_subTypeId').value);
}



</script>

<body bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0" marginheight="0" marginwidth="0" onLoad="getData();" onKeyDown ="CloseWindow(event);"><!------------------ Header Begins Begins--------------------->
<form name="relationModify" >
<input type="hidden" name="relation_ID" id="relation_ID" >
<input type="hidden" name="relation_lastModified" id="relation_lastModified" >
<input type="hidden" name="egUser_id" id="egUser_id">
<input type="hidden" name="tableName" id="tableName" value="relation">
<input type="hidden" id="dummy" name="dummy" value="dummy">


	<table width="100%" border=0 cellpadding="6" cellspacing="0">
			<tr>
			<td valign="top" ><!------------Content begins here ------------------>
						<table width="100%" border=0 cellpadding="3" cellspacing="0" id="tbMain" name="tbMain">
							<tr >
							  <td width="25%" align="right" valign="center" ><div align="right" class="labelcell">Code<span class="leadon">*</span></div></td>
							  <td width="25%"><span class="fieldcell"><input name="relation_code" id="relation_code" maxlength=50 class="fieldinput" size="25" exilMustEnter="true"
            exilDataType="exilAlphaNumeric"></span></td>

							  <td width="25%" align="right" valign="center" ><div align="right" class="labelcell">Name<span class="leadon">*</span></div></td>
							  <td width="25%"><span class="fieldcell"><input name="relation_name" id="relation_name" maxlength=50 class="fieldinput" size="25" exilMustEnter="true" exilDataType="exilAnyChar"></span></td>
							</tr>

							<tr >
							  <td align="right" valign="center" ><div align="right" class="labelcell">Address<span class="leadon">*</span></div></td>
							  <td >
								<span class="fieldcell"><input name="relation_address1" class="fieldinput" id="relation_address1" maxlength="50" size="25" exilMustEnter="true" exilDataType="exilAnyChar"></span>
							  </td>

							  <td align="right" valign="center" ><div align="right">&nbsp;</div></td>
							  <td class="fieldinput">&nbsp;</td>
							</tr>

							<tr >
							  <td align="right" valign="center" >&nbsp;</td>
							  <td>
								<span class="fieldcell"><input name="relation_address2" class="fieldinput" id="relation_address2" maxlength=50 size="25" exilDataType="exilAnyChar"></span>
							  </td>

							  <td align="right" valign="center" ><div align="right">&nbsp;</div></td>
							  <td class="fieldinput">&nbsp;</td>
							</tr>


							<tr >
							  <td align="right" valign="center" ><div align="right" class="labelcell">City</div></td>
							  <td>
								<span class="fieldcell"><input name="relation_city" class="fieldinput" id="relation_city" maxlength="50" size="25" exilDataType="exilAnyChar"></span>
							  </td>

							  <td align="right" valign="center" ><div align="right" class="labelcell">Pin</div></td>
							  <td>
								<span class="fieldcell"><input name="relation_pin" class="fieldinput" id="relation_pin" maxlength=15 size="25" exilDataType="exilUnsignedInt"></span>
							  </td>
							</tr>

							<tr >
							  <td align="right" valign="center" ><div align="right" class="labelcell">Phone</div></td>
							  <td >
								<span class="fieldcell"><input name="relation_phone" class="fieldinput" id="relation_phone" maxlength="15" size="25" exilDataType="exilAnyChar"></span>
							  </td>

							  <td align="right" valign="center" ><div align="right" class="labelcell">Fax</div></td>
							  <td>
								<span class="fieldcell"><input name="relation_fax" class="fieldinput" id="relation_fax" maxlength="15" size="25" exilDataType="exilAnyChar"></span>
							  </td>
							</tr>

							<tr >
							  <td align="right" valign="center" ><div align="right" class="labelcell">Mobile</div></td>
							  <td>
								<span class="fieldcell"><input name="relation_mobile" class="fieldinput" id="relation_mobile" maxlength="25"  size="25" exilDataType="exilAnyChar"></span>
							  </td>

							  <td align="right" valign="center" ><div align="right" class="labelcell">E-Mail</div></td>
							  <td>
								<span class="fieldcell"><input name="relation_email" class="fieldinput" id="relation_email" maxlength="25" size="25" exilDataType="exilEmail"></span>
							  </td>
							</tr>



							<tr >
							  <td align="right" valign="center" ><div align="right" class="labelcell">Contact person</div></td>
							  <td>
								<span class="fieldcell"><input name="relation_contactPerson" class="fieldinput" id="relation_contactPerson" maxlength=50 size="25"
            exilDataType="exilAnyChar"></span>
							  </td>
							  <td align="right" valign="center" ><div align="right" class="labelcell">Narration</div></td>
							  <td class="fieldinput" ><TEXTAREA class=fieldinput id=relation_narration name=relation_narration rows=3 cols=40 exilDataType="exilAnyChar" maxlength="250"></TEXTAREA>
							  </td>
							  </tr>
							  <tr >
							  <td align="right" valign="center" ><div align="right" class="labelcell">Bank Name</div></td>
							  <td>
								<span class="fieldcell">
				<input name="relation_bankname" class="fieldinput" id="relation_bankname" maxlength=50 size="25"
            exilDataType="exilAnyChar"></span>
            </td>
							  <td align="right" valign="center" ><div align="right" class="labelcell">Bank Account </div></td>
							 <td>
							 	<span class="fieldcell"><input name="relation_bankaccount" class="fieldinput" id="relation_bankaccount" maxlength=50 size="25"
            exilDataType="exilAnyChar"></span>
							  </td>							  </tr>
<tr >
									<td align=right><div align="right" valign="center" class="labelcell" >Disbursement Mode </div></td>
									<td><span class="smallfieldcell"><select class="combowidth" name="relation_modeofpay" id="relation_modeofpay" style="width:150px">
									<option value=""></option>
									<option value="ECS">ECS</option>
									<option value="CHEQUE">CHEQUE</option>
										</select></span></td>
										<td></td>
										<td></td>

							</tr>

							<tr >
							  <td align="right" valign="center" ><div align="right" class="labelcell">PAN No</div></td>
							  <td>
								<span class="fieldcell"><input name="relation_panno" class="fieldinput" id="relation_panno" maxlength=50 size="25"
            exilDataType="exilAnyChar"></span>
							  </td>
							  <td align="right" valign="center" ><div align="right" class="labelcell">TIN No</div></td>
							 <td>
							 	<span class="fieldcell"><input name="relation_tinno" class="fieldinput" id="relation_tinno" maxlength=50 size="25"
            exilDataType="exilAnyChar"></span>
							  </td>
							  </tr>
                               <tr  style="Display:none">
					<td align=right><div align="right" valign="center" class="labelcell" >Type <SPAN class=leadon>*</SPAN></div></td>
						<td ><span class="smallfieldcell"><select class="fieldinput" name="relation_relationTypeId" id="relation_relationTypeId" onchange="getRelationType();" exilMustEnter="true" exilListSource="selectRelationType" >
						</select></span></td>
						<td align="right"><div align="right" valign="center" class="labelcell" id="tds" name="tds">TDS<span class="leadon">*</span></div></td>
						<td ><span class="smallfieldcell"><select class="fieldinput" name="relation_tdsId" id="relation_tdsId" style="DISPLAY: none" exilListSource="selectTds">
						</select></span></td>

					</tr>
							<tr >
									<td align=right><div align="right" valign="center" class="labelcell" >Party Type <SPAN class=leadon>*</SPAN></div></td>
									<td><span class="smallfieldcell"><select class="fieldinput" name="relation_partyTypeId" id="relation_partyTypeId" onchange="getSubPartyType('relation_partyTypeId','relation_subTypeId');">
										</select></span></td>
										<td align="right"><div align="right" valign="center" class="labelcell">Sub type</div></td>
										<td><span class="smallfieldcell"><select class="fieldinput" name="relation_subTypeId" id="relation_subTypeId" >
										</select></span></td>

							</tr>
                               <tr >
							  <td align="right" valign="center" ><div align="right" class="labelcell">Active</div></td>
							  <td class="fieldinput" >
								<input type=checkbox name="relation_isActive" id="relation_isActive" value="1" checked>
							  </td>
							  <td align="right" valign="center" >&nbsp;</td>
							  <td class="fieldinput" >&nbsp;</td>
							  </tr>
							  <tr  style="display:none">
							  <td align="right" valign="center"><div valign="center" class="labelcell">Created By</div></td>
							  <td ><span class="fieldcell"><input type="text" id="relation_createdBy" name="relation_createdBy"></span></td>
							  <td align="right" valign="center" ><div align="right">&nbsp;</div></td>
							  <td class="fieldinput">&nbsp;</td>
							  </tr>

                             <tr >
				<td height="25" colspan="4" valign="bottom" class="smalltext"><p class="smalltext"><span class="leadon">*</span>
						- Mandatory Fields</p>
				</td>
			</tr>
			<tr >
					<td colspan="4" align="middle"><!-- Buttons Start Here -->
						<table border="0" cellpadding="0" cellspacing="0"  align="center" name="modrec" id="modrec">
							 <tr >
							 <td>
							 <input   type="button" class="button" value="Submit" onclick="return ButtonPress('saveclose');" />
							 <input   type="button" class="button" value="Cancel" onclick="onCancel()" />
							 <input   type="button" class="button" value="Close" onclick=window.close(); />
							 </td>
						</tr></table>
						<table border="0" cellpadding="0" cellspacing="0"  align="center" name="newrec" id="newrec" >
							 <tr name="trNew" id="trNew">
							 <td>
							 <input  id="savenNew" type="button" class="button" value="Save & New" onclick="return ButtonPress('savenew');"/>
							 <input  id=savenClose  type="button" class="button" value="Save & Close" onclick="return ButtonPress('saveclose');" />
							 <input   type="button" class="button" value="Cancel" onclick="onClickCancel()" />
							 <input   type="button" class="button" value="Close" onclick=window.close(); />
							 </td>
						</tr></table>


					</td>
					</tr>


                      </table>
					 </td>
				  </tr>

							  </table>
</form>
</body>

