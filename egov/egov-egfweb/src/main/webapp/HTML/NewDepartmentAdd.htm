#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="KEYWORDS" content="">
<meta http-equiv="DESCRIPTION" content="">
<!-- Inclusion of the CSS files that contains the styles -->
<link rel=stylesheet href="../exility/global.css" type="text/css">
<SCRIPT LANGUAGE="javascript" SRC="../exility/datefunctions.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/ExilityParameters.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/PageManager.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/PageValidator.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../exility/CookieManager.js"></Script>
<SCRIPT LANGUAGE="javascript" SRC="../script/jsCommonMethods.js"></Script>
<SCRIPT LANGUAGE="javascript" SRC="../script/predefinedAccCodes.js"></Script>
<SCRIPT type="text/javascript" src="../script/calendar.js" type="text/javascript" ></SCRIPT>
<script language="javascript">
pageMode="modify";
var sameWindow=0;
//var changeParentlevel=0;
function getData(){
PageManager.ListService.callListService();
PageValidator.addCalendars();
			document.getElementById('name').focus();
		var mode = PageManager.DataService.getQueryField('showMode');

	var worksDetail_code=PageManager.DataService.getQueryField('worksDetail_code');
	//alert(worksDetail_code);
	if (mode == "new")
	{
	document.getElementById('trModify').style.display='none';
	document.getElementById('trNew').style.display='block'
	document.getElementById('modeOfExec').value="new";
	}
	if (mode == "modify")
	{
	document.getElementById('trModify').style.display='block';
	document.getElementById('trNew').style.display='none'
	document.getElementById('modeOfExec').value="modify";
	//alert(worksDetail_code);
	PageManager.DataService.callDataService('departmentUpdateData');
	}
//	alert(document.getElementById('modeOfExec').value);
}

function onClickCancel(){
	//window.location="NewDepartmentEnq.htm";
	window.location="NewDepartmentAdd.htm?showMode=new";
}
function onClickCancelMod(){
	window.location="NewDepartmentEnq.htm";

}


function ButtonPress(name){
if(name.toLowerCase()=='savenew')
sameWindow=1;
	//   ***1 only FO***,  ***2 FO***,  ***Admin, 3 All***    //
	//alert(document.getElementById('modeOfExec').value);
	if(document.getElementById('modeOfExec').value=="new")
	{
		//alert(document.getElementById('code').value);
		doInsert();
	}
	if(document.getElementById('modeOfExec').value=="modify")
	{

		doUpdate();

		//window.close();
	}

}

function beforeRefreshPage(dc){

	return true;
}
function afterRefreshPage(dc){
	return true;
}
function doInsert(){
	PageManager.UpdateService.submitForm('newDepartmentInsert');
}
function doUpdate(){
		sameWindow = 2;
	PageManager.UpdateService.submitForm('newdepartmentUpdate');
}
function onChangeParentType(){
	var obj = document.getElementById('Parent');
	changeParentlevel=1;
	if(obj.selectedIndex == 0){
		obj.options[obj.selectedIndex].value = ' ';
		document.getElementById('code').value = '';
		//document.getElementById('fund_parentId').value = "null";
		//document.getElementById('fund_llevel').value = 0;
		return;
	}

	var departmentId=obj.options[obj.selectedIndex].value;
	//alert(departmentId);
	PageManager.DataService.setQueryField('departmentId',departmentId);
	PageManager.DataService.callDataService('departmentNameIdNew');
}
function afterUpdateService(dc){
	//alert(sameWindow);
	/*var l=0;

	if(changeParentlevel == 1 )
	{
	  if(dc.values['serviceID']='fundNameId')
	  {
	 	l = dc.values['fund_llevel'];
	    l=parseInt(l,10);
	    l = l+1;
	    dc.values['fund_llevel']=l;
	    }
	 }
	changeParentlevel=0;*/
	if(sameWindow == 1){
	  window.location="NewDepartmentAdd.htm?showMode=new";
      }else if(sameWindow == 0)
	  {window.close();}
	  else if(sameWindow == 2) {
	window.location="NewDepartmentEnq.htm?showMode=modifyScheme";
	}
	sameWindow=0;
	return true;
}
function verifybillCollectorCode(evnt){
	//PageManager.DescService.onblur(evnt);
}

</script>
</head><body onKeyDown ="CloseWindow(event);" bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0" marginheight="0" marginwidth="0" onload="getData()" ><!------------------ Header Begins Begins--------------------->
<form name="schemeAdd">
<input type="hidden" name="worksDetail_code" id="worksDetail_code" >
<input type="hidden" name="egUser_id" id="egUser_id">
<input type="hidden" name="modeOfExec" id="modeOfExec" value="new">
<input type="hidden" name="tableName" id="tableName" value="department">
<!-- <input type="hidden" name="fund_llevel" id="fund_llevel"> -->
	<table width="100%" border=0 cellpadding="6" cellspacing="0">
		<tr>
			<td valign="top" class="normaltext"><!------------Content begins here ------------------>
				<table width="976" border=0 cellpadding="3" cellspacing="0">
					<tr>
						<td class="rowheader" valign="center" colspan="2" width="968"><span class="headerwhite2" id="screenName"><b>Department</b></span></td>
					</tr>

					<tr class="row1">
						<td align="right" valign="center" class="normaltext" width="229"><div align="right">Name<span class="leadon">*</span></div></td>
						<td width="731" ><input name="name" class="fieldinput" id="name" exilDataType="exilAnyChar" exilMustEnter="true" maxlength=20 exilDataSource="billCodeVerification" exilDescField="scheme_name" size=20></td>

					</tr>

					<tr class="row2">
							  <td><div align="right" valign="center" class="normaltext">Parent Department</div></td>
							  <td>
								<select name="Parent" id="Parent" class="fieldinput" maxlength=50 exilListSource="newDepartmentNameList" onChange="onChangeParentType();"></select></td>
							 <!--  <td><div id="code" name="code" class="displayData" >&nbsp;</div></td> -->
							<td ><INPUT TYPE="hidden" NAME="code"></td>
							</tr>

					<tr class="row2">
						<td align="right" valign="center" class="normaltext" width="229"><div align="right">Description</div></td>
						<td width="731">
                                <TEXTAREA id="description" class="narrationfieldinput" name="description" exilTrimLength="20" maxlength=250 rows=3 cols=40 exilDataType="exilAnyChar"></TEXTAREA>
						</td>
					</tr>


		</tr>
					<tr class="row1">
						<td align="right" valign="center" class="normaltext" width="229"><div align="right">Valid From<span class="leadon">*</span></div></td>

						<td width="731">
							<input onkeyup="DateFormat(this,this.value,event,false,'3')" name="validFrom" id="validFrom" class="datefieldinput" exilDataType="exilAnyDate" exilCalendar="true"></td>
					</tr>
					<tr class="row2">
						<td align="right" valign="center" class="normaltext" width="229">Valid
                          To</td>
						<td width="731">
							<input onkeyup="DateFormat(this,this.value,event,false,'3')" name="validTo" id="validTo" class="datefieldinput"  exilDataType="exilAnyDate" exilCalendar="true"></td>
					</tr>
                     <tr class="row1">
						<td height="25" colspan="4" valign="bottom" class="smalltext" width="898"><p class="smalltext">&nbsp;</p>
						</td>
						 <tr class="row1">
							  <td><div align="right" valign="center" class="normaltext">Active</div></td>
							  <td><input type="checkbox" name="department_isActive" id="department_isActive" value="1" checked>
								</td>
							  <td></td>
							  <td></td>
		  </tr>
						</tr>
						<tr><td height="25" colspan="4" valign="bottom" class="smalltext" width="884"><p class="smalltext"><span class="leadon">*</span>
							- Mandatory Fields</p>
						</td></tr>
			<tr class="row2">
							<td colspan="4" align="middle" width="898"><!-- Buttons Start Here -->
								<table border="0" cellpadding="0" cellspacing="0">
						<tr name="trModify" id="trModify">
						<td align="right"><IMG height=18 src="/egi/resources/erp2/images/Button_leftside.gif" width=7></td>
						<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary id=submitButton onclick=ButtonPress('saveclose'); href="#">Submit</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_rightside.gif" width=7></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=onClickCancelMod(); href="#">Cancel</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=window.close() href="#">Close</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
						</tr>
						<tr name="trNew" id="trNew">
						<td align="right"><IMG height=18 src="/egi/resources/erp2/images/Button_leftside.gif" width=7></td>
						<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary id=savenNew onclick=ButtonPress('savenew') href="#">Save &amp; New</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_rightside.gif" width=7></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG height=18 src="/egi/resources/erp2/images/Button_leftside.gif" width=7></td>
						<td bgcolor="#fe0000" valign="center" nowrap><A class=buttonprimary id=savenClose onclick=ButtonPress('saveclose'); href="#">Save &amp; Close</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_rightside.gif" width=7></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=onClickCancel(); href="#">Cancel</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
						<td><IMG src="/egi/resources/erp2/images/spacer.gif" width=8></td>
						<td align="right"><IMG height=18 src="/egi/resources/erp2/images/Button_second_leftside.gif" width=6></td>
						<td bgcolor="#ffffff" valign="center" nowrap background="/egi/resources/erp2/images/Button_second_middle.gif"><A class=buttonsecondary onclick=window.close() href="#">Close</A></td>
						<td><IMG height=18 src="/egi/resources/erp2/images/Button_second_rightside.gif" width=6></td>
						</tr>

						</table><!-- Buttons End Here -->
					</td>
				</tr>
			</table></TD></TR></TBODY></TABLE></TD></TR></TABLE><!------------ Content ends here ------------------></TD></TR></TABLE></TD><!------------Right Navigation Ends here------------------></TR></TABLE><!---------------- Footer begins here ----------><!---------------- Footer ends here ---------->
</form>
</body>
</html>
