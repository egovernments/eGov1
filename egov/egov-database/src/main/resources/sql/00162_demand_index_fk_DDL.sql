ALTER TABLE ONLY EG_REASON_CATEGORY 
ADD CONSTRAINT PK_EG_REASON_CATEGORY PRIMARY KEY (ID);

ALTER TABLE ONLY EG_DEMAND_REASON_MASTER 
ADD CONSTRAINT pk_egdm_demand_reason_master PRIMARY KEY (id);

ALTER TABLE ONLY EG_DEMAND_REASON_MASTER 
ADD CONSTRAINT fk_eg_reason_category FOREIGN KEY (ID_CATEGORY) REFERENCES eg_reason_category(id);

ALTER TABLE ONLY EG_DEMAND_REASON_MASTER 
ADD CONSTRAINT FK_EG_MODULE_ID FOREIGN KEY (MODULE_ID) REFERENCES EG_MODULE (ID_MODULE);

CREATE UNIQUE INDEX INDX_EG_DEMAND_REASON_MASTER ON EG_DEMAND_REASON_MASTER USING btree (ID);

CREATE INDEX INDX_DEM_REASON_MSTR ON EG_DEMAND_REASON_MASTER USING btree (REASON_MASTER);

CREATE INDEX INDX_DEM_REASON_CODE ON EG_DEMAND_REASON_MASTER USING btree (CODE); 

ALTER TABLE ONLY EG_INSTALLMENT_MASTER 
ADD CONSTRAINT PK_EGPT_INSTALLMENT_MASTER PRIMARY KEY (ID);

ALTER TABLE ONLY EG_INSTALLMENT_MASTER 
ADD CONSTRAINT UNQ_YEAR_NUMBER_MOD UNIQUE (ID_MODULE, INSTALLMENT_NUM, INSTALLMENT_YEAR);

ALTER TABLE ONLY EG_INSTALLMENT_MASTER 
ADD CONSTRAINT FK_INSTMSTR_MODULE FOREIGN KEY (ID_MODULE) REFERENCES EG_MODULE (ID_MODULE);

ALTER TABLE ONLY EG_DEMAND_REASON 
ADD CONSTRAINT pk_egdm_demand_reason PRIMARY KEY (id);

ALTER TABLE ONLY EG_DEMAND_REASON 
ADD CONSTRAINT fk_dreason_coa FOREIGN KEY (glcodeid) REFERENCES chartofaccounts(id);

ALTER TABLE ONLY EG_DEMAND_REASON 
ADD CONSTRAINT fk_eg_installment_id FOREIGN KEY (ID_INSTALLMENT) REFERENCES eg_installment_master(id);

ALTER TABLE ONLY EG_DEMAND_REASON 
ADD CONSTRAINT fk_egdemandreasonmaster_id FOREIGN KEY (ID_DEMAND_REASON_MASTER) REFERENCES eg_demand_reason_master(id);

ALTER TABLE ONLY EG_DEMAND_REASON 
ADD CONSTRAINT fk_eg_dem_reason_id_base_dem FOREIGN KEY (ID_BASE_REASON) REFERENCES eg_demand_reason(id);


CREATE UNIQUE INDEX INDX_EG_DEMAND_REASON ON EG_DEMAND_REASON USING btree (ID); 

CREATE INDEX INDX_DEM_REASON_INST ON EG_DEMAND_REASON USING btree (ID_DEMAND_REASON_MASTER, ID_INSTALLMENT);

ALTER TABLE ONLY EG_DEMAND_REASON_DETAILS 
ADD CONSTRAINT pk_egdm_demand_reason_details PRIMARY KEY (id);

ALTER TABLE ONLY EG_DEMAND_REASON_DETAILS 
ADD CONSTRAINT fk_egpt_dem_reason_id FOREIGN KEY (ID_DEMAND_REASON) REFERENCES eg_demand_reason(id);

CREATE INDEX IDX_DEM_REASON_DET ON EG_DEMAND_REASON_DETAILS USING btree (ID_DEMAND_REASON);

ALTER TABLE ONLY EG_BILL_TYPE
ADD CONSTRAINT PK_EG_BILL_TYPE PRIMARY KEY (ID);

ALTER TABLE ONLY EG_DEMAND 
ADD CONSTRAINT pk_egdm_demand PRIMARY KEY (id);

ALTER TABLE ONLY EG_DEMAND 
ADD CONSTRAINT fk_eg_installment_master_id FOREIGN KEY (ID_INSTALLMENT) REFERENCES eg_installment_master(id);

ALTER TABLE ONLY EG_DEMAND_DETAILS 
ADD CONSTRAINT eg_demand_details_pkey PRIMARY KEY (id);

ALTER TABLE ONLY EG_DEMAND_DETAILS 
ADD CONSTRAINT fk_demdndetail_status FOREIGN KEY (ID_STATUS) REFERENCES egw_status(id);

ALTER TABLE ONLY EG_DEMAND_DETAILS 
ADD CONSTRAINT fk_egdm_dem_reason_id FOREIGN KEY (ID_DEMAND_REASON) REFERENCES eg_demand_reason(id);

ALTER TABLE ONLY EG_DEMAND_DETAILS 
ADD CONSTRAINT fk_egdm_demand_id FOREIGN KEY (ID_DEMAND) REFERENCES eg_demand(id);

CREATE INDEX INDX_DEMAND_DET_MVS ON EG_DEMAND_DETAILS USING btree (ID_DEMAND, ID_DEMAND_REASON, AMOUNT, AMT_COLLECTED);

CREATE INDEX INQX_DMDDET_DMD_DMDRSNID ON EG_DEMAND_DETAILS USING btree (ID_DEMAND, ID_DEMAND_REASON);

ALTER TABLE ONLY EG_BILL 
ADD CONSTRAINT PK_EG_BILL PRIMARY KEY (ID);
 
ALTER TABLE ONLY EG_BILL 
ADD CONSTRAINT FK_EGBILLTYPE_ID FOREIGN KEY (ID_BILL_TYPE)  REFERENCES EG_BILL_TYPE (ID);

ALTER TABLE ONLY EG_BILL 
ADD CONSTRAINT FK_EGDEMAND_ID FOREIGN KEY (ID_DEMAND) REFERENCES EG_DEMAND (ID);

ALTER TABLE ONLY EG_BILL 
ADD CONSTRAINT fk_eg_module FOREIGN KEY (MODULE_ID) REFERENCES eg_module(id_module);

ALTER TABLE ONLY EG_BILL 
ADD CONSTRAINT fk_eg_user FOREIGN KEY (USER_ID) REFERENCES eg_user(id);

ALTER TABLE ONLY EG_BILL_DETAILS 
ADD CONSTRAINT PK_EG_BILL_DETAILS PRIMARY KEY (ID);

ALTER TABLE ONLY EG_BILL_DETAILS 
ADD CONSTRAINT EG_INSTALLMENT_ID FOREIGN KEY (ID_INSTALLMENT) REFERENCES EG_INSTALLMENT_MASTER (ID);

ALTER TABLE ONLY EG_BILL_DETAILS 
ADD CONSTRAINT FK_EG_BILL_DET_IDBILL FOREIGN KEY (ID_BILL) REFERENCES EG_BILL (ID);

ALTER TABLE ONLY EG_BILLRECEIPT 
ADD CONSTRAINT PK_EG_BILLRECEIPT PRIMARY KEY (ID);
